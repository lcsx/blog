(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{324:function(t,s,a){t.exports=a.p+"assets/img/mysql_2.b0a21779.jpg"},395:function(t,s,a){"use strict";a.r(s);var e=a(28),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"mysql事务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql事务"}},[t._v("#")]),t._v(" mysql事务")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#mysql事务"}},[t._v("mysql事务")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-数据库事务机制"}},[t._v("1 数据库事务机制")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-1-undo和redo日志"}},[t._v("1.1 undo和redo日志")])]),e("li",[e("a",{attrs:{href:"#_1-2-事务机制"}},[t._v("1.2 事务机制")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-2-1-开启事务机制【start-transaction】"}},[t._v("1.2.1 开启事务机制【START TRANSACTION】")])]),e("li",[e("a",{attrs:{href:"#_1-2-2-acid"}},[t._v("1.2.2 ACID")])])])]),e("li",[e("a",{attrs:{href:"#_1-3-事务的隔离"}},[t._v("1.3 事务的隔离")]),e("ul",[e("li",[e("a",{attrs:{href:"#_1-3-1-买票【read-uncommitted】"}},[t._v("1.3.1 买票【READ UNCOMMITTED】")])]),e("li",[e("a",{attrs:{href:"#_1-3-2-银行转账【read-committed】"}},[t._v("1.3.2 银行转账【READ COMMITTED】")])]),e("li",[e("a",{attrs:{href:"#_1-3-3-用户下单了，但支付前商品涨价了【repeatable-read】"}},[t._v("1.3.3 用户下单了，但支付前商品涨价了【repeatable read】")])]),e("li",[e("a",{attrs:{href:"#事务序列化"}},[t._v("事务序列化")])])])])])]),e("li",[e("a",{attrs:{href:"#_2-数据导出与导入"}},[t._v("2 数据导出与导入")]),e("ul",[e("li",[e("a",{attrs:{href:"#_2-1-数据导出与备份的区别"}},[t._v("2.1 数据导出与备份的区别")])]),e("li",[e("a",{attrs:{href:"#_2-2-sql文件的导出与导入"}},[t._v("2.2 SQL文件的导出与导入")]),e("ul",[e("li",[e("a",{attrs:{href:"#_2-2-1-导出sql文件【mysqldump】"}},[t._v("2.2.1 导出SQL文件【mysqldump】")])]),e("li",[e("a",{attrs:{href:"#_2-2-2-导入sql文件【source】"}},[t._v("2.2.2 导入SQL文件【source】")])])])]),e("li",[e("a",{attrs:{href:"#txt文档的导入与导出【速度快】"}},[t._v("TXT文档的导入与导出【速度快】")])])])])])])])]),e("p"),t._v(" "),e("h2",{attrs:{id:"_1-数据库事务机制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-数据库事务机制"}},[t._v("#")]),t._v(" 1 数据库事务机制")]),t._v(" "),e("h3",{attrs:{id:"_1-1-undo和redo日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-undo和redo日志"}},[t._v("#")]),t._v(" 1.1 undo和redo日志")]),t._v(" "),e("p",[t._v("数据的写入直接操作数据文件是非常危险的事情。如sql语句在执行过程中，系统重启，会影响存储过程，哪些记录修改与否不得而知。")]),t._v(" "),e("p",[t._v("mysql总共有5种日志，其中只有redo和undo日志与事务有关。")]),t._v(" "),e("p",[t._v("日志就是数据文件的副本")]),t._v(" "),e("p",[t._v("sql语句要操作什么数据，mysql先拷贝到undo日志中，增删改查等操作记录到redo日志中。")]),t._v(" "),e("p",[t._v("如果这些操作没什么问题，redo日志就会同步到数据库。即使有意外情况，如服务器死机、断电，当mysql重启后继续按redo日志执行同步即可。")]),t._v(" "),e("p",[t._v("如果不想继续执行同步，根据undo日志，将事务回滚，数据文件回复到事务之前的状态了。")]),t._v(" "),e("h3",{attrs:{id:"_1-2-事务机制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-事务机制"}},[t._v("#")]),t._v(" 1.2 事务机制")]),t._v(" "),e("p",[t._v("RDBMS(关系数据库管理系统) 其实就是 SQL语句 + 事务(ACID)")]),t._v(" "),e("p",[t._v("事务是一个或者多个SQL语句组成的整体，要么全部执行成功，要么全部执行失败。")]),t._v(" "),e("p",[t._v("使用场景：秒杀商品，但没支付。那么事务要回滚，而不能提交。")]),t._v(" "),e("h4",{attrs:{id:"_1-2-1-开启事务机制【start-transaction】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-开启事务机制【start-transaction】"}},[t._v("#")]),t._v(" 1.2.1 开启事务机制【START TRANSACTION】")]),t._v(" "),e("p",[t._v("【默认情况下】mysql执行 "),e("em",[t._v("每条")]),t._v(" SQL语句都会自动开启和提交事务")]),t._v(" "),e("p",[t._v("【多条SQL纳入到一个事务下】 要手动管理事务")]),t._v(" "),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("START")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SQL")]),t._v(" 语句\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMIT")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROLLBACK")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("START")]),t._v(" TRANSCATION"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_emp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_dept"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_emp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("        \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_dept"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 事务没有提交，修改都是在日志文件中，操作记录在redo日志中")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 所以select查询语句也是到redo日志中查询数据，结果是无数据")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 但是真实的数据表中是有数据的，打开navicat可以看到表中仍有数据")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 提交事务")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMIT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 回滚事务")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ROLLBACK;")]),t._v("\n")])])]),e("hr"),t._v(" "),e("h4",{attrs:{id:"_1-2-2-acid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-acid"}},[t._v("#")]),t._v(" 1.2.2 ACID")]),t._v(" "),e("ol",[e("li",[t._v("原子性：一个事务中的所有操作要么全部完成，要么全部失败。事务执行后，不允许停留在某个状态。")]),t._v(" "),e("li",[t._v("一致性：不管在任何给定的时间、并发事务有多少，事务必须保证运行结果的一致性。")]),t._v(" "),e("li",[t._v("隔离性：要求事务不受其他并发事务的影响，如同在给定的时间内，该事务是数据库唯一运行的事物。")]),t._v(" "),e("li",[t._v("持久性。事务一旦提交，结果便是永久性的。即使发生宕机，仍然可以依靠事务日志完成数据的持久化。")])]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"_1-3-事务的隔离"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-事务的隔离"}},[t._v("#")]),t._v(" 1.3 事务的隔离")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("序号")]),t._v(" "),e("th",[t._v("隔离级别")]),t._v(" "),e("th",[t._v("功能")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("1")]),t._v(" "),e("td",[t._v("read uncommitted")]),t._v(" "),e("td",[t._v("读取未提交数据")])]),t._v(" "),e("tr",[e("td",[t._v("2")]),t._v(" "),e("td",[t._v("read committed")]),t._v(" "),e("td",[t._v("读取已提交数据")])]),t._v(" "),e("tr",[e("td",[t._v("3")]),t._v(" "),e("td",[t._v("repeatable read")]),t._v(" "),e("td",[t._v("重复读取")])]),t._v(" "),e("tr",[e("td",[t._v("3")]),t._v(" "),e("td",[t._v("serializable")]),t._v(" "),e("td",[t._v("序列化")])])])]),t._v(" "),e("p",[t._v("没有通用的事务隔离，要根据业务实际设置。")]),t._v(" "),e("h4",{attrs:{id:"_1-3-1-买票【read-uncommitted】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-买票【read-uncommitted】"}},[t._v("#")]),t._v(" 1.3.1 买票【READ UNCOMMITTED】")]),t._v(" "),e("p",[e("img",{attrs:{src:a(324),alt:""}})]),t._v(" "),e("ol",[e("li",[t._v("A事务看到1A坐席状态“未售出”，便update语句修改 记录的状态“已售出”，但没有提交事务；")]),t._v(" "),e("li",[t._v("由于事务隔离，B事务也看到1A坐席状态“未售出”，update语句修改 记录的状态“已售出”，并很快提交事务。此时数据文件发生改变了。")]),t._v(" "),e("li",[t._v("此时，引发A事务发生回滚事件。虽然没有引起数据错误，但是频繁的购买失败用户体验不好。")]),t._v(" "),e("li",[t._v("此场景下，应该允许当前事务可以读取其他事务的状态。B事务发现A事务购买了1A坐席，B事务可以购买其他坐席。")])]),t._v(" "),e("p",[t._v("所以，👆用read uncommitted【读取未提交数据】")]),t._v(" "),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SESSION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ISOLATION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEVEL")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("READ")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UNCOMMITTED")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# SET SESSION 设置当前会话的隔离级别  非全局的")]),t._v("\n")])])]),e("blockquote",[e("p",[t._v("navicat面板1")])]),t._v(" "),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("START")]),t._v(" TRANSCATION"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" t_emp \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" sal"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("blockquote",[e("p",[t._v("navicat面板2")])]),t._v(" "),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("START")]),t._v(" TRANSCATION"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" ename"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sal "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_emp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("顺序执行，看出2中查询的数据是未修改的。")]),t._v(" "),e("blockquote",[e("p",[t._v("修改navicat面板2")])]),t._v(" "),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SESSION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ISOLATION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEVEL")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("READ")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UNCOMMITTED")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" ename"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sal "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_emp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMIT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("此时，可以看到面板1的数据了")]),t._v(" "),e("hr"),t._v(" "),e("h4",{attrs:{id:"_1-3-2-银行转账【read-committed】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-银行转账【read-committed】"}},[t._v("#")]),t._v(" 1.3.2 银行转账【READ COMMITTED】")]),t._v(" "),e("p",[t._v("事务A 向Scottz转账1000----\x3e Scottz账户5000 <---- 事务b支出100")]),t._v(" "),e("p",[t._v("Scottz账户有5000，此时A事务转1000给scottz，但还没来及做任何操作时，事务B支出100。")]),t._v(" "),e("p",[t._v("如果A、B都正常commit，是不会有差错的。但当B事务有回滚操作时，就没有100的支出。如果允许A事务读取B事务的临时数据，那么结果是5900【少了100】。")]),t._v(" "),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SESSION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ISOLATION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEVEL")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("READ")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMITTED")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# sql...")]),t._v("\n")])])]),e("hr"),t._v(" "),e("h4",{attrs:{id:"_1-3-3-用户下单了，但支付前商品涨价了【repeatable-read】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-用户下单了，但支付前商品涨价了【repeatable-read】"}},[t._v("#")]),t._v(" 1.3.3 用户下单了，但支付前商品涨价了【repeatable read】")]),t._v(" "),e("p",[t._v("事务A 下单 ----\x3e 商品价格350 <---- 事务b 涨价")]),t._v(" "),e("p",[t._v("按照下单价格支付。")]),t._v(" "),e("p",[t._v("我们希望当前事务的执行不受其他事务影响。甚至其他事务的提交的结果也不影响当前事务。")]),t._v(" "),e("p",[t._v("【repeatable read】代表事务在执行中，反复读取数据，得到的结果是一致的，不会收到其他事务影响。")]),t._v(" "),e("blockquote",[e("p",[t._v("navicat面板1")])]),t._v(" "),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置隔离级别")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SESSION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ISOLATION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEVEL")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("REPEATABLE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("READ")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启事务  ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("START")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#2")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" empno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ename"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sal "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_temp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#3")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMIT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#4")]),t._v("\n")])])]),e("blockquote",[e("p",[t._v("navicat面板2")])]),t._v(" "),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("START")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v(" t_emp  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#2")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" sal"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#3")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMIT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#4")]),t._v("\n")])])]),e("p",[t._v("面板1、2随机交替执行，只要面板2中commi比面板1的select先执行，面板1 select查询出的结果就已被面板2的修改了，与预想的不一样。")]),t._v(" "),e("p",[t._v("因为undo日志记录，需要操作数据才会有，也就是 面板1需要一开始就执行select，然后即使面板2commit了，也不会影响面板1select查询的结果。")]),t._v(" "),e("hr"),t._v(" "),e("h4",{attrs:{id:"事务序列化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#事务序列化"}},[t._v("#")]),t._v(" 事务序列化")]),t._v(" "),e("p",[t._v("由于事务并发执行所带来的各种问题，前三种隔离级别只适用再某些业务场景中，但是序列化的隔离性，让事务逐一执行，就不会产生上述问题了。")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("事务序列化降低数据库并发性")]),t._v(" "),e("p",[t._v("一旦设置事务序列化，当前会话需要等待其他事务执行结束才会执行，不再出现并发事务。虽然可以避免业务场景问题，但会导致并发性下降。所以很少使用。")])]),t._v(" "),e("div",{staticClass:"language-sql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SESSION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRANSACTION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ISOLATION")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEVEL")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SERIALIZABLE")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"_2-数据导出与导入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-数据导出与导入"}},[t._v("#")]),t._v(" 2 数据导出与导入")]),t._v(" "),e("h3",{attrs:{id:"_2-1-数据导出与备份的区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-数据导出与备份的区别"}},[t._v("#")]),t._v(" 2.1 数据导出与备份的区别")]),t._v(" "),e("p",[t._v("数据导出：导出的纯粹是业务数据\n数据备份，备份的是数据文件、日志文件、索引文件等。【分：全量备份、增量备份（只备份变动的部分）】")]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"_2-2-sql文件的导出与导入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-sql文件的导出与导入"}},[t._v("#")]),t._v(" 2.2 SQL文件的导出与导入")]),t._v(" "),e("p",[t._v("数据导出可以分：")]),t._v(" "),e("ol",[e("li",[t._v("SQL文档【数据量少时推荐】")]),t._v(" "),e("li",[t._v("文本文档【大】")])]),t._v(" "),e("hr"),t._v(" "),e("h4",{attrs:{id:"_2-2-1-导出sql文件【mysqldump】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-导出sql文件【mysqldump】"}},[t._v("#")]),t._v(" 2.2.1 导出SQL文件【mysqldump】")]),t._v(" "),e("p",[t._v("mysqldump 把业务数据导出成SQL文件，包括表结构")]),t._v(" "),e("div",{staticClass:"language-sell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("# mysqldump -uroot -p [no-data] 逻辑库>路径\nmysqldump -uroot -p demo>D:/MBA/demo.sql\n")])])]),e("p",[t._v("加上 no-data 只导出表结构。不加[no-data] 就是表结构跟业务数据都导出")]),t._v(" "),e("hr"),t._v(" "),e("h4",{attrs:{id:"_2-2-2-导入sql文件【source】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-导入sql文件【source】"}},[t._v("#")]),t._v(" 2.2.2 导入SQL文件【source】")]),t._v(" "),e("p",[t._v("需要再mysql命令行中")]),t._v(" "),e("div",{staticClass:"language-sell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('# 先登陆数据库\nmysql -uroot -p\n# "-p"代表用密码登陆\n\nsql > USE demo;\nsql > SOURCE xx.sql;\n')])])]),e("h3",{attrs:{id:"txt文档的导入与导出【速度快】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#txt文档的导入与导出【速度快】"}},[t._v("#")]),t._v(" TXT文档的导入与导出【速度快】")]),t._v(" "),e("p",[t._v("需要先导出表结构，再导出txt文件")]),t._v(" "),e("p",[t._v("导入的时候，先导入表结构.sql文件，再导入txt文件")]),t._v(" "),e("p",[t._v("注意附加选项【第一个数据行】，并设置对应字段。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("乱码")]),t._v(" "),e("p",[t._v("由于字符集原因，可能会有中文字符乱码，不过不影响导入")])])])}),[],!1,null,null,null);s.default=r.exports}}]);