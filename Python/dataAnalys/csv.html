<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CSV | 欢迎回来 ！</title>
    <meta name="description" content="lcsx">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/blog/assets/css/0.styles.ee874cfe.css" as="style"><link rel="preload" href="/blog/assets/js/app.7a4660d2.js" as="script"><link rel="preload" href="/blog/assets/js/2.85e08d05.js" as="script"><link rel="preload" href="/blog/assets/js/9.33061631.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.573da17f.js"><link rel="prefetch" href="/blog/assets/js/11.5a02348c.js"><link rel="prefetch" href="/blog/assets/js/12.d8c9c1bd.js"><link rel="prefetch" href="/blog/assets/js/13.e09bb963.js"><link rel="prefetch" href="/blog/assets/js/14.d23ca837.js"><link rel="prefetch" href="/blog/assets/js/15.c4683e2a.js"><link rel="prefetch" href="/blog/assets/js/16.c660c97d.js"><link rel="prefetch" href="/blog/assets/js/17.49bf184a.js"><link rel="prefetch" href="/blog/assets/js/18.9be995ca.js"><link rel="prefetch" href="/blog/assets/js/19.df144b24.js"><link rel="prefetch" href="/blog/assets/js/20.5aad5a93.js"><link rel="prefetch" href="/blog/assets/js/21.262a03c1.js"><link rel="prefetch" href="/blog/assets/js/22.7fed5ac6.js"><link rel="prefetch" href="/blog/assets/js/23.6aa0be70.js"><link rel="prefetch" href="/blog/assets/js/24.09d96859.js"><link rel="prefetch" href="/blog/assets/js/25.418504a4.js"><link rel="prefetch" href="/blog/assets/js/26.f0584d72.js"><link rel="prefetch" href="/blog/assets/js/27.cd44913e.js"><link rel="prefetch" href="/blog/assets/js/28.4f5c209f.js"><link rel="prefetch" href="/blog/assets/js/29.2dcd5c40.js"><link rel="prefetch" href="/blog/assets/js/3.11e700f0.js"><link rel="prefetch" href="/blog/assets/js/30.d2e1f594.js"><link rel="prefetch" href="/blog/assets/js/31.7b1f9108.js"><link rel="prefetch" href="/blog/assets/js/32.f4856997.js"><link rel="prefetch" href="/blog/assets/js/33.f6007bb0.js"><link rel="prefetch" href="/blog/assets/js/34.974aeb16.js"><link rel="prefetch" href="/blog/assets/js/35.af78c18d.js"><link rel="prefetch" href="/blog/assets/js/36.0a0639ee.js"><link rel="prefetch" href="/blog/assets/js/37.3a26ab2f.js"><link rel="prefetch" href="/blog/assets/js/38.ba809f55.js"><link rel="prefetch" href="/blog/assets/js/39.fb48ae1b.js"><link rel="prefetch" href="/blog/assets/js/4.31720545.js"><link rel="prefetch" href="/blog/assets/js/40.639ac403.js"><link rel="prefetch" href="/blog/assets/js/41.182c195e.js"><link rel="prefetch" href="/blog/assets/js/42.bd60b723.js"><link rel="prefetch" href="/blog/assets/js/43.7f4ee63e.js"><link rel="prefetch" href="/blog/assets/js/44.1345cf6d.js"><link rel="prefetch" href="/blog/assets/js/45.f0b98685.js"><link rel="prefetch" href="/blog/assets/js/46.97e7267e.js"><link rel="prefetch" href="/blog/assets/js/47.2c6a6d63.js"><link rel="prefetch" href="/blog/assets/js/48.faebaa80.js"><link rel="prefetch" href="/blog/assets/js/49.49af56c0.js"><link rel="prefetch" href="/blog/assets/js/5.232758e0.js"><link rel="prefetch" href="/blog/assets/js/50.b6235237.js"><link rel="prefetch" href="/blog/assets/js/51.8bb71e61.js"><link rel="prefetch" href="/blog/assets/js/52.a8d8e7ae.js"><link rel="prefetch" href="/blog/assets/js/53.259ab2d4.js"><link rel="prefetch" href="/blog/assets/js/54.a1620682.js"><link rel="prefetch" href="/blog/assets/js/55.15b38884.js"><link rel="prefetch" href="/blog/assets/js/56.408630af.js"><link rel="prefetch" href="/blog/assets/js/57.b6ac7546.js"><link rel="prefetch" href="/blog/assets/js/58.82664ed4.js"><link rel="prefetch" href="/blog/assets/js/59.339098b4.js"><link rel="prefetch" href="/blog/assets/js/6.0bf13852.js"><link rel="prefetch" href="/blog/assets/js/60.56bec4a5.js"><link rel="prefetch" href="/blog/assets/js/61.1d5e0a93.js"><link rel="prefetch" href="/blog/assets/js/62.caa7d838.js"><link rel="prefetch" href="/blog/assets/js/63.b2935415.js"><link rel="prefetch" href="/blog/assets/js/64.27d92569.js"><link rel="prefetch" href="/blog/assets/js/65.f84cda40.js"><link rel="prefetch" href="/blog/assets/js/66.1585871d.js"><link rel="prefetch" href="/blog/assets/js/67.dd596334.js"><link rel="prefetch" href="/blog/assets/js/68.7f108fcc.js"><link rel="prefetch" href="/blog/assets/js/69.e67a606a.js"><link rel="prefetch" href="/blog/assets/js/7.1e456cb7.js"><link rel="prefetch" href="/blog/assets/js/70.7ca5af58.js"><link rel="prefetch" href="/blog/assets/js/71.9ec68011.js"><link rel="prefetch" href="/blog/assets/js/72.50a3a3b0.js"><link rel="prefetch" href="/blog/assets/js/73.e2564842.js"><link rel="prefetch" href="/blog/assets/js/74.b0c6fc38.js"><link rel="prefetch" href="/blog/assets/js/8.3c5dcc01.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.ee874cfe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="https://vuejs.org/images/logo.png" alt="欢迎回来 ！" class="logo"> <span class="site-name can-hide">欢迎回来 ！</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/xml/" class="nav-link">
  XML
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/JDBC/" class="nav-link">
  JDBC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link router-link-active">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mysql/mysql_study/" class="nav-link">
  MySQL基础
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/xml/" class="nav-link">
  XML
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/JDBC/" class="nav-link">
  JDBC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link router-link-active">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mysql/mysql_study/" class="nav-link">
  MySQL基础
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/Python/dataAnalys/BasisOfPython.html" class="sidebar-link">python基础</a></li><li><a href="/blog/Python/dataAnalys/csv.html" class="active sidebar-link">CSV</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Python/dataAnalys/csv.html#文件打开模式" class="sidebar-link">文件打开模式</a></li><li class="sidebar-sub-header"><a href="/blog/Python/dataAnalys/csv.html#不使用csv模块" class="sidebar-link">不使用csv模块</a></li><li class="sidebar-sub-header"><a href="/blog/Python/dataAnalys/csv.html#筛选特定的行" class="sidebar-link">筛选特定的行</a></li></ul></li><li><a href="/blog/Python/dataAnalys/Excel.html" class="sidebar-link">Excel</a></li><li><a href="/blog/Python/dataAnalys/mix.html" class="sidebar-link">多个不同文件，单个文件多个表</a></li><li><a href="/blog/Python/dataAnalys/matplotlib.html" class="sidebar-link">matplotlib</a></li><li><a href="/blog/Python/dataAnalys/xiangxiantu.html" class="sidebar-link">箱线图</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="csv"><a href="#csv" class="header-anchor">#</a> CSV</h1> <p>CSV（comma-separated value，逗号分隔值）文件格式是一种非常简单的数据存储与分享
方式。CSV 文件将数据表格存储为纯文本，表格（或电子表格）中的每个单元格都是一个
数值或字符串。与 Excel 文件相比，CSV 文件的一个主要优点是有很多程序可以存储、转
换和处理纯文本文件；相比之下，能够处理 Excel 文件的程序却不多。所有电子表格程序、
文字处理程序或简单的文本编辑器都可以处理纯文本文件，但不是所有的程序都能处理
Excel 文件。尽管 Excel 是一个功能非常强大的工具，但是当你使用 Excel 文件时，还是会
被局限在 Excel 提供的功能范围内。</p> <p>当你使用 CSV 文件时，确实会失去某些 Excel 功能：在 Excel 电子表格中，每个单元格都
有一个定义好的“类型”（数值、文本、货币、日期等），CSV 文件中的单元格则只是原
始数据。幸好，Python 在识别不同数据类型方面相当聪明，第 1 章中已经展示了这一点。
使用 CSV 文件的另一个问题是它只能保存数据，不能保存公式。但是，通过将数据存储
（CSV 文件）和数据处理（Python 脚本）分离，你可以很容易地在不同数据集上进行加工
处理。当数据存储和数据处理过程分开进行时，错误（不管是数据处理中的错误，还是数
据存储中的错误）不但更容易被发现，而且更难扩散。</p> <p><strong>csv只有一个sheet表，与excel不同</strong></p> <p></p><div class="table-of-contents"><ul><li><a href="#csv">CSV</a><ul><li><a href="#文件打开模式">文件打开模式</a></li><li><a href="#不使用csv模块">不使用csv模块</a></li><li><a href="#筛选特定的行">筛选特定的行</a><ul><li><a href="#行中的值满足某个条件">行中的值满足某个条件</a></li><li><a href="#行中的值属于某个集合">行中的值属于某个集合</a></li><li><a href="#行中的值匹配于某个模式（正则表达式）">行中的值匹配于某个模式（正则表达式）</a><ul><li><a href="#next">next()</a></li></ul></li><li><a href="#pandas的loc">pandas的loc</a></li><li><a href="#pandas取行列数据的更多操作">pandas取行列数据的更多操作</a><ul><li><a href="#iloc-函数来根据索引位置选取列">iloc 函数来根据索引位置选取列</a></li><li><a href="#两种列索引方式">两种列索引方式</a></li></ul></li><li><a href="#丢弃行数据">丢弃行数据</a></li><li><a href="#添加标题">添加标题</a><ul><li><a href="#pandas方式">pandas方式</a></li></ul></li><li><a href="#读取多个cvs">读取多个cvs</a><ul><li><a href="#遍历多个文件，将平均值输出单独文件">遍历多个文件，将平均值输出单独文件</a></li><li><a href="#pandas方式">pandas方式</a></li></ul></li></ul></li></ul></li></ul></div><p></p> <h2 id="文件打开模式"><a href="#文件打开模式" class="header-anchor">#</a> 文件打开模式</h2> <p><img src="/blog/assets/img/python1.3a965c75.png" alt=""></p> <h2 id="不使用csv模块"><a href="#不使用csv模块" class="header-anchor">#</a> 不使用csv模块</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> sys

input_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\data\data\aa.csv'</span>
output_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\a.txt'</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> filereader<span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> filewriter<span class="token punctuation">:</span>
        header <span class="token operator">=</span> filereader<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>      
        <span class="token keyword">print</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span>
        header <span class="token operator">=</span> header<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        header_list <span class="token operator">=</span> header<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>header_list<span class="token punctuation">)</span>
        filewriter<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span>header_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>   <span class="token comment"># filewriter.write(是str字符串而不是DataFrame)</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> filereader<span class="token punctuation">:</span>
            row <span class="token operator">=</span> row<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
            row_list <span class="token operator">=</span> row<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>row_list<span class="token punctuation">)</span>
            filewriter<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span>row_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>filereader.readline() 上面文件被读过第一行后，下面语句for row in filereader里就不包括读过的那行了</strong> <strong>with open(output_file, 'w', newline='') as filewriter ，then filewriter.write(是直接写入的是str字符串)</strong> <strong>filewriter = csv.writer(csv_out_file)，  filewriter.writerow(这是是DataFrame)</strong></p> <table><thead><tr><th style="text-align:center;">函数</th> <th style="text-align:center;">解释</th> <th style="text-align:center;"></th></tr></thead> <tbody><tr><td style="text-align:center;">fileObject.readline(size)</td> <td style="text-align:center;">用于从文件读取整行，如果指定了一个非负数的参数，则返回指定大小的字节数，包括 &quot;\n&quot; 字符</td> <td style="text-align:center;">readline()读取第一行，</td></tr> <tr><td style="text-align:center;">str.join(sequence)</td> <td style="text-align:center;">将序列中的元素以指定的字符连接生成一个新的字符串</td> <td style="text-align:center;">','.join(map(str,header_list)) -- header_list序列转str后用,连结</td></tr> <tr><td style="text-align:center;">map(function, iterable, ...)</td> <td style="text-align:center;">会根据提供的函数对指定序列做映射</td> <td style="text-align:center;">map(lambda x: x ** 2, [1, 2, 3, 4, 5])</td></tr></tbody></table> <h2 id="筛选特定的行"><a href="#筛选特定的行" class="header-anchor">#</a> 筛选特定的行</h2> <h3 id="行中的值满足某个条件"><a href="#行中的值满足某个条件" class="header-anchor">#</a> 行中的值满足某个条件</h3> <h3 id="行中的值属于某个集合"><a href="#行中的值属于某个集合" class="header-anchor">#</a> 行中的值属于某个集合</h3> <h3 id="行中的值匹配于某个模式（正则表达式）"><a href="#行中的值匹配于某个模式（正则表达式）" class="header-anchor">#</a> 行中的值匹配于某个模式（正则表达式）</h3> <h4 id="next"><a href="#next" class="header-anchor">#</a> next()</h4> <p>next() 返回迭代器的下一个项目,next() 函数要和生成迭代器的iter() 函数一起使用,这里估计是有了iter了吧
同样，next()后，后面的文件读取就不包括刚才的那行数据了</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> csv
<span class="token keyword">import</span> sys
input_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\data\data\aa.csv'</span>
output_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\a.txt'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csv_in_file<span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csv_out_file<span class="token punctuation">:</span>
        filereader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>csv_in_file<span class="token punctuation">)</span>
        filewriter <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csv_out_file<span class="token punctuation">)</span>
        header <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>filereader<span class="token punctuation">)</span>        <span class="token comment"># next() 返回迭代器的下一个项目,next() 函数要和生成迭代器的iter() 函数一起使用,这里估计是有了iter了吧</span>
        <span class="token comment"># 同样，next()后，后面的文件读取就不包括刚才的那行数据了</span>
        
        <span class="token keyword">for</span> row_list <span class="token keyword">in</span> filereader<span class="token punctuation">:</span>
            supplier <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>row_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>supplier<span class="token punctuation">)</span>
        <span class="token comment">#     cost = str(row_list[3]).strip('$').replace(',', '')</span>
        <span class="token comment">#     if supplier == 'Supplier Z' or float(cost) &gt; 600.0:</span>
        <span class="token comment">#         filewriter.writerow(row_list)</span>
</code></pre></div><h3 id="pandas的loc"><a href="#pandas的loc" class="header-anchor">#</a> pandas的loc</h3> <p>pandas 提供了一个 loc 函数，可以同时选择特定的行与列。你需要在逗号前面设定行筛选条件，在逗号后面设定列筛选条件。</p> <div class="language-python extra-class"><pre class="language-python"><code>pd<span class="token punctuation">.</span>loc<span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>列label1<span class="token punctuation">)</span>   <span class="token comment"># 获取所有行，列名称为label1</span>
pd<span class="token punctuation">.</span>loc<span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span>列label1<span class="token punctuation">,</span>列label2<span class="token punctuation">]</span><span class="token punctuation">)</span> 
pd<span class="token punctuation">.</span>loc<span class="token punctuation">(</span><span class="token punctuation">[</span>行条件<span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token comment"># :表示所有</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># #!/usr/bin/env python3</span>
<span class="token comment"># import csv</span>
<span class="token comment"># import sys</span>
<span class="token comment"># input_file = r'C:\Users\46957\Desktop\pytest\data\data\aa.csv'</span>
<span class="token comment"># output_file = r'C:\Users\46957\Desktop\pytest\basisofpython\a.txt'</span>
<span class="token comment"># with open(input_file, 'r', newline='') as csv_in_file:</span>
<span class="token comment">#     with open(output_file, 'w', newline='') as csv_out_file:</span>
<span class="token comment">#         filereader = csv.reader(csv_in_file)</span>
<span class="token comment">#         filewriter = csv.writer(csv_out_file)</span>
<span class="token comment">#         header = next(filereader)        # next() 返回迭代器的下一个项目,next() 函数要和生成迭代器的iter() 函数一起使用,这里估计是有了iter了吧</span>
<span class="token comment">#         # 同样，next()后，后面的文件读取就不包括刚才的那行数据了</span>
        
<span class="token comment">#         for row_list in filereader:</span>
<span class="token comment">#             supplier = str(row_list[0]).strip()</span>
<span class="token comment">#             print(supplier)</span>
<span class="token comment">#             cost = str(row_list[3]).strip('$').replace(',', '')</span>
<span class="token comment">#         #     if supplier == 'Supplier Z' or float(cost) &gt; 600.0:</span>
<span class="token comment">#         #         filewriter.writerow(row_list)                          # filewriter.writerow(这是是DataFrame)</span>

<span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> sys
input_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\data\data\aa.csv'</span>
output_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\bb.csv'</span>
data_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>input_file<span class="token punctuation">)</span>
data_frame<span class="token punctuation">[</span><span class="token string">'satisfaction_level'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data_frame<span class="token punctuation">[</span><span class="token string">'satisfaction_level'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'$'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>
<span class="token comment"># print(data_frame['satisfaction_level'])</span>

<span class="token comment"># pandas 提供了一个 loc 函数，可以同时选择特定的行与列。你需要在逗号前面设定行筛选条件，在逗号后面设定列筛选条件。</span>

data_frame_value_meets_condition <span class="token operator">=</span> data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'low'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>data_frame<span class="token punctuation">[</span><span class="token string">'satisfaction_level'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0.11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token comment"># data_frame_value_meets_condition.to_csv(output_file, index=False)</span>
<span class="token comment"># print(data_frame_value_meets_condition)</span>

data_frame_value_meets_condition222 <span class="token operator">=</span> data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">&quot;department&quot;</span><span class="token punctuation">]</span>
data_frame_value_meets_condition222 <span class="token operator">=</span> data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;department&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;satisfaction_level&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data_frame_value_meets_condition222<span class="token punctuation">)</span>
data_frame_value_meets_condition222<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="pandas取行列数据的更多操作"><a href="#pandas取行列数据的更多操作" class="header-anchor">#</a> pandas取行列数据的更多操作</h3> <p><strong>header=None决定0开始在哪里</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>data_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/blog/assets/img/pandas1.238160f2.png" alt=""></p> <h4 id="iloc-函数来根据索引位置选取列"><a href="#iloc-函数来根据索引位置选取列" class="header-anchor">#</a> iloc 函数来根据索引位置选取列</h4> <h4 id="两种列索引方式"><a href="#两种列索引方式" class="header-anchor">#</a> 两种列索引方式</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> csv
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> sys
input_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\data\data\aa.csv'</span>
output_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\bb.csv'</span>
data_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>input_file<span class="token punctuation">)</span>
data_frame<span class="token punctuation">[</span><span class="token string">'satisfaction_level'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data_frame<span class="token punctuation">[</span><span class="token string">'satisfaction_level'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'$'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>

<span class="token comment"># 列索引</span>
<span class="token comment"># 按索引取第一，第四列数据</span>
my_columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csv_in_file<span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csv_out_file<span class="token punctuation">:</span>
        filereader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>csv_in_file<span class="token punctuation">)</span>
        filewriter <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csv_out_file<span class="token punctuation">)</span>
        <span class="token keyword">for</span> row_list <span class="token keyword">in</span> filereader<span class="token punctuation">:</span>
            row_list_output <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
            <span class="token keyword">for</span> index_value <span class="token keyword">in</span> my_columns<span class="token punctuation">:</span>
                row_list_output<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row_list<span class="token punctuation">[</span>index_value<span class="token punctuation">]</span><span class="token punctuation">)</span>
            filewriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>row_list_output<span class="token punctuation">)</span>

        data_frame<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># dataFrame.to_csv(输出地址)</span>
</code></pre></div><p><strong>dataFrame.to_csv(输出地址)</strong> <strong>csv_out_file可以直接write(str)</strong> <strong>writerow(dataFrame字符串序列)</strong></p> <h3 id="丢弃行数据"><a href="#丢弃行数据" class="header-anchor">#</a> 丢弃行数据</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
data_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">)</span>
data_frame <span class="token operator">=</span> data_frame<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment">#（也就是行索引为 0，1，2 的那些行）</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">)</span>

data_frame<span class="token punctuation">.</span>columns <span class="token operator">=</span> data_frame<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>


data_frame <span class="token operator">=</span> data_frame<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>data_frame<span class="token punctuation">.</span>index<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># 删掉了0，1，4行，重新计算第一行的index，从原来的index为2开始</span>
<span class="token comment"># print(data_frame)</span>

data_frame<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="添加标题"><a href="#添加标题" class="header-anchor">#</a> 添加标题</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 添加标题</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csv_in_file<span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csv_out_file<span class="token punctuation">:</span>
        filereader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>csv_in_file<span class="token punctuation">)</span>
        filewriter <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csv_out_file<span class="token punctuation">)</span>
        header_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Supplier Name'</span><span class="token punctuation">,</span> <span class="token string">'Invoice Number'</span><span class="token punctuation">,</span>\
        <span class="token string">'Part Number'</span><span class="token punctuation">,</span> <span class="token string">'Cost'</span><span class="token punctuation">,</span> <span class="token string">'Purchase Date'</span><span class="token punctuation">]</span>
        filewriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>header_list<span class="token punctuation">)</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> filereader<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
            filewriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>row<span class="token punctuation">)</span>	
</code></pre></div><h4 id="pandas方式"><a href="#pandas方式" class="header-anchor">#</a> pandas方式</h4> <div class="language-python extra-class"><pre class="language-python"><code>header_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Supplier Name'</span><span class="token punctuation">,</span> <span class="token string">'Invoice Number'</span><span class="token punctuation">,</span>\
<span class="token string">'Part Number'</span><span class="token punctuation">,</span> <span class="token string">'Cost'</span><span class="token punctuation">,</span> <span class="token string">'Purchase Date'</span><span class="token punctuation">]</span>
data_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span>header_list<span class="token punctuation">)</span>
data_frame<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>data_frame = pd.read_csv(input_file, header=None, names=header_list)</strong></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>header 决定第一行从哪里开始，header=None 就是列上无标签的那种，直接第一行就是数据
names  标题</p></div> <h3 id="读取多个cvs"><a href="#读取多个cvs" class="header-anchor">#</a> 读取多个cvs</h3> <p>两种方式，将多个输入文件中的数据垂直连接成一个输出文件</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> glob
<span class="token keyword">import</span> os
<span class="token keyword">import</span> csv
<span class="token comment"># 读取多个csv文件，输出到一个文件中</span>

input_dir <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\mulu\bianliduogecvs'</span>
output_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\bb.csv'</span>

filelist <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>input_dir<span class="token punctuation">,</span><span class="token string">&quot;*.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># print(filelist)</span>
file_count <span class="token operator">=</span> <span class="token number">0</span>

<span class="token comment"># 方式1</span>
<span class="token comment"># 通过csv.writer(csv_out_file)，就可以writerow(list数据)</span>
first_file <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> filelist<span class="token punctuation">:</span>
    file_count <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>newline<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csv_in_file<span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span>newline<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csv_out_file<span class="token punctuation">:</span>
            filereader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>csv_in_file<span class="token punctuation">)</span>
            filewriter <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csv_out_file<span class="token punctuation">)</span>
            <span class="token keyword">if</span> first_file<span class="token punctuation">:</span>
                <span class="token keyword">for</span> row <span class="token keyword">in</span> filereader<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>   <span class="token comment">#['$0.38 ', '0.53', '2', '157', '3', '0', '1', '0', 'sales', 'low']</span>
                    filewriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>row<span class="token punctuation">)</span>
                first_file <span class="token operator">=</span> <span class="token boolean">False</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                header <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>filereader<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> row <span class="token keyword">in</span> filereader<span class="token punctuation">:</span>
                    filewriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>row<span class="token punctuation">)</span>


<span class="token comment"># pandas方式</span>
<span class="token comment"># dataframe.to_csv()</span>
all_data_frames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> filelist<span class="token punctuation">:</span>
    data_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
    all_data_frames<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data_frame<span class="token punctuation">)</span>
data_frame_concat <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>all_data_frames<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
data_frame_concat<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment"># to_csv可不管你open的mode模式哦，直接是覆盖，所以先将数据append，再统一concat，然后输出</span>



<span class="token keyword">print</span><span class="token punctuation">(</span>file_count<span class="token punctuation">)</span>

</code></pre></div><p><strong>dataframe.append(dataframe)再统一concat,最后dataFrame.to_csv()</strong></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>这段代码垂直堆叠数据框。如果你需要平行连接数据，那么就在 concat 函数中设置axis=1。
除了数据框，pandas 中还有一个数据容器，称为序列。你可以使用同样的语法去连接序列，只是要将连接的对象由数据框（是dataFrame？）改为序列。</p></div> <h4 id="遍历多个文件，将平均值输出单独文件"><a href="#遍历多个文件，将平均值输出单独文件" class="header-anchor">#</a> 遍历多个文件，将平均值输出单独文件</h4> <h5 id="非pandas"><a href="#非pandas" class="header-anchor">#</a> 非pandas</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> csv
<span class="token keyword">import</span> glob
<span class="token keyword">import</span> os
<span class="token keyword">import</span> sys
input_dir <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\mulu\bianliduogecvs'</span>
output_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\lcs.csv'</span>
output_header_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'file_name'</span><span class="token punctuation">,</span><span class="token string">'total_satisfaction_level'</span><span class="token punctuation">,</span> <span class="token string">'average_satisfaction_level'</span><span class="token punctuation">]</span>
csv_out_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
filewriter <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>csv_out_file<span class="token punctuation">)</span>
filewriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>output_header_list<span class="token punctuation">)</span>

<span class="token keyword">for</span> input_file <span class="token keyword">in</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>input_dir<span class="token punctuation">,</span><span class="token string">&quot;*.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csv_in_file<span class="token punctuation">:</span>
        filereader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>csv_in_file<span class="token punctuation">)</span>
        output_list <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
        output_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>input_file<span class="token punctuation">)</span><span class="token punctuation">)</span>    
        header <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>filereader<span class="token punctuation">)</span>
        total_satisfaction_level <span class="token operator">=</span> <span class="token number">0.0</span>
        number_of_sales <span class="token operator">=</span> <span class="token number">0</span>
        average_satisfaction_level <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> filereader<span class="token punctuation">:</span>
            satisfaction_level <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            total_satisfaction_level <span class="token operator">+=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>satisfaction_level<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'$'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            number_of_sales <span class="token operator">+=</span> <span class="token number">1</span>
        average_satisfaction_level <span class="token operator">=</span> <span class="token string">'{0:.2f}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>total_satisfaction_level <span class="token operator">/</span> number_of_sales<span class="token punctuation">)</span>
        output_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>total_satisfaction_level<span class="token punctuation">)</span>
        output_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>average_satisfaction_level<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>output_list<span class="token punctuation">)</span>
        filewriter<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>output_list<span class="token punctuation">)</span>
csv_out_file<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>os.path.basename(input_file)获取文件名，不包含后缀</strong></p> <p><img src="data:image/png;base64,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" alt=""></p> <h4 id="pandas方式-2"><a href="#pandas方式-2" class="header-anchor">#</a> pandas方式</h4> <p>pandas 提供了可以用来计算行和列统计量的摘要统计函数，比如 sum 和 mean。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> glob
<span class="token keyword">import</span> os
<span class="token keyword">import</span> sys
input_dir <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\mulu\bianliduogecvs'</span>
output_file <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest\basisofpython\lcs1.csv'</span>
all_files <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>input_dir<span class="token punctuation">,</span><span class="token string">&quot;*.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
all_data_frames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> input_file <span class="token keyword">in</span> all_files<span class="token punctuation">:</span>
    data_frame <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>

    total_satisfaction_level <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'$'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span> \
    <span class="token keyword">for</span> value <span class="token keyword">in</span> data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'satisfaction_level'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    average_satisfaction_level <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'$'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span> \
    <span class="token keyword">for</span> value <span class="token keyword">in</span> data_frame<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'satisfaction_level'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'file_name'</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>input_file<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'total_satisfaction_level'</span><span class="token punctuation">:</span> total_satisfaction_level<span class="token punctuation">,</span>\
	<span class="token string">'average_satisfaction_level'</span><span class="token punctuation">:</span> average_satisfaction_level<span class="token punctuation">}</span>
	
    all_data_frames<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'file_name'</span><span class="token punctuation">,</span> <span class="token string">'total_satisfaction_level'</span><span class="token punctuation">,</span> \
	<span class="token string">'average_satisfaction_level'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># 序列list传到dataFrame</span>

data_frames_concat <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>all_data_frames<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
data_frames_concat<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>获取dataFrame里，某列，所有行(有&quot;:&quot;)的和</p> <p>pd.DataFrame([float(str(value).strip('$').replace(',','')) for value in data_frame.loc[:, 'satisfaction_level']]).sum()</p> <p>将序列list，如一个object传到dataframe</p> <p>通过pd.DataFrame(object,columns=[&quot;列标题1&quot;,&quot;列标题2&quot;]👇👇👇👇👇👇</p> <p>data = {'file_name': os.path.basename(input_file),'total_satisfaction_level': total_satisfaction_level}</p> <p>使用数据框函数将这个对象转换为一个 DataFrame👇👇👇👇👇</p> <p>data_frames.append(pd.DataFrame(data, columns=['file_name', 'total_satisfaction_level']))</p> <p>使用 concat 函数将这些数据框连接成为一个数据框，然后将这个数据框写入输出文件</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/Python/dataAnalys/BasisOfPython.html" class="prev">
        python基础
      </a></span> <span class="next"><a href="/blog/Python/dataAnalys/Excel.html">
        Excel
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.7a4660d2.js" defer></script><script src="/blog/assets/js/2.85e08d05.js" defer></script><script src="/blog/assets/js/9.33061631.js" defer></script>
  </body>
</html>
