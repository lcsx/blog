<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据分析的基本过程 | 欢迎回来 ！</title>
    <meta name="description" content="lcsx">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/blog/assets/css/0.styles.ee874cfe.css" as="style"><link rel="preload" href="/blog/assets/js/app.750f600d.js" as="script"><link rel="preload" href="/blog/assets/js/2.be40518a.js" as="script"><link rel="preload" href="/blog/assets/js/45.9a380f1d.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.0546ef3d.js"><link rel="prefetch" href="/blog/assets/js/11.bcb525bf.js"><link rel="prefetch" href="/blog/assets/js/12.0a87404f.js"><link rel="prefetch" href="/blog/assets/js/13.36c618f3.js"><link rel="prefetch" href="/blog/assets/js/14.6779eab1.js"><link rel="prefetch" href="/blog/assets/js/15.3f82a46b.js"><link rel="prefetch" href="/blog/assets/js/16.aa00ba37.js"><link rel="prefetch" href="/blog/assets/js/17.198e465e.js"><link rel="prefetch" href="/blog/assets/js/18.ef11d9bb.js"><link rel="prefetch" href="/blog/assets/js/19.9658a171.js"><link rel="prefetch" href="/blog/assets/js/20.88c2f604.js"><link rel="prefetch" href="/blog/assets/js/21.20a875d5.js"><link rel="prefetch" href="/blog/assets/js/22.82e94915.js"><link rel="prefetch" href="/blog/assets/js/23.84751b50.js"><link rel="prefetch" href="/blog/assets/js/24.f814175f.js"><link rel="prefetch" href="/blog/assets/js/25.3b2d9b9f.js"><link rel="prefetch" href="/blog/assets/js/26.e17073c9.js"><link rel="prefetch" href="/blog/assets/js/27.5e53d8cc.js"><link rel="prefetch" href="/blog/assets/js/28.ecc0597a.js"><link rel="prefetch" href="/blog/assets/js/29.d3af9c62.js"><link rel="prefetch" href="/blog/assets/js/3.3f5e4793.js"><link rel="prefetch" href="/blog/assets/js/30.bb079fbc.js"><link rel="prefetch" href="/blog/assets/js/31.41c112e5.js"><link rel="prefetch" href="/blog/assets/js/32.80d19a68.js"><link rel="prefetch" href="/blog/assets/js/33.36814006.js"><link rel="prefetch" href="/blog/assets/js/34.abc0b8e6.js"><link rel="prefetch" href="/blog/assets/js/35.df043a34.js"><link rel="prefetch" href="/blog/assets/js/36.f312575f.js"><link rel="prefetch" href="/blog/assets/js/37.33c80704.js"><link rel="prefetch" href="/blog/assets/js/38.69642553.js"><link rel="prefetch" href="/blog/assets/js/39.0cea3412.js"><link rel="prefetch" href="/blog/assets/js/4.30f3bdbf.js"><link rel="prefetch" href="/blog/assets/js/40.289a1687.js"><link rel="prefetch" href="/blog/assets/js/41.82daf623.js"><link rel="prefetch" href="/blog/assets/js/42.4dfb8e6a.js"><link rel="prefetch" href="/blog/assets/js/43.beff70ba.js"><link rel="prefetch" href="/blog/assets/js/44.ac862948.js"><link rel="prefetch" href="/blog/assets/js/46.58bac913.js"><link rel="prefetch" href="/blog/assets/js/47.fdfbb777.js"><link rel="prefetch" href="/blog/assets/js/48.47d134be.js"><link rel="prefetch" href="/blog/assets/js/49.307f5655.js"><link rel="prefetch" href="/blog/assets/js/5.f39c54a6.js"><link rel="prefetch" href="/blog/assets/js/50.5ed6c291.js"><link rel="prefetch" href="/blog/assets/js/51.7b7da84e.js"><link rel="prefetch" href="/blog/assets/js/52.93c7b5ba.js"><link rel="prefetch" href="/blog/assets/js/53.29f6ef58.js"><link rel="prefetch" href="/blog/assets/js/54.65a57094.js"><link rel="prefetch" href="/blog/assets/js/55.7a349a90.js"><link rel="prefetch" href="/blog/assets/js/56.f109ff2f.js"><link rel="prefetch" href="/blog/assets/js/57.ea0ead20.js"><link rel="prefetch" href="/blog/assets/js/58.2b7e194c.js"><link rel="prefetch" href="/blog/assets/js/59.db3c2c46.js"><link rel="prefetch" href="/blog/assets/js/6.8bfa4c02.js"><link rel="prefetch" href="/blog/assets/js/60.07ecc8b2.js"><link rel="prefetch" href="/blog/assets/js/61.41aab930.js"><link rel="prefetch" href="/blog/assets/js/62.011049e0.js"><link rel="prefetch" href="/blog/assets/js/7.dcdaa74b.js"><link rel="prefetch" href="/blog/assets/js/8.07dbe7a8.js"><link rel="prefetch" href="/blog/assets/js/9.8f7ddf42.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.ee874cfe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="https://vuejs.org/images/logo.png" alt="欢迎回来 ！" class="logo"> <span class="site-name can-hide">欢迎回来 ！</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/Python/zhihu/basis.html" class="sidebar-link">基础不牢 地动山摇</a></li><li><a href="/blog/Python/zhihu/confidenceInterval.html" class="sidebar-link">置信区间</a></li><li><a href="/blog/Python/zhihu/HypothesisTesting.html" class="sidebar-link">假设检验</a></li><li><a href="/blog/Python/zhihu/t1.html" class="sidebar-link">案例</a></li><li><a href="/blog/Python/zhihu/t3.html" class="sidebar-link">相关配对t检验</a></li><li><a href="/blog/Python/zhihu/t2.html" class="sidebar-link">独立双样本t检验</a></li><li><a href="/blog/Python/zhihu/correlationAnalysis.html" class="sidebar-link">相关分析+Excel分析&amp;绘图</a></li><li><a href="/blog/Python/zhihu/introductionDataAnalysis.html" class="sidebar-link">描述统计分析</a></li><li><a href="/blog/Python/zhihu/DataAnalysis.html" class="active sidebar-link">数据分析的基本过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/DataAnalysis.html#numpy的操作" class="sidebar-link">numpy的操作</a></li><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/DataAnalysis.html#pandas" class="sidebar-link">pandas</a></li><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/DataAnalysis.html#案例分析某医院" class="sidebar-link">案例分析某医院</a></li></ul></li><li><a href="/blog/Python/zhihu/MachineLearning.html" class="sidebar-link">机器学习 入门</a></li><li><a href="/blog/Python/zhihu/draw.html" class="sidebar-link">知乎教我python绘图</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="数据分析的基本过程"><a href="#数据分析的基本过程" class="header-anchor">#</a> 数据分析的基本过程</h1> <p></p><div class="table-of-contents"><ul><li><a href="#数据分析的基本过程">数据分析的基本过程</a><ul><li><a href="#numpy的操作">numpy的操作</a><ul><li><a href="#查询元素">查询元素</a></li><li><a href="#切片访问">切片访问</a></li><li><a href="#循环访问">循环访问</a></li><li><a href="#数据类型">数据类型</a></li><li><a href="#numpy一维数组与列表的区别">numpy一维数组与列表的区别</a><ul><li><a href="#统计功能">统计功能</a></li><li><a href="#向量化计算">向量化计算</a></li></ul></li><li><a href="#numpy二维数据">numpy二维数据</a></li><li><a href="#查询元素">查询元素</a></li><li><a href="#获取第一行">获取第一行</a></li><li><a href="#获取第一列">获取第一列</a></li><li><a href="#numpy数轴参数">numpy数轴参数</a></li></ul></li><li><a href="#pandas">pandas</a><ul><li><a href="#一维数据pd-series">一维数据pd.Series()</a></li><li><a href="#获取描述统计信息">获取描述统计信息</a></li><li><a href="#iloc属性用于根据索引获取值">iloc属性用于根据索引获取值</a></li><li><a href="#loc属性用于根据索引获取值">loc属性用于根据索引获取值</a></li><li><a href="#向量化运算：向量相加">向量化运算：向量相加</a></li><li><a href="#删除缺失值">删除缺失值</a></li><li><a href="#将缺失值进行填充">将缺失值进行填充</a></li><li><a href="#pandas二维数据dataframe">pandas二维数据DataFrame</a></li><li><a href="#数据框复杂查询：条件判断">数据框复杂查询：条件判断</a></li><li><a href="#excel">excel</a></li></ul></li><li><a href="#案例分析某医院">案例分析某医院</a><ul><li><a href="#学习链接">学习链接</a></li></ul></li></ul></li></ul></div>
pandas的数据是series，numpy的数据是array，<p></p> <p>pandas的数据，功能比numpy的多
pandas的数据可以不一样，numpy的数据元素是一样的</p> <h2 id="numpy的操作"><a href="#numpy的操作" class="header-anchor">#</a> numpy的操作</h2> <p>一维数组
<strong>a= np.array([2,3,4,5])</strong></p> <h3 id="查询元素"><a href="#查询元素" class="header-anchor">#</a> 查询元素</h3> <p>a[0]</p> <h3 id="切片访问"><a href="#切片访问" class="header-anchor">#</a> 切片访问</h3> <p>a[1:3]</p> <h3 id="循环访问"><a href="#循环访问" class="header-anchor">#</a> 循环访问</h3> <p>for in a:</p> <h3 id="数据类型"><a href="#数据类型" class="header-anchor">#</a> 数据类型</h3> <p>a.dtype  -&gt; dtype('int32')</p> <h3 id="numpy一维数组与列表的区别"><a href="#numpy一维数组与列表的区别" class="header-anchor">#</a> numpy一维数组与列表的区别</h3> <h4 id="统计功能"><a href="#统计功能" class="header-anchor">#</a> 统计功能</h4> <p>平均值mean(),标准差std()</p> <h4 id="向量化计算"><a href="#向量化计算" class="header-anchor">#</a> 向量化计算</h4> <ul><li>向量相加</li> <li>乘以标量</li></ul> <h3 id="numpy二维数据"><a href="#numpy二维数据" class="header-anchor">#</a> numpy二维数据</h3> <div class="language-python extra-class"><pre class="language-python"><code>a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>
	<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>

</code></pre></div><h3 id="查询元素-2"><a href="#查询元素-2" class="header-anchor">#</a> 查询元素</h3> <p>a[行序号,列序号]</p> <h3 id="获取第一行"><a href="#获取第一行" class="header-anchor">#</a> 获取第一行</h3> <p>a[0,:]</p> <h3 id="获取第一列"><a href="#获取第一列" class="header-anchor">#</a> 获取第一列</h3> <p>a[:,0]</p> <h3 id="numpy数轴参数"><a href="#numpy数轴参数" class="header-anchor">#</a> numpy数轴参数</h3> <p>按轴计算：axis=1按行计算，axis=0按列计算</p> <p>a.mean(axis=1) 计算每一行   array([2.5,6.5,10.5])</p> <h2 id="pandas"><a href="#pandas" class="header-anchor">#</a> pandas</h2> <h3 id="一维数据pd-series"><a href="#一维数据pd-series" class="header-anchor">#</a> 一维数据pd.Series()</h3> <div class="language-python extra-class"><pre class="language-python"><code>stockS<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">54.74</span><span class="token punctuation">,</span><span class="token number">190.9</span><span class="token punctuation">,</span><span class="token number">173.14</span><span class="token punctuation">,</span><span class="token number">1050.3</span><span class="token punctuation">,</span><span class="token number">181.86</span><span class="token punctuation">,</span><span class="token number">1139.49</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'腾讯'</span><span class="token punctuation">,</span>
                       <span class="token string">'阿里巴巴'</span><span class="token punctuation">,</span>
                       <span class="token string">'苹果'</span><span class="token punctuation">,</span>
                       <span class="token string">'谷歌'</span><span class="token punctuation">,</span>
                       <span class="token string">'Facebook'</span><span class="token punctuation">,</span>
                       <span class="token string">'亚马逊'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="获取描述统计信息"><a href="#获取描述统计信息" class="header-anchor">#</a> 获取描述统计信息</h3> <p>stockS.describe()</p> <h3 id="iloc属性用于根据索引获取值"><a href="#iloc属性用于根据索引获取值" class="header-anchor">#</a> iloc属性用于根据索引获取值</h3> <h3 id="loc属性用于根据索引获取值"><a href="#loc属性用于根据索引获取值" class="header-anchor">#</a> loc属性用于根据索引获取值</h3> <h3 id="向量化运算：向量相加"><a href="#向量化运算：向量相加" class="header-anchor">#</a> 向量化运算：向量相加</h3> <div class="language-python extra-class"><pre class="language-python"><code>s1<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s2<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s3<span class="token operator">=</span>s1<span class="token operator">+</span>s2
</code></pre></div><h3 id="删除缺失值"><a href="#删除缺失值" class="header-anchor">#</a> 删除缺失值</h3> <p>s3.dropna()</p> <h3 id="将缺失值进行填充"><a href="#将缺失值进行填充" class="header-anchor">#</a> 将缺失值进行填充</h3> <p>s3=s1.add(s2,fill_value=0)</p> <h3 id="pandas二维数据dataframe"><a href="#pandas二维数据dataframe" class="header-anchor">#</a> pandas二维数据DataFrame</h3> <p>数据框（DataFrame）
<strong>行（columns）</strong> <strong>列（index）</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#导入包</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token triple-quoted-string string">'''
Pandas二维数组：数据框（DataFrame） 
'''</span>
<span class="token comment">#第1步：定义一个字典，映射列名与对应列的值</span>
salesDict<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token string">'购药时间'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'2018-01-01 星期五'</span><span class="token punctuation">,</span><span class="token string">'2018-01-02 星期六'</span><span class="token punctuation">,</span><span class="token string">'2018-01-06 星期三'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'社保卡号'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'001616528'</span><span class="token punctuation">,</span><span class="token string">'001616528'</span><span class="token punctuation">,</span><span class="token string">'0012602828'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'商品编码'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">236701</span><span class="token punctuation">,</span><span class="token number">236701</span><span class="token punctuation">,</span><span class="token number">236701</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'商品名称'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'强力VC银翘片'</span><span class="token punctuation">,</span><span class="token string">'清热解毒口服液'</span><span class="token punctuation">,</span><span class="token string">'感康'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'销售数量'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'应收金额'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">82.8</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">16.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'实收金额'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">24.64</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">#导入有序字典</span>
<span class="token keyword">from</span> collections <span class="token keyword">import</span> OrderedDict
<span class="token comment">#定义一个有序字典</span>
salesOrderDict<span class="token operator">=</span>OrderedDict<span class="token punctuation">(</span>salesDict<span class="token punctuation">)</span>

<span class="token comment">#定义数据框：传入字典，列名</span>
salesDf<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>salesOrderDict<span class="token punctuation">)</span>


<span class="token operator">|</span>购药时间			<span class="token operator">|</span>社保卡号	<span class="token operator">|</span>商品编码	<span class="token operator">|</span>商品名称		<span class="token operator">|</span>销售数量	<span class="token operator">|</span>应收金额	<span class="token operator">|</span>实收金额<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">0</span>			<span class="token operator">|</span><span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> 星期五	<span class="token operator">|</span><span class="token number">001616528</span>	<span class="token operator">|</span><span class="token number">236701</span>		<span class="token operator">|</span>强力VC银翘片	<span class="token operator">|</span><span class="token number">6</span>			<span class="token operator">|</span><span class="token number">82.8</span>		<span class="token operator">|</span><span class="token number">69.00</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">1</span>			<span class="token operator">|</span><span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span> 星期六	<span class="token operator">|</span><span class="token number">001616528</span>	<span class="token operator">|</span><span class="token number">236701</span>		<span class="token operator">|</span>清热解毒口服液	<span class="token operator">|</span><span class="token number">1</span>			<span class="token operator">|</span><span class="token number">28.0</span>		<span class="token operator">|</span><span class="token number">24.64</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">2</span>			<span class="token operator">|</span><span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">06</span> 星期三	<span class="token operator">|</span><span class="token number">0012602828</span>	<span class="token operator">|</span><span class="token number">236701</span>		<span class="token operator">|</span>感康			<span class="token operator">|</span><span class="token number">2</span>			<span class="token operator">|</span><span class="token number">16.8</span>		<span class="token operator">|</span><span class="token number">15.00</span>	<span class="token operator">|</span>

<span class="token comment">#平均值：是按每列来求平均值</span>
salesDf<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

商品编码    <span class="token number">236701.000000</span>
销售数量         <span class="token number">3.000000</span>
应收金额        <span class="token number">42.533333</span>
实收金额        <span class="token number">36.213333</span>
dtype<span class="token punctuation">:</span> float64


<span class="token triple-quoted-string string">'''
iloc属性用于根据位置获取值
'''</span>
<span class="token comment">#查询第1行第2列的元素</span>
salesDf<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>


获取第<span class="token number">1</span>行，<span class="token punctuation">:</span>代表所有列
salesDf<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

商品名称           强力VC银翘片
商品编码            <span class="token number">236701</span>
实收金额                <span class="token number">69</span>
应收金额              <span class="token number">82.8</span>
社保卡号         <span class="token number">001616528</span>
购药时间    <span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> 星期五
销售数量                 <span class="token number">6</span>
Name<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>

<span class="token comment">#获取第1列，:代表所有行</span>
salesDf<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>


<span class="token triple-quoted-string string">'''
loc属性用于根据索引获取值
'''</span>
<span class="token comment">#查询第1行第1列的元素</span>
salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'商品编码'</span><span class="token punctuation">]</span>



<span class="token comment">#获取第1行</span>
salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

商品名称           强力VC银翘片
商品编码            <span class="token number">236701</span>
实收金额                <span class="token number">69</span>
应收金额              <span class="token number">82.8</span>
社保卡号         <span class="token number">001616528</span>
购药时间    <span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> 星期五
销售数量                 <span class="token number">6</span>
Name<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>



<span class="token comment">#获取“商品名称”这一列</span>
<span class="token comment">#salesDf.loc[:,'商品名称']</span>
<span class="token comment">#简单方法：获取“商品名称”这一列</span>
salesDf<span class="token punctuation">[</span><span class="token string">'商品名称'</span><span class="token punctuation">]</span>

<span class="token number">0</span>    强力VC银翘片
<span class="token number">1</span>    清热解毒口服液
<span class="token number">2</span>         感康
Name<span class="token punctuation">:</span> 商品名称<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>



<span class="token comment">#通过列表来选择某几列的数据</span>
salesDf<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'商品名称'</span><span class="token punctuation">,</span><span class="token string">'销售数量'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token operator">|</span>	<span class="token operator">|</span>
<span class="token operator">|</span>商品名称		<span class="token operator">|</span>销售数量<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">0</span>			<span class="token operator">|</span>强力VC银翘片	<span class="token operator">|</span><span class="token number">6</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">1</span>			<span class="token operator">|</span>清热解毒口服液	<span class="token operator">|</span><span class="token number">1</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">2</span>			<span class="token operator">|</span>感康			<span class="token operator">|</span><span class="token number">2</span>	<span class="token operator">|</span>



<span class="token comment">#通过切片功能，获取指定范围的列</span>
salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'购药时间'</span><span class="token punctuation">:</span><span class="token string">'销售数量'</span><span class="token punctuation">]</span>

<span class="token operator">|</span>购药时间			<span class="token operator">|</span>社保卡号	<span class="token operator">|</span>商品编码	<span class="token operator">|</span>商品名称		<span class="token operator">|</span>销售数量<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">0</span>			<span class="token operator">|</span><span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> 星期五	<span class="token operator">|</span><span class="token number">001616528</span>	<span class="token operator">|</span><span class="token number">236701</span>		<span class="token operator">|</span>强力VC银翘片	<span class="token operator">|</span><span class="token number">6</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">1</span>			<span class="token operator">|</span><span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span> 星期六	<span class="token operator">|</span><span class="token number">001616528</span>	<span class="token operator">|</span><span class="token number">236701</span>		<span class="token operator">|</span>清热解毒口服液	<span class="token operator">|</span><span class="token number">1</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">2</span>			<span class="token operator">|</span><span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">06</span> 星期三	<span class="token operator">|</span><span class="token number">0012602828</span>	<span class="token operator">|</span><span class="token number">236701</span>		<span class="token operator">|</span>感康			<span class="token operator">|</span><span class="token number">2</span>	<span class="token operator">|</span>
</code></pre></div><h3 id="数据框复杂查询：条件判断"><a href="#数据框复杂查询：条件判断" class="header-anchor">#</a> 数据框复杂查询：条件判断</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#通过条件判断筛选</span>
<span class="token comment">#第1步：构建查询条件</span>
querySer<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'销售数量'</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">1</span>

querySer
<span class="token number">0</span>     <span class="token boolean">True</span>
<span class="token number">1</span>    <span class="token boolean">False</span>
<span class="token number">2</span>     <span class="token boolean">True</span>
Name<span class="token punctuation">:</span> 销售数量<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">bool</span>


salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>querySer<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token operator">|</span>购药时间			<span class="token operator">|</span>社保卡号	<span class="token operator">|</span>商品编码	<span class="token operator">|</span>商品名称		<span class="token operator">|</span>销售数量	<span class="token operator">|</span>应收金额	<span class="token operator">|</span>实收金额<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">0</span>			<span class="token operator">|</span><span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> 星期五	<span class="token operator">|</span><span class="token number">001616528</span>	<span class="token operator">|</span><span class="token number">236701</span>		<span class="token operator">|</span>强力VC银翘片	<span class="token operator">|</span><span class="token number">6</span>			<span class="token operator">|</span><span class="token number">82.8</span>		<span class="token operator">|</span><span class="token number">69.0</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">2</span>			<span class="token operator">|</span><span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">06</span> 星期三	<span class="token operator">|</span><span class="token number">0012602828</span>	<span class="token operator">|</span><span class="token number">236701</span>		<span class="token operator">|</span>感康			<span class="token operator">|</span><span class="token number">2</span>			<span class="token operator">|</span><span class="token number">16.8</span>		<span class="token operator">|</span><span class="token number">15.0</span>	<span class="token operator">|</span>


<span class="token comment">#单条件筛选</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>d <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment">#多条件筛选</span>
df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>d<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>c<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>d <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>c <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment">#升序</span>
lc<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;loan_amnt&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  默认升序

<span class="token comment"># 对多列数据进行排序</span>
lc<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;loan_amnt&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;int_rate&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 获取最大前10项</span>
lc<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;loan_amnt&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

<span class="token comment"># 用.loc对lc数据表中grade列为B值的数据条目进行了筛选操作</span>
lc<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>lc<span class="token punctuation">[</span><span class="token string">&quot;grade&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># 获取前五行</span>

<span class="token comment"># 在前面筛选代码的基础上增加要显示的列名称和显示顺序</span>
lc<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>lc<span class="token punctuation">[</span><span class="token string">&quot;grade&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;member_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;loan_amnt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;grade&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 对筛选结果进行排序可以联合使用.loc函数和.sort函数</span>
lc<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>lc<span class="token punctuation">[</span><span class="token string">&quot;grade&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;member_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;loan_amnt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;grade&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;loan_amnt&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token comment"># 多列数据筛选并排序</span>
lc<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>lc<span class="token punctuation">[</span><span class="token string">&quot;grade&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>lc<span class="token punctuation">[</span><span class="token string">&quot;loan_amnt&quot;</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;member_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;term&quot;</span> <span class="token punctuation">,</span> <span class="token string">&quot;loan_amnt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;grade&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;sub_grade&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;int_rate&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="excel"><a href="#excel" class="header-anchor">#</a> excel</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#读取Ecxcel数据</span>
fileNameStr<span class="token operator">=</span><span class="token string">'./朝阳医院2018年销售数据.xlsx'</span>
xls <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelFile<span class="token punctuation">(</span>fileNameStr<span class="token punctuation">)</span>
salesDf <span class="token operator">=</span> xls<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">'Sheet1'</span><span class="token punctuation">)</span>

<span class="token comment">#打印出前3行，以确保数据运行正常</span>
salesDf<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

购药时间	社保卡号	商品编码	商品名称	销售数量	应收金额	实收金额
<span class="token number">0</span>	<span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> 星期五	<span class="token number">1616528.0</span>	<span class="token number">236701.0</span>	强力VC银翘片	<span class="token number">6.0</span>	<span class="token number">82.8</span>	<span class="token number">69.00</span>
<span class="token number">1</span>	<span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span> 星期六	<span class="token number">1616528.0</span>	<span class="token number">236701.0</span>	清热解毒口服液	<span class="token number">1.0</span>	<span class="token number">28.0</span>	<span class="token number">24.64</span>
<span class="token number">2</span>	<span class="token number">2018</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">06</span> 星期三	<span class="token number">12602828.0</span>	<span class="token number">236701.0</span>	感康	<span class="token number">2.0</span>	<span class="token number">16.8</span>	<span class="token number">15.00</span>


<span class="token comment">#有多少行，多少列</span>
salesDf<span class="token punctuation">.</span>shape
<span class="token punctuation">(</span><span class="token number">6578</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>


<span class="token comment">#查看某一列的数据类型</span>
salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'销售数量'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dtype
dtype<span class="token punctuation">(</span><span class="token string">'float64'</span><span class="token punctuation">)</span>


<span class="token comment">#查看每一列的统计数值</span>
salesDf<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">|</span>社保卡号		<span class="token operator">|</span>商品编码		<span class="token operator">|</span>销售数量	<span class="token operator">|</span>应收金额	<span class="token operator">|</span>实收金额	<span class="token operator">|</span>
<span class="token operator">|</span>count		<span class="token operator">|</span><span class="token number">6.576000e+03</span>	<span class="token operator">|</span><span class="token number">6.577000e+03</span>	<span class="token operator">|</span><span class="token number">6577.000000</span><span class="token operator">|</span><span class="token number">6577.000000</span><span class="token operator">|</span><span class="token number">6577.000000</span><span class="token operator">|</span>
<span class="token operator">|</span>mean		<span class="token operator">|</span><span class="token number">6.091254e+09</span>	<span class="token operator">|</span><span class="token number">1.015869e+06</span>	<span class="token operator">|</span><span class="token number">2.386194</span>	<span class="token operator">|</span><span class="token number">50.473803</span>	<span class="token operator">|</span><span class="token number">46.317510</span>	<span class="token operator">|</span>
<span class="token operator">|</span>std		<span class="token operator">|</span><span class="token number">4.889284e+09</span>	<span class="token operator">|</span><span class="token number">5.131153e+05</span>	<span class="token operator">|</span><span class="token number">2.375202</span>	<span class="token operator">|</span><span class="token number">87.595925</span>	<span class="token operator">|</span><span class="token number">80.976702</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token builtin">min</span>		<span class="token operator">|</span><span class="token number">1.616528e+06</span>	<span class="token operator">|</span><span class="token number">2.367010e+05</span>	<span class="token operator">|</span><span class="token operator">-</span><span class="token number">10.000000</span>	<span class="token operator">|</span><span class="token operator">-</span><span class="token number">374.000000</span><span class="token operator">|</span><span class="token operator">-</span><span class="token number">374.000000</span><span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">25</span><span class="token operator">%</span>		<span class="token operator">|</span><span class="token number">1.014234e+08</span>	<span class="token operator">|</span><span class="token number">8.614560e+05</span>	<span class="token operator">|</span><span class="token number">1.000000</span>	<span class="token operator">|</span><span class="token number">14.000000</span>	<span class="token operator">|</span><span class="token number">12.320000</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">50</span><span class="token operator">%</span>		<span class="token operator">|</span><span class="token number">1.001650e+10</span>	<span class="token operator">|</span><span class="token number">8.615070e+05</span>	<span class="token operator">|</span><span class="token number">2.000000</span>	<span class="token operator">|</span><span class="token number">28.000000</span>	<span class="token operator">|</span><span class="token number">26.600000</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token number">75</span><span class="token operator">%</span>		<span class="token operator">|</span><span class="token number">1.004882e+10</span>	<span class="token operator">|</span><span class="token number">8.690690e+05</span>	<span class="token operator">|</span><span class="token number">2.000000</span>	<span class="token operator">|</span><span class="token number">59.600000</span>	<span class="token operator">|</span><span class="token number">53.000000</span>	<span class="token operator">|</span>
<span class="token operator">|</span><span class="token builtin">max</span>		<span class="token operator">|</span><span class="token number">1.283612e+10</span>	<span class="token operator">|</span><span class="token number">2.367012e+06</span>	<span class="token operator">|</span><span class="token number">50.000000</span>	<span class="token operator">|</span><span class="token number">2950.000000</span><span class="token operator">|</span><span class="token number">2650.000000</span><span class="token operator">|</span>


salesDf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="案例分析某医院"><a href="#案例分析某医院" class="header-anchor">#</a> 案例分析某医院</h2> <p>从销售数据Excel中分析出以下业务指标： 1）月均消费次数2）月均消费金额3）客单价4）消费趋势</p> <ul><li>pd.read_excel(fileNameStr,sheet_name='Sheet1',dtype=str) 读取文件</li> <li>salesDf.shape 有多少行，多少列</li></ul> <p>数据清洗</p> <ul><li><p>选择子集（有时候不需要那么多列）</p></li> <li><p>列名重命名  salesDf.rename(columns = {'购药时间':'销售时间'},inplace=True)</p></li> <li><p>缺失数据处理  salesDf.dropna(subset=['销售时间','社保卡号'],how='any')</p></li> <li><p>数据类型转换  （read_excel的时候，dtype=str）</p></li> <li><p>模型</p></li> <li><p>绘图</p></li></ul> <div class="language-python extra-class"><pre class="language-python"><code>
<span class="token comment">#导入数据分析包</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token triple-quoted-string string">'''
路径中最好不要有中文，或者特殊符号啥的，不然路径会提示错误找不到。
最好将文件放到一个简单的英文路径下
'''</span>
<span class="token comment">#excel文件路径，路径中的./表示在当前notebook所在的文件夹路径</span>
fileNameStr<span class="token operator">=</span><span class="token string">'./朝阳医院2018年销售数据.xlsx'</span>
<span class="token triple-quoted-string string">'''
使用pandas的read_excel函数读取Ecxcel数据
参数sheet_name：数据在Excel里的哪个sheet下面，这块就写该sheet在excel里的名称
参数dtype=str 统一先按照字符串读入，之后再转换
pandas的read_excel函数官网地址：https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html#pandas.read_excel
'''</span>
salesDf <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>fileNameStr<span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">'Sheet1'</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">)</span>


<span class="token comment">#有多少行，多少列</span>
<span class="token comment"># salesDf.shape</span>
<span class="token comment"># print(salesDf.shape)</span>
<span class="token comment"># (6578, 7)</span>

<span class="token comment"># 选择子集(本案例不需要选择子集)</span>
<span class="token comment">#subSalesDf=salesDf.loc[0:4,'购药时间':'销售数量']</span>


<span class="token comment"># 列名重命名</span>
<span class="token comment">#字典：旧列名和新列名对应关系</span>
colNameDict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'购药时间'</span><span class="token punctuation">:</span><span class="token string">'销售时间'</span><span class="token punctuation">}</span>
<span class="token triple-quoted-string string">'''
inplace=False，数据框本身不会变，而会创建一个改动后新的数据框，
默认的inplace是False
inplace=True，数据框本身会改动
'''</span>
salesDf<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns <span class="token operator">=</span> colNameDict<span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>



<span class="token comment">#删除列（销售时间，社保卡号）中为空的行</span>
<span class="token comment">#how='any' 在给定的任何一列中有缺失值就删除</span>
<span class="token comment"># dropna函数详细使用地址：https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.dropna.html</span>
salesDf<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'销售时间'</span><span class="token punctuation">,</span><span class="token string">'社保卡号'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'any'</span><span class="token punctuation">)</span>

<span class="token comment">#删除缺失值，使得索引序号不连续，这里用reset_index重置索引</span>
salesDf<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


<span class="token comment"># 数据类型转换</span>

<span class="token comment"># 字符串转换为数值（浮点型）</span>
<span class="token comment">#字符串转换为数值（浮点型）</span>
salesDf<span class="token punctuation">[</span><span class="token string">'销售数量'</span><span class="token punctuation">]</span> <span class="token operator">=</span> salesDf<span class="token punctuation">[</span><span class="token string">'销售数量'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float'</span><span class="token punctuation">)</span>
salesDf<span class="token punctuation">[</span><span class="token string">'应收金额'</span><span class="token punctuation">]</span> <span class="token operator">=</span> salesDf<span class="token punctuation">[</span><span class="token string">'应收金额'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float'</span><span class="token punctuation">)</span>
salesDf<span class="token punctuation">[</span><span class="token string">'实收金额'</span><span class="token punctuation">]</span> <span class="token operator">=</span> salesDf<span class="token punctuation">[</span><span class="token string">'实收金额'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float'</span><span class="token punctuation">)</span>
<span class="token comment"># print('转换后的数据类型：\n',salesDf.dtypes)</span>
<span class="token triple-quoted-string string">'''
运行后，会报警告SettingWithCopyWarning
一般信息有两列，一类是Warning警告信息，一类是Error错误信息。
警告的信息不用管，我们只关注错误类型的信息
'''</span>

<span class="token comment"># 字符串转换为日期数据类型</span>
<span class="token triple-quoted-string string">'''
定义函数：分割销售日期，获取销售日期
输入：timeColSer 销售时间这一列，是个Series数据类型
输出：分割后的时间，返回也是个Series数据类型
'''</span>
<span class="token keyword">def</span> <span class="token function">splitSaletime</span><span class="token punctuation">(</span>timeColSer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    timeList<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> value <span class="token keyword">in</span> timeColSer<span class="token punctuation">:</span>
        <span class="token comment">#例如2018-01-01 星期五，分割后为：2018-01-01</span>
        dateStr<span class="token operator">=</span>value<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        timeList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dateStr<span class="token punctuation">)</span>
    
    <span class="token comment">#将列表转行为一维数据Series类型</span>
    timeSer<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>timeList<span class="token punctuation">)</span>
    <span class="token keyword">return</span> timeSer


<span class="token comment">#获取“销售时间”这一列</span>
timeSer<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'销售时间'</span><span class="token punctuation">]</span>
<span class="token comment">#对字符串进行分割，获取销售日期</span>
dateSer<span class="token operator">=</span>splitSaletime<span class="token punctuation">(</span>timeSer<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
注意：
如果运行后报错：AttributeError: 'float' object has no attribute 'split'
是因为Excel中的空的cell读入pandas中是空值（NaN），这个NaN是个浮点类型，一般当作空值处理。
所以要先去除NaN在进行分隔字符串
'''</span>
<span class="token comment">#修改销售时间这一列的值</span>
salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'销售时间'</span><span class="token punctuation">]</span><span class="token operator">=</span>dateSer
<span class="token comment"># print(salesDf)</span>

<span class="token triple-quoted-string string">'''
数据类型转换:字符串转换为日期
'''</span>
<span class="token comment">#errors='coerce' 如果原始数据不符合日期的格式，转换后的值为空值NaT</span>
<span class="token comment">#format 是你原始数据中日期的格式</span>
salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'销售时间'</span><span class="token punctuation">]</span><span class="token operator">=</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'销售时间'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\
                                    <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">,</span>\
                                    errors<span class="token operator">=</span><span class="token string">'coerce'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
转换日期过程中不符合日期格式的数值会被转换为空值，
这里删除列（销售时间，社保卡号）中为空的行
'''</span>
salesDf<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'销售时间'</span><span class="token punctuation">,</span><span class="token string">'社保卡号'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'any'</span><span class="token punctuation">)</span>


<span class="token comment"># 数据排序</span>
<span class="token triple-quoted-string string">'''
by：按哪几列排序
ascending=True 表示升序排列，
ascending=False表示降序排列
na_position=True表示排序的时候，把空值放到前列，这样可以比较清晰的看到哪些地方有空值
官网文档：https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.sort_values.html
'''</span>
<span class="token comment">#按销售日期进行升序排列</span>
salesDf<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'销售时间'</span><span class="token punctuation">,</span>\
                    ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>\
                    na_position<span class="token operator">=</span><span class="token string">'first'</span><span class="token punctuation">)</span>

<span class="token comment">#重命名行名（index）：排序后的列索引值是之前的行号，需要修改成从0到N按顺序的索引值</span>
salesDf<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


<span class="token comment"># 异常值处理</span>
<span class="token comment">#描述指标：查看出“销售数量”值不能小于0</span>
salesDf<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 	销售数量	应收金额	实收金额</span>
<span class="token comment"># count	6549.000000	6549.000000	6549.000000</span>
<span class="token comment"># mean	2.384486	50.449076	46.284370</span>
<span class="token comment"># std	2.375227	87.696401	81.058426</span>
<span class="token comment"># min	-10.000000	-374.000000	-374.000000</span>
<span class="token comment"># 25%	1.000000	14.000000	12.320000</span>
<span class="token comment"># 50%	2.000000	28.000000	26.500000</span>
<span class="token comment"># 75%	2.000000	59.600000	53.000000</span>
<span class="token comment"># max	50.000000	2950.000000	2650.000000</span>


<span class="token comment">#删除异常值：通过条件判断筛选出数据</span>
<span class="token comment">#查询条件</span>
querySer<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'销售数量'</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span>
<span class="token comment">#应用查询条件</span>
<span class="token comment"># print('删除异常值前：',salesDf.shape)</span>
salesDf<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>querySer<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token comment"># print('删除异常值后：',salesDf.shape)</span>


<span class="token comment"># 构建模型</span>
<span class="token comment"># 业务指标1:月均消费次数=总消费次数 / 月份数</span>
<span class="token triple-quoted-string string">'''
总消费次数：同一天内，同一个人发生的所有消费算作一次消费
#根据列名（销售时间，社区卡号），如果这两个列值同时相同，只保留1条，将重复的数据删除
'''</span>

kpi1_Df<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>
    subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'销售时间'</span><span class="token punctuation">,</span> <span class="token string">'社保卡号'</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>

<span class="token comment">#总消费次数：有多少行</span>
totalI<span class="token operator">=</span>kpi1_Df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token comment"># print('总消费次数=',totalI)</span>


<span class="token triple-quoted-string string">'''
计算月份数：时间范围
'''</span>
<span class="token comment">#第1步：按销售时间升序排序</span>
kpi1_Df<span class="token operator">=</span>kpi1_Df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'销售时间'</span><span class="token punctuation">,</span>\
                    ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment">#重命名行名（index）</span>
kpi1_Df<span class="token operator">=</span>kpi1_Df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


<span class="token comment">#第2步：获取时间范围</span>
<span class="token comment">#最小时间值</span>
startTime<span class="token operator">=</span>kpi1_Df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'销售时间'</span><span class="token punctuation">]</span>
<span class="token comment">#最大时间值</span>
endTime<span class="token operator">=</span>kpi1_Df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>totalI<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'销售时间'</span><span class="token punctuation">]</span>

<span class="token comment">#第3步：计算月份数</span>
<span class="token comment">#天数</span>
daysI<span class="token operator">=</span><span class="token punctuation">(</span>endTime<span class="token operator">-</span>startTime<span class="token punctuation">)</span><span class="token punctuation">.</span>days
<span class="token comment">#月份数: 运算符“//”表示取整除 </span>
<span class="token comment">#返回商的整数部分，例如9//2 输出结果是4</span>
monthsI<span class="token operator">=</span>daysI<span class="token operator">//</span><span class="token number">30</span>
<span class="token comment"># print('月份数：',monthsI)</span>

<span class="token comment">#业务指标1：月均消费次数=总消费次数 / 月份数</span>
kpi1_I<span class="token operator">=</span>totalI <span class="token operator">//</span> monthsI
<span class="token comment"># print('业务指标1：月均消费次数=',kpi1_I)</span>

<span class="token comment">#总消费金额</span>
totalMoneyF<span class="token operator">=</span>salesDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'实收金额'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#月均消费金额</span>
monthMoneyF<span class="token operator">=</span>totalMoneyF <span class="token operator">/</span> monthsI
<span class="token comment"># print('业务指标2：月均消费金额=',monthMoneyF)</span>




<span class="token comment"># 指标4：消费趋势，画图：折线图</span>
<span class="token comment">#在进行操作之前，先把数据复制到另一个数据框中，防止对之前清洗后的数据框造成影响</span>
groupDf<span class="token operator">=</span>salesDf
<span class="token comment">#第1步：重命名行名（index）为销售时间所在列的值</span>
groupDf<span class="token punctuation">.</span>index<span class="token operator">=</span>groupDf<span class="token punctuation">[</span><span class="token string">'销售时间'</span><span class="token punctuation">]</span>

<span class="token comment"># print(groupDf.index.month)</span>

<span class="token comment">#第2步：分组</span>
gb<span class="token operator">=</span>groupDf<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>groupDf<span class="token punctuation">.</span>index<span class="token punctuation">.</span>month<span class="token punctuation">)</span>

<span class="token comment">#第3步：应用函数，计算每个月的消费总额</span>
mounthDf<span class="token operator">=</span>gb<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>mounthDf<span class="token punctuation">)</span>

</code></pre></div><h4 id="学习链接"><a href="#学习链接" class="header-anchor">#</a> 学习链接</h4> <p><a href="https://zhuanlan.zhihu.com/p/100064394" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/Python/zhihu/introductionDataAnalysis.html" class="prev">
        描述统计分析
      </a></span> <span class="next"><a href="/blog/Python/zhihu/MachineLearning.html">
        机器学习 入门
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.750f600d.js" defer></script><script src="/blog/assets/js/2.be40518a.js" defer></script><script src="/blog/assets/js/45.9a380f1d.js" defer></script>
  </body>
</html>
