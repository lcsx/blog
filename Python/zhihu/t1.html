<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>案例 | 欢迎回来 ！</title>
    <meta name="description" content="lcsx">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/blog/assets/css/0.styles.ee874cfe.css" as="style"><link rel="preload" href="/blog/assets/js/app.09e88087.js" as="script"><link rel="preload" href="/blog/assets/js/2.5d6d69d5.js" as="script"><link rel="preload" href="/blog/assets/js/20.ff3ffefa.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.9545c010.js"><link rel="prefetch" href="/blog/assets/js/11.c121cceb.js"><link rel="prefetch" href="/blog/assets/js/12.d8c9c1bd.js"><link rel="prefetch" href="/blog/assets/js/13.858fecce.js"><link rel="prefetch" href="/blog/assets/js/14.10c2aaa2.js"><link rel="prefetch" href="/blog/assets/js/15.1a4adff1.js"><link rel="prefetch" href="/blog/assets/js/16.69d675fe.js"><link rel="prefetch" href="/blog/assets/js/17.ea7dd094.js"><link rel="prefetch" href="/blog/assets/js/18.053f4e8c.js"><link rel="prefetch" href="/blog/assets/js/19.f6d1f87f.js"><link rel="prefetch" href="/blog/assets/js/21.6efdf0ff.js"><link rel="prefetch" href="/blog/assets/js/22.324e8463.js"><link rel="prefetch" href="/blog/assets/js/23.2e0c31c4.js"><link rel="prefetch" href="/blog/assets/js/24.5a3dca30.js"><link rel="prefetch" href="/blog/assets/js/25.3b2d9b9f.js"><link rel="prefetch" href="/blog/assets/js/26.c34a5d16.js"><link rel="prefetch" href="/blog/assets/js/27.b6134063.js"><link rel="prefetch" href="/blog/assets/js/28.bf3c2608.js"><link rel="prefetch" href="/blog/assets/js/29.d3af9c62.js"><link rel="prefetch" href="/blog/assets/js/3.39e077d4.js"><link rel="prefetch" href="/blog/assets/js/30.bb079fbc.js"><link rel="prefetch" href="/blog/assets/js/31.e2041594.js"><link rel="prefetch" href="/blog/assets/js/32.5ee57ad4.js"><link rel="prefetch" href="/blog/assets/js/33.79f9ff37.js"><link rel="prefetch" href="/blog/assets/js/34.bd04b9df.js"><link rel="prefetch" href="/blog/assets/js/35.71548143.js"><link rel="prefetch" href="/blog/assets/js/36.0a93475f.js"><link rel="prefetch" href="/blog/assets/js/37.91bdc250.js"><link rel="prefetch" href="/blog/assets/js/38.90858741.js"><link rel="prefetch" href="/blog/assets/js/39.8f381891.js"><link rel="prefetch" href="/blog/assets/js/4.aecd194a.js"><link rel="prefetch" href="/blog/assets/js/40.cf59ef77.js"><link rel="prefetch" href="/blog/assets/js/41.b9a6ffe3.js"><link rel="prefetch" href="/blog/assets/js/42.1f224073.js"><link rel="prefetch" href="/blog/assets/js/43.5b480eab.js"><link rel="prefetch" href="/blog/assets/js/44.696ba103.js"><link rel="prefetch" href="/blog/assets/js/45.a7f44d79.js"><link rel="prefetch" href="/blog/assets/js/46.4e85fe28.js"><link rel="prefetch" href="/blog/assets/js/47.8a9aa7da.js"><link rel="prefetch" href="/blog/assets/js/48.04324fe0.js"><link rel="prefetch" href="/blog/assets/js/49.0f839c66.js"><link rel="prefetch" href="/blog/assets/js/5.6106f207.js"><link rel="prefetch" href="/blog/assets/js/50.11bfcbd5.js"><link rel="prefetch" href="/blog/assets/js/51.82d8487d.js"><link rel="prefetch" href="/blog/assets/js/52.e904bad2.js"><link rel="prefetch" href="/blog/assets/js/53.3f00d869.js"><link rel="prefetch" href="/blog/assets/js/54.70d26d6c.js"><link rel="prefetch" href="/blog/assets/js/55.2f933ad0.js"><link rel="prefetch" href="/blog/assets/js/56.85972735.js"><link rel="prefetch" href="/blog/assets/js/57.b214059e.js"><link rel="prefetch" href="/blog/assets/js/58.a51c7fbb.js"><link rel="prefetch" href="/blog/assets/js/59.6ed363ea.js"><link rel="prefetch" href="/blog/assets/js/6.69c66181.js"><link rel="prefetch" href="/blog/assets/js/60.8c8e72a1.js"><link rel="prefetch" href="/blog/assets/js/61.cd10cc0a.js"><link rel="prefetch" href="/blog/assets/js/62.b3bff3dc.js"><link rel="prefetch" href="/blog/assets/js/63.93753e25.js"><link rel="prefetch" href="/blog/assets/js/64.0c3cfd75.js"><link rel="prefetch" href="/blog/assets/js/65.d53b9bb8.js"><link rel="prefetch" href="/blog/assets/js/66.d46b2746.js"><link rel="prefetch" href="/blog/assets/js/67.285c4dd3.js"><link rel="prefetch" href="/blog/assets/js/7.dcdaa74b.js"><link rel="prefetch" href="/blog/assets/js/8.516b6e0b.js"><link rel="prefetch" href="/blog/assets/js/9.1b87dd6a.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.ee874cfe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="https://vuejs.org/images/logo.png" alt="欢迎回来 ！" class="logo"> <span class="site-name can-hide">欢迎回来 ！</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mysql/mysql_study/" class="nav-link">
  MySQL基础
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mysql/mysql_study/" class="nav-link">
  MySQL基础
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/Python/zhihu/basis.html" class="sidebar-link">基础不牢 地动山摇</a></li><li><a href="/blog/Python/zhihu/confidenceInterval.html" class="sidebar-link">置信区间</a></li><li><a href="/blog/Python/zhihu/HypothesisTesting.html" class="sidebar-link">假设检验</a></li><li><a href="/blog/Python/zhihu/t1.html" class="active sidebar-link">案例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/t1.html#单样本检验" class="sidebar-link">单样本检验</a></li><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/t1.html#置信区间" class="sidebar-link">置信区间</a></li><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/t1.html#效应量" class="sidebar-link">效应量</a></li><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/t1.html#标准误差的计算" class="sidebar-link">标准误差的计算</a></li><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/t1.html#数据分析报告怎么写" class="sidebar-link">数据分析报告怎么写</a></li><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/t1.html#单样本t检验-效应量的计算" class="sidebar-link">单样本T检验 效应量的计算</a></li><li class="sidebar-sub-header"><a href="/blog/Python/zhihu/t1.html#code" class="sidebar-link">code</a></li></ul></li><li><a href="/blog/Python/zhihu/t3.html" class="sidebar-link">相关配对t检验</a></li><li><a href="/blog/Python/zhihu/t2.html" class="sidebar-link">独立双样本t检验</a></li><li><a href="/blog/Python/zhihu/correlationAnalysis.html" class="sidebar-link">相关分析+Excel分析&amp;绘图</a></li><li><a href="/blog/Python/zhihu/introductionDataAnalysis.html" class="sidebar-link">描述统计分析</a></li><li><a href="/blog/Python/zhihu/DataAnalysis.html" class="sidebar-link">数据分析的基本过程</a></li><li><a href="/blog/Python/zhihu/MachineLearning.html" class="sidebar-link">机器学习 入门</a></li><li><a href="/blog/Python/zhihu/draw.html" class="sidebar-link">知乎教我python绘图</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h1> <p></p><div class="table-of-contents"><ul><li><a href="#案例">案例</a><ul><li><a href="#单样本检验">单样本检验</a></li><li><a href="#置信区间">置信区间</a></li><li><a href="#效应量">效应量</a></li><li><a href="#标准误差的计算">标准误差的计算</a><ul><li><a href="#手动计算">手动计算</a></li><li><a href="#scipy计算">scipy计算</a></li></ul></li><li><a href="#数据分析报告怎么写">数据分析报告怎么写</a></li><li><a href="#单样本t检验-效应量的计算">单样本T检验 效应量的计算</a></li><li><a href="#code">code</a></li></ul></li></ul></div><p></p> <h2 id="单样本检验"><a href="#单样本检验" class="header-anchor">#</a> 单样本检验</h2> <p>“超级引擎”是一家专门生产汽车引擎的公司，根据政府发布的新排放要求，引擎排放平均值要低于20ppm</p> <p>公司制造出10台引擎供测试使用，每一台的排放水平如下：</p> <p>15.6 16.2 22.5 20.5 16.4 19.4 16.6 17.9 12.7 13.9</p> <p>怎么知道，公司生产的引擎是否符合政府规定呢？</p> <h2 id="置信区间"><a href="#置信区间" class="header-anchor">#</a> 置信区间</h2> <div class="custom-block tip"><p class="custom-block-title">得到了t值，如何确定置信区间呢？</p> <p>1）置信水平对应的t值（t_ci）
查t表格可以得到，95%的置信水平，自由度是n-1对应的t值</p> <p>2）计算上下限</p> <p>置信区间上限a = 样本平均值 - t_ci ×标准误差</p> <p>置信区间下限b = 样本平均值 - t_ci ×标准误差</p> <p>查找t表格获取95%的置信水平，自由度是n-1对应的t值
注意：课程中这里对应的下面t_ci值有误，以下面的值为准</p></div> <p><img src="/blog/assets/img/jsjy5.3eaf0dca.png" alt=""></p> <p><strong>注意：计算置信区间公式中的t值要和前面假设中的t值区别开，这快容易混淆</strong></p> <div class="custom-block tip"><p class="custom-block-title">【备注说明】前面第2步和第5步里面两个t值是不一样的</p> <p>1）在第2步，证据是什么</p> <p>计算p值里的t值，不是从t表格查出来的，是用公式计算出来的t=（样本平均值-总体平均值）/标准误差，然后用这个计算出的t值再去t表格里去查找出p值</p> <p>2）在第5步，置信区间</p> <p>t_ci是置信水平的t值，是根据置信水平95%从t表格里查找到的t值 。为了和前面的t值区别，所以加了后缀t_ci</p></div> <h2 id="效应量"><a href="#效应量" class="header-anchor">#</a> 效应量</h2> <div class="custom-block tip"><p class="custom-block-title">为什么要给出效应量？</p> <p>在判断某个调查研究的结果，是否有意义或者重要时，要考虑的另一项指标是效应量。效应量太小，意味着处理即使达到了显著水平，也缺乏实用价值。</p> <p>所以，在假设检验中，我们给出了是否具有统计显著性，也要给出效应量，一起来判断研究结果是否有意义。</p> <p>效应量报告格式：d=x.xx ，R2=.xx</p> <p>-1.0：完全负相关</p> <p>-0.7：强负相关</p> <p>-0.5：中等负相关</p> <p>-0.3：弱负相关</p> <p>0.0：不相关</p> <p>0.3：弱正相关</p> <p>0.5：中等正相关</p> <p>0.7：强正相关</p> <p>1.0：完全正相关</p></div> <h2 id="标准误差的计算"><a href="#标准误差的计算" class="header-anchor">#</a> 标准误差的计算</h2> <p><em>单样本T检验的标准误差计算</em></p> <h3 id="手动计算"><a href="#手动计算" class="header-anchor">#</a> 手动计算</h3> <p>样本大小 n = 10</p> <p><strong>标准误差=样本标准差/(n的开方)</strong></p> <p><strong>se =sample_std / (np.sqrt(n))</strong></p> <h3 id="scipy计算"><a href="#scipy计算" class="header-anchor">#</a> scipy计算</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#使用scipy计算标准误差</span>
se<span class="token operator">=</span>stats<span class="token punctuation">.</span>sem<span class="token punctuation">(</span>dataSer<span class="token punctuation">)</span>
</code></pre></div><h2 id="数据分析报告怎么写"><a href="#数据分析报告怎么写" class="header-anchor">#</a> 数据分析报告怎么写</h2> <div class="custom-block tip"><p class="custom-block-title">怎么写数据分析报告</p> <p>1、描述统计分析</p> <p>样本平均值17.17ppm，样本标准差2.98ppm</p> <p>2、推论统计分析</p> <p>1）假设检验</p> <p>独立样本t(9)=-3.00,p=.0074(α=5%)，单尾检验（左尾）</p> <p>公司引擎排放满足标准</p> <p>2）置信区间</p> <p>平均值的置信区间，95% CI=(17.11,17.23)</p> <p>3）效应量</p> <p>d=-0.94</p></div> <h2 id="单样本t检验-效应量的计算"><a href="#单样本t检验-效应量的计算" class="header-anchor">#</a> 单样本T检验 效应量的计算</h2> <p>同相关检验的效应量计算相同</p> <p><strong>Cohen's d = （样本平均值1-样本平均值2) / 标准差</strong>
样本平均值2:这里是与题目有关的，这里是20，政府规定排放标准20</p> <p><img src="/blog/assets/img/jsjy12.d244fd08.jpg" alt=""></p> <h2 id="code"><a href="#code" class="header-anchor">#</a> code</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#导入包</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment">#样本数据集</span>
dataSer<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">15.6</span><span class="token punctuation">,</span><span class="token number">16.2</span><span class="token punctuation">,</span><span class="token number">22.5</span><span class="token punctuation">,</span><span class="token number">20.5</span><span class="token punctuation">,</span><span class="token number">16.4</span><span class="token punctuation">,</span>
                   <span class="token number">19.4</span><span class="token punctuation">,</span><span class="token number">16.6</span><span class="token punctuation">,</span><span class="token number">17.9</span><span class="token punctuation">,</span><span class="token number">12.7</span><span class="token punctuation">,</span><span class="token number">13.9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">#样本平均值</span>
sample_mean<span class="token operator">=</span>dataSer<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
这里要区别：数据集的标准差，和样本标准差
数据集的标准差公式除以的是n，样本标准差公式除以的是n-1。
样本标准差，用途是用样本标准差估计出总体标准差
pandas计算的标准差，默认除以的是n-1，也就是计算出的是样本标准差
pandas标准差官网地址：https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.std.html
'''</span>
<span class="token comment">#样本标准差</span>
sample_std<span class="token operator">=</span>dataSer<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'样本平均值='</span><span class="token punctuation">,</span>sample_mean<span class="token punctuation">,</span><span class="token string">'单位：ppm'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'样本标准差='</span><span class="token punctuation">,</span>sample_std<span class="token punctuation">,</span><span class="token string">'单位：ppm'</span><span class="token punctuation">)</span>

<span class="token comment"># 样本平均值= 17.169999999999998 单位：ppm</span>
<span class="token comment"># 样本标准差= 2.9814426038413018 单位：ppm</span>


<span class="token comment"># 推论统计分析报告中包括：假设检验，置信区间，效应量</span>

<span class="token comment"># 1. 问题是什么？</span>
<span class="token comment"># 零假设和备选假设</span>
<span class="token comment"># 要研究的问题是：这些样本数据是否满足新标准呢？</span>
<span class="token comment"># 根据这个问题我提出来下面两个互为相反的假设。</span>
<span class="token comment"># 零假设H0：公司引擎排放不满足标准，也就是平均值u&gt;=20。这里的20是政府规定新标准的最低可能值。</span>
<span class="token comment"># 零假设总是表述为研究没有改变，没有效果，不起作用等，这里就是不满足标准。</span>
<span class="token comment"># 备选假设H1：公司引擎排放满足标准，也就是平均值u&lt;20</span>



<span class="token comment"># 检验类型</span>
<span class="token comment"># 检验类型有很多种，因为这里只有1个样本，所以选择单样本检验。</span>
<span class="token comment"># 检验类型参考资料：http://support.minitab.com/zh-cn/minitab/17/topic-library/basic-statistics-and-graphs/hypothesis-tests/tests-of-means/types-of-t-tests/</span>

<span class="token comment"># 抽样分布类型</span>
<span class="token comment"># 我们还要判断抽样分布是哪种？因为抽样分布的类型，决定了后面计算p值的不同。</span>

<span class="token comment"># 在我们这个汽车引擎案例中，样本大小是10（小于30），属于小样本。那小样本的抽样分布是否满足t分布呢？</span>
<span class="token comment"># 因为t分布还要求数据集近似正态分布，所以下面图片我们看下样本数据集的分布长什么样。</span>

<span class="token triple-quoted-string string">'''
直方图能够粗略估计数据密度，如果想给数据一个更精确的拟合曲线（专业术语叫：核密度估计kernel density estimate (KDE)），
Seaborn 可以很方便的画出直方图和拟合曲线。
查看数据集分布官网教程地址：https://seaborn.pydata.org/tutorial/distributions.html
'''</span>
<span class="token triple-quoted-string string">'''
需要先在navigator中安装绘图包seaborn，

如果还不知道如何安装包，可以看第1关的教程：https://www.zhihu.com/question/58033789/answer/254673663

'''</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns

<span class="token comment">#查看数据集分布</span>
sns<span class="token punctuation">.</span>distplot<span class="token punctuation">(</span>dataSer<span class="token punctuation">)</span> <span class="token comment">#bins=20</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'数据集分布'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 通过观察上面数据集分布图，数据集近似正态分布，满足t分布的使用条件，所以抽样分布是t分布，自由度df=n-1=10-1=9。</span>
<span class="token comment"># 检验方向</span>
<span class="token comment"># 单尾检验（左尾，右尾），还是双尾检验？</span>
<span class="token comment"># 因为备选假设是公司引擎排放满足标准，也就是平均值u&lt;20</span>
<span class="token comment"># 所以我们使用单尾检验中的左尾检验</span>

<span class="token comment"># 总结</span>
<span class="token comment"># 综合以上分析，本次假设检验是单样本t检验，单尾检验中的左尾。</span>




<span class="token comment"># 2.证据是什么？</span>
<span class="token comment"># 在零假设成立前提下，得到样本平均值的概率p是多少？</span>
<span class="token comment"># 计算p值步骤也很简单：</span>
<span class="token comment"># 1）计算出标准误差</span>
<span class="token comment"># 标准误差=样本标准差除以样本大小n的开方。这里的样本标准差是用来估计总体标准差的</span>
<span class="token comment"># 2）计算t值</span>
<span class="token comment"># t=（样本平均值-总体平均值）/标准误差</span>
<span class="token comment"># 3）根据t值，自由度的计算出概率p值</span>


<span class="token comment"># '''</span>
<span class="token comment"># 方法一：手动计算，熟悉过程</span>
<span class="token comment"># 1）计算标准误差</span>
<span class="token comment"># 标准误差=样本标准差/(n的开方)</span>
<span class="token comment"># '''</span>
<span class="token comment"># #样本大小</span>
<span class="token comment"># n = 10</span>
<span class="token comment"># #标准误差=样本标准差/(n的开方)</span>
<span class="token comment"># se =sample_std / (np.sqrt(n))</span>

<span class="token comment"># '''</span>
<span class="token comment"># 2）手动计算t值</span>
<span class="token comment"># t=（样本平均值-总体平均值）/标准误差</span>
<span class="token comment"># '''</span>
<span class="token comment"># #总体平均值：就是政府发布的标准20</span>
<span class="token comment"># pop_mean=20</span>
<span class="token comment"># #t值</span>
<span class="token comment"># t=(sample_mean-pop_mean) / se</span>
<span class="token comment"># #计算出t值=-3</span>

<span class="token comment"># print('标准误差se=',se)</span>
<span class="token comment"># print('t=',t)</span>

<span class="token comment"># '''</span>
<span class="token comment"># 2)也可以查t表得到对应的t值</span>
<span class="token comment"># 3）计算自由度df=n-1,t值对应的概率：p=0.0149</span>
<span class="token comment"># 计算p值的工具：https://www.graphpad.com/quickcalcs/</span>
<span class="token comment"># '''</span>



<span class="token triple-quoted-string string">'''
方法二：用python统计包scipy自动计算
用scipy计算出的是：双尾检验
单（1samp）样本t检验（ttest_1samp）：https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_1samp.html
相关（related）样本t检验（ttest_rel）：https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_rel.html
双独立（independent）样本t检验（ttest_ind）：https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html
'''</span>
<span class="token comment">#导入统计模块（stats）</span>
<span class="token keyword">from</span> scipy <span class="token keyword">import</span> stats

<span class="token comment">#总体平均值</span>
pop_mean<span class="token operator">=</span><span class="token number">20</span>

<span class="token triple-quoted-string string">'''
ttest_1samp：单独样本t检验
返回的第1个值t是假设检验计算出的（t值），
第2个值p是双尾检验的p值
'''</span>
t<span class="token punctuation">,</span>p_two <span class="token operator">=</span>stats<span class="token punctuation">.</span>ttest_1samp<span class="token punctuation">(</span>dataSer<span class="token punctuation">,</span>pop_mean<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'t值='</span><span class="token punctuation">,</span>t<span class="token punctuation">,</span><span class="token string">'双尾检验的p值='</span><span class="token punctuation">,</span>p_two<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">'''
因为scipy计算出的是双尾检验的t值和p值，但是我们这里是左尾检验。
根据对称性，双尾的p值是对应单尾p值的2倍
'''</span>
<span class="token comment">#单尾检验的p值</span>
p_one<span class="token operator">=</span>p_two<span class="token operator">/</span><span class="token number">2</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'单尾检验的p值='</span><span class="token punctuation">,</span>p_one<span class="token punctuation">)</span>



<span class="token comment"># 判断标准是什么？</span>
<span class="token comment">#判断标准（显著水平）使用alpha=5%</span>
alpha<span class="token operator">=</span><span class="token number">0.05</span>


<span class="token triple-quoted-string string">'''
左尾判断条件：t &lt; 0 and  p_one &lt; 判断标准（显著水平）alpha
右尾判断条件：t &gt; 0 and  p_one &lt; 判断标准（显著水平）alpha
'''</span>
<span class="token comment">#做出结论</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">&lt;</span><span class="token number">0</span> <span class="token keyword">and</span> p_one<span class="token operator">&lt;</span> alpha<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token comment">#左尾判断条件</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'拒绝零假设，有统计显著，也就是汽车引擎排放满足标准'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span> 
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'接受零假设，没有统计显著，也就是汽车引擎排放不满足标准'</span><span class="token punctuation">)</span>
<span class="token comment"># 拒绝零假设，有统计显著，也就是汽车引擎排放满足标准</span>





<span class="token comment"># 对很多科学来说，我们使用APA格式来报告假设检验的结果。APA表示的美国心理学会，APA格式是美国心理学会给出了如何撰写研究论文的完整指南，其中一部分告诉我们如何写出推论统计学结果。</span>

<span class="token comment"># 图中给出了写出t检验结果的一般规则:t(df)=x.xx,p=.xx,检验方向</span>

<span class="token comment"># 我们按图中标出的序号，看下在报告假设检验时，需要告诉读者以下几点信息： 1）检验类型 包括检验类型，抽样分布，检验方向 首先执行的是哪种类型的检验？在此示例中是单样本t检验，接着在括号中写出自由度，写上等号，然后给出t值，保留两位小数。写上逗号，然后给出p值，同样保留两位小数，然后输出逗号，并指明检验方向。是单尾检验还是双尾检验。 2）精确的p值 然后给出p值，同样保留两位小数，然后输出逗号， 3）给出检验方向，例如是单尾检验还是双尾检验。 4）显著性水平 始终让读者知道你在做出决策时使用的显著性水平。</span>

<span class="token comment"># 独立样本t(9)=-3.00 , p=.0074 (α=5%),单尾检验（左尾）</span>




<span class="token comment"># 5.置信区间</span>
<span class="token comment"># 图片里是APA格式的置信区间：平均值的置信区间，95% CI=(a,b)</span>

<span class="token comment"># 在报告告置信区间时，提供了这样几个信息：</span>
<span class="token comment"># 1）开头会说是哪种类型的置信区间</span>
<span class="token comment"># 例如在单样本检验中是单个平均值的置信区间，但是在我们后面要讲到的相关样本检验是两个平均值之间差异的置信区间。</span>
<span class="token comment"># 在这个案例里，我们是单个平均值的置信区间</span>
<span class="token comment"># 2）置信水平和区间的上下限。</span>
<span class="token comment"># 置信水平（简写为CI），括号里写上下限。这里是955的置信水平</span>

<span class="token triple-quoted-string string">'''
1）置信水平对应的t值（t_ci）
查t表格可以得到，95%的置信水平，自由度是n-1对应的t值
2）计算上下限
置信区间上限a=样本平均值 - t_ci ×标准误差
置信区间下限b=样本平均值 - t_ci ×标准误差
'''</span>

<span class="token triple-quoted-string string">'''
查找t表格获取95%的置信水平，自由度是n-1对应的t值
注意：课程中这里对应的下面t_ci值有误，以下面的值为准
'''</span>
t_ci<span class="token operator">=</span><span class="token number">2.262</span>
<span class="token comment">#使用scipy计算标准误差</span>
se<span class="token operator">=</span>stats<span class="token punctuation">.</span>sem<span class="token punctuation">(</span>dataSer<span class="token punctuation">)</span>
<span class="token comment">#置信区间上限</span>
a<span class="token operator">=</span>sample_mean <span class="token operator">-</span> t_ci <span class="token operator">*</span> se
<span class="token comment">#置信区间下限</span>
b<span class="token operator">=</span>sample_mean <span class="token operator">+</span> t_ci <span class="token operator">*</span> se


<span class="token comment"># 【备注说明】前面第2步和第5步里面两个t值是不一样的</span>

<span class="token comment"># 1）在第2步，证据是什么</span>

<span class="token comment"># 计算p值里的t值，不是从t表格查出来的，是用公式计算出来的t=（样本平均值-总体平均值）/标准误差，然后用这个计算出的t值再去t表格里去查找出p值</span>

<span class="token comment"># 2）在第5步，置信区间</span>

<span class="token comment"># t_ci是置信水平的t值，是根据置信水平95%从t表格里查找到的t值 。为了和前面的t值区别，所以加了后缀t_ci</span>


<span class="token comment"># 6.效应量</span>
<span class="token comment"># 还需要在报告中给出效应量（effect size）。什么是效应量呢？</span>

<span class="token comment"># 效应量是指处理效应的大小，例如药物A比药物B效果显著。度量效应量有很多种，但大多数都属于两大主要类别。</span>

<span class="token comment"># 1）第一种叫做差异度量</span>

<span class="token comment"># 例如在对比平均值时，衡量效应大小的常见标准之一是Cohen's d</span>

<span class="token comment"># Cohen's d = （样本平均值1-样本平均值2) / 标准差</span>

<span class="token comment"># Cohen's d 除以的是标准差，也就是以标准差为单位，样本平均值和总体平均值之间相差多少。</span>

<span class="token comment"># 2）第二种叫做相关度度量</span>

<span class="token comment"># 例如R平方，表示某个变量的变化比例与另一变量的关系。可以用t检验的信息推出R平方的公式，这里的t值从t检验中获得的值，df是自由度。</span>

<span class="token comment"># r2=t2 / (t2+df),其中r2是指r的平方，t2是t的平方</span>

<span class="token comment"># 如果r平方等于20%，表示我们可以说通过知道另一个变量能够接受相关变量20%的变化情况</span>




<span class="token comment"># 为什么要给出效应量？</span>

<span class="token comment"># 在判断某个调查研究的结果，是否有意义或者重要时，要考虑的另一项指标是效应量。效应量太小，意味着处理即使达到了显著水平，也缺乏实用价值。</span>

<span class="token comment"># 所以，在假设检验中，我们给出了是否具有统计显著性，也要给出效应量，一起来判断研究结果是否有意义。</span>

<span class="token comment"># 效应量报告格式：d=x.xx ，R2=.xx</span>

<span class="token comment"># -1.0：完全负相关</span>
<span class="token comment"># -0.7：强负相关</span>
<span class="token comment"># -0.5：中等负相关</span>
<span class="token comment"># -0.3：弱负相关</span>
<span class="token comment"># 0.0：不相关</span>
<span class="token comment"># 0.3：弱正相关</span>
<span class="token comment"># 0.5：中等正相关</span>
<span class="token comment"># 0.7：强正相关</span>
<span class="token comment"># 1.0：完全正相关</span>



<span class="token triple-quoted-string string">'''
效应量：差异指标Cohen's d
'''</span>
d<span class="token operator">=</span><span class="token punctuation">(</span>sample_mean <span class="token operator">-</span> pop_mean<span class="token punctuation">)</span> <span class="token operator">/</span> sample_std
<span class="token triple-quoted-string string">'''
效应量：相关度指标R2
'''</span>
<span class="token comment">#样本大小</span>
n<span class="token operator">=</span><span class="token number">10</span>
<span class="token comment">#自由度</span>
df<span class="token operator">=</span>n<span class="token operator">-</span><span class="token number">1</span>
R2<span class="token operator">=</span><span class="token punctuation">(</span>t<span class="token operator">*</span>t<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>t<span class="token operator">*</span>t<span class="token operator">+</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'d='</span><span class="token punctuation">,</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'R2='</span><span class="token punctuation">,</span>R2<span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/Python/zhihu/HypothesisTesting.html" class="prev">
        假设检验
      </a></span> <span class="next"><a href="/blog/Python/zhihu/t3.html">
        相关配对t检验
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.09e88087.js" defer></script><script src="/blog/assets/js/2.5d6d69d5.js" defer></script><script src="/blog/assets/js/20.ff3ffefa.js" defer></script>
  </body>
</html>
