<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>自动化办公 | 欢迎回来 ！</title>
    <meta name="description" content="lcsx">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/blog/assets/css/0.styles.ee874cfe.css" as="style"><link rel="preload" href="/blog/assets/js/app.750f600d.js" as="script"><link rel="preload" href="/blog/assets/js/2.be40518a.js" as="script"><link rel="preload" href="/blog/assets/js/10.0546ef3d.js" as="script"><link rel="prefetch" href="/blog/assets/js/11.bcb525bf.js"><link rel="prefetch" href="/blog/assets/js/12.0a87404f.js"><link rel="prefetch" href="/blog/assets/js/13.36c618f3.js"><link rel="prefetch" href="/blog/assets/js/14.6779eab1.js"><link rel="prefetch" href="/blog/assets/js/15.3f82a46b.js"><link rel="prefetch" href="/blog/assets/js/16.aa00ba37.js"><link rel="prefetch" href="/blog/assets/js/17.198e465e.js"><link rel="prefetch" href="/blog/assets/js/18.ef11d9bb.js"><link rel="prefetch" href="/blog/assets/js/19.9658a171.js"><link rel="prefetch" href="/blog/assets/js/20.88c2f604.js"><link rel="prefetch" href="/blog/assets/js/21.20a875d5.js"><link rel="prefetch" href="/blog/assets/js/22.82e94915.js"><link rel="prefetch" href="/blog/assets/js/23.84751b50.js"><link rel="prefetch" href="/blog/assets/js/24.f814175f.js"><link rel="prefetch" href="/blog/assets/js/25.3b2d9b9f.js"><link rel="prefetch" href="/blog/assets/js/26.e17073c9.js"><link rel="prefetch" href="/blog/assets/js/27.5e53d8cc.js"><link rel="prefetch" href="/blog/assets/js/28.ecc0597a.js"><link rel="prefetch" href="/blog/assets/js/29.d3af9c62.js"><link rel="prefetch" href="/blog/assets/js/3.3f5e4793.js"><link rel="prefetch" href="/blog/assets/js/30.bb079fbc.js"><link rel="prefetch" href="/blog/assets/js/31.41c112e5.js"><link rel="prefetch" href="/blog/assets/js/32.80d19a68.js"><link rel="prefetch" href="/blog/assets/js/33.36814006.js"><link rel="prefetch" href="/blog/assets/js/34.abc0b8e6.js"><link rel="prefetch" href="/blog/assets/js/35.df043a34.js"><link rel="prefetch" href="/blog/assets/js/36.f312575f.js"><link rel="prefetch" href="/blog/assets/js/37.33c80704.js"><link rel="prefetch" href="/blog/assets/js/38.69642553.js"><link rel="prefetch" href="/blog/assets/js/39.0cea3412.js"><link rel="prefetch" href="/blog/assets/js/4.30f3bdbf.js"><link rel="prefetch" href="/blog/assets/js/40.289a1687.js"><link rel="prefetch" href="/blog/assets/js/41.82daf623.js"><link rel="prefetch" href="/blog/assets/js/42.4dfb8e6a.js"><link rel="prefetch" href="/blog/assets/js/43.beff70ba.js"><link rel="prefetch" href="/blog/assets/js/44.ac862948.js"><link rel="prefetch" href="/blog/assets/js/45.9a380f1d.js"><link rel="prefetch" href="/blog/assets/js/46.58bac913.js"><link rel="prefetch" href="/blog/assets/js/47.fdfbb777.js"><link rel="prefetch" href="/blog/assets/js/48.47d134be.js"><link rel="prefetch" href="/blog/assets/js/49.307f5655.js"><link rel="prefetch" href="/blog/assets/js/5.f39c54a6.js"><link rel="prefetch" href="/blog/assets/js/50.5ed6c291.js"><link rel="prefetch" href="/blog/assets/js/51.7b7da84e.js"><link rel="prefetch" href="/blog/assets/js/52.93c7b5ba.js"><link rel="prefetch" href="/blog/assets/js/53.29f6ef58.js"><link rel="prefetch" href="/blog/assets/js/54.65a57094.js"><link rel="prefetch" href="/blog/assets/js/55.7a349a90.js"><link rel="prefetch" href="/blog/assets/js/56.f109ff2f.js"><link rel="prefetch" href="/blog/assets/js/57.ea0ead20.js"><link rel="prefetch" href="/blog/assets/js/58.2b7e194c.js"><link rel="prefetch" href="/blog/assets/js/59.db3c2c46.js"><link rel="prefetch" href="/blog/assets/js/6.8bfa4c02.js"><link rel="prefetch" href="/blog/assets/js/60.07ecc8b2.js"><link rel="prefetch" href="/blog/assets/js/61.41aab930.js"><link rel="prefetch" href="/blog/assets/js/62.011049e0.js"><link rel="prefetch" href="/blog/assets/js/7.dcdaa74b.js"><link rel="prefetch" href="/blog/assets/js/8.07dbe7a8.js"><link rel="prefetch" href="/blog/assets/js/9.8f7ddf42.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.ee874cfe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="https://vuejs.org/images/logo.png" alt="欢迎回来 ！" class="logo"> <span class="site-name can-hide">欢迎回来 ！</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link router-link-active">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link router-link-active">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/Python/python_study/" class="sidebar-link">python基础</a></li><li><a href="/blog/Python/python_study/auto.html" class="active sidebar-link">自动化办公</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#excel" class="sidebar-link">Excel</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#xlsxwriter" class="sidebar-link">xlsxwriter</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#图表" class="sidebar-link">图表</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#word自动化" class="sidebar-link">WORD自动化</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#字号to磅数-images-py3-png" class="sidebar-link">!字号to磅数</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#word-to-pdf" class="sidebar-link">Word To PDF</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#多个文件的处理" class="sidebar-link">多个文件的处理</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#实践" class="sidebar-link">实践</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#ppt" class="sidebar-link">ppt</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#word2txt" class="sidebar-link">word2txt</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#pdf2txt" class="sidebar-link">pdf2txt</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#读取excel生成word" class="sidebar-link">读取excel生成word</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#word样式" class="sidebar-link">word样式</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#转单个文件txt" class="sidebar-link">转单个文件txt</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#遍历文件打印文件名" class="sidebar-link">遍历文件打印文件名</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#递归遍历转换doc-pdf2-to-txt" class="sidebar-link">递归遍历转换doc/pdf2 to txt</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#常规方法遍历文件30万-数据" class="sidebar-link">常规方法遍历文件30万+数据</a></li><li class="sidebar-sub-header"><a href="/blog/Python/python_study/auto.html#生成迭代器" class="sidebar-link">生成迭代器</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="自动化办公"><a href="#自动化办公" class="header-anchor">#</a> 自动化办公</h1> <p></p><div class="table-of-contents"><ul><li><a href="#自动化办公">自动化办公</a><ul><li><a href="#excel">Excel</a><ul><li><a href="#xlrd常用函数">xlrd常用函数</a><ul><li><a href="#先打开文件">先打开文件</a></li><li><a href="#获取表sheet的操作">获取表sheet的操作</a></li></ul></li><li><a href="#xlrd操作excel行">xlrd操作Excel行</a><ul><li><a href="#row操作-按行操作">row操作 按行操作</a></li></ul></li><li><a href="#xlrd操作excel列">xlrd操作Excel列</a><ul><li><a href="#按列操作-col">按列操作 col</a></li></ul></li><li><a href="#xlrd操作excel单元格">xlrd操作Excel单元格</a></li><li><a href="#xlwt写入excel">xlwt写入Excel</a><ul><li><a href="#安装">安装</a></li></ul></li></ul></li><li><a href="#xlsxwriter">xlsxwriter</a><ul><li><a href="#安装">安装</a></li></ul><ul><li><a href="#格式化配置">格式化配置</a></li></ul></li><li><a href="#图表">图表</a><ul><li><a href="#结语">结语</a></li></ul></li><li><a href="#word自动化">WORD自动化</a><ul><li><a href="#python-docx">python-docx</a></li><li><a href="#安装">安装</a></li><li><a href="#use">use</a></li><li><a href="#字号to磅数">字号to磅数</a></li></ul></li><li><a href="#字号to磅数-images-py3-png">!字号to磅数</a></li><li><a href="#word-to-pdf">Word To PDF</a><ul><li><a href="#安装pywin32">安装pywin32</a></li><li><a href="#use">use</a></li></ul></li><li><a href="#多个文件的处理">多个文件的处理</a><ul><li><a href="#os">os</a></li></ul></li><li><a href="#实践">实践</a></li><li><a href="#ppt">ppt</a></li><li><a href="#word2txt">word2txt</a></li><li><a href="#pdf2txt">pdf2txt</a></li><li><a href="#读取excel生成word">读取excel生成word</a></li><li><a href="#word样式">word样式</a></li><li><a href="#转单个文件txt">转单个文件txt</a><ul><li><a href="#file2txt-py">file2txt.py</a></li></ul></li><li><a href="#遍历文件打印文件名">遍历文件打印文件名</a></li><li><a href="#递归遍历转换doc-pdf2-to-txt">递归遍历转换doc/pdf2 to txt</a></li><li><a href="#常规方法遍历文件30万-数据">常规方法遍历文件30万+数据</a></li><li><a href="#生成迭代器">生成迭代器</a><ul><li><a href="#高效遍历">高效遍历</a></li></ul></li></ul></li></ul></div><p></p> <h2 id="excel"><a href="#excel" class="header-anchor">#</a> Excel</h2> <p>xlrd为python第三方模块，用来读取excel表格数据</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#安装 xlrd</span>
pip <span class="token function">install</span> xlrd

<span class="token comment"># 查看本机安装的模块</span>
pip list
</code></pre></div><h3 id="xlrd常用函数"><a href="#xlrd常用函数" class="header-anchor">#</a> xlrd常用函数</h3> <h4 id="先打开文件"><a href="#先打开文件" class="header-anchor">#</a> 先打开文件</h4> <blockquote><p>data = xlrd.open_workbook(&quot;&quot;)  #打开文件</p></blockquote> <h4 id="获取表sheet的操作"><a href="#获取表sheet的操作" class="header-anchor">#</a> 获取表sheet的操作</h4> <table><thead><tr><th>方法</th> <th style="text-align:center;">描述</th> <th style="text-align:right;">备注</th></tr></thead> <tbody><tr><td>open_workbook</td> <td style="text-align:center;">打开文件</td> <td style="text-align:right;">xlrd.open_workbook(&quot;&quot;)</td></tr> <tr><td>sheet_loaded</td> <td style="text-align:center;">加载工作表</td> <td style="text-align:right;"></td></tr> <tr><td>unload_sheet</td> <td style="text-align:center;">卸载工作表</td> <td style="text-align:right;"></td></tr> <tr><td>sheets</td> <td style="text-align:center;">获取所有工作表</td> <td style="text-align:right;"></td></tr> <tr><td>sheet_by_index</td> <td style="text-align:center;">按索引获取工作表</td> <td style="text-align:right;"></td></tr> <tr><td>sheet_by_name</td> <td style="text-align:center;">按表明获取工作表</td> <td style="text-align:right;"></td></tr> <tr><td>nsheet</td> <td style="text-align:center;">返回excle工作表的数量</td> <td style="text-align:right;"></td></tr></tbody></table> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> xlrd

data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>  <span class="token comment">#打开文件</span>

data<span class="token punctuation">.</span>sheet_loaded<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 加载第一个工作表</span>
data<span class="token punctuation">.</span>unload_sheet<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 卸载第一个工作表</span>

data<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># 获取所有工作表  list列表</span>
data<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment">#获取第一个工作表</span>
data<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>   <span class="token comment"># 根据索引获取工作表</span>
data<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span> <span class="token comment"># 根据表名获取工作表</span>
data<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># 获取所有表名</span>
data<span class="token punctuation">.</span>nsheet   <span class="token comment">#返回excle工作表的数量</span>
</code></pre></div><h3 id="xlrd操作excel行"><a href="#xlrd操作excel行" class="header-anchor">#</a> xlrd操作Excel行</h3> <h4 id="row操作-按行操作"><a href="#row操作-按行操作" class="header-anchor">#</a> row操作 按行操作</h4> <table><thead><tr><th>方法</th> <th style="text-align:center;">描述</th> <th style="text-align:right;">备注</th></tr></thead> <tbody><tr><td>row(0)</td> <td style="text-align:center;">获取表第一行数据</td> <td style="text-align:right;"></td></tr> <tr><td>row_types()</td> <td style="text-align:center;">获取表第一行的数据类型</td> <td style="text-align:right;">获取表第一行的数据类型   1表示字符串   2表示number 3：布尔   4：errors</td></tr> <tr><td>row(1)[1]</td> <td style="text-align:center;">获取二行2列  这里返回的是一个cell的对象</td> <td style="text-align:right;"></td></tr> <tr><td>row(1)[1].value</td> <td style="text-align:center;">获取cell里面的值</td> <td style="text-align:right;"></td></tr> <tr><td>row_values(1)</td> <td style="text-align:center;">获取第2行，所有列单元格里的数据  list类型</td> <td style="text-align:right;"></td></tr> <tr><td>.row_len(1)</td> <td style="text-align:center;">获取第二行，列长度</td> <td style="text-align:right;"></td></tr></tbody></table> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> xlrd

data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">&quot;lcs1.xlsx&quot;</span><span class="token punctuation">)</span>  <span class="token comment">#打开文件</span>
sheet <span class="token operator">=</span> data<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>   <span class="token comment">#获取第一个表</span>
rows <span class="token operator">=</span> sheet<span class="token punctuation">.</span>nrows      <span class="token comment">#属性</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>row<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#获取表第一行数据    #[text:'asd ', empty:'', empty:'']    type:list 列表</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>row_types<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#获取表第一行的数据类型   1表示字符串   2表示number 3：布尔   4：errors</span>

<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>row<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>   <span class="token comment">#获取二行2列  这里返回的是一个cell的对象</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>row<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>   <span class="token comment">#获取cell里面的值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>     <span class="token comment">#获取第2行，所有列单元格里的数据  list类型</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>row_len<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>   <span class="token comment">#获取第二行，列长度</span>
</code></pre></div><h3 id="xlrd操作excel列"><a href="#xlrd操作excel列" class="header-anchor">#</a> xlrd操作Excel列</h3> <table><thead><tr><th>方法</th> <th style="text-align:center;">描述</th> <th style="text-align:right;">备注</th></tr></thead> <tbody><tr><td>col(0)</td> <td style="text-align:center;"></td> <td style="text-align:right;"></td></tr> <tr><td>col_types()</td> <td style="text-align:center;"></td> <td style="text-align:right;">获取表第一行的数据类型   1表示字符串   2表示number 3：布尔   4：errors</td></tr> <tr><td>col(1)[1]</td> <td style="text-align:center;">这里返回的是一个cell的对象</td> <td style="text-align:right;"></td></tr> <tr><td>col(1)[1].value</td> <td style="text-align:center;"></td> <td style="text-align:right;"></td></tr> <tr><td>col_values(1)</td> <td style="text-align:center;">获取第2列，所有单元格里的数据  list类型</td> <td style="text-align:right;"></td></tr> <tr><td>col_len(1)</td> <td style="text-align:center;"></td> <td style="text-align:right;"></td></tr></tbody></table> <h4 id="按列操作-col"><a href="#按列操作-col" class="header-anchor">#</a> 按列操作 col</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> xlrd
data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">'lcs1.xlsx'</span><span class="token punctuation">)</span>

sheet <span class="token operator">=</span> data<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 获取第二个表</span>

<span class="token comment"># 获取总列数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>ncols <span class="token punctuation">)</span>


<span class="token comment"># 获取某列数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token comment">#[text:'asd ', text:'lcs2', text:'lcs3']</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token builtin">type</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token comment">#&lt;class 'list'&gt;</span>

<span class="token comment"># 获取第一列第二行数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> 
<span class="token comment"># 获取第一列第二行 值数据  </span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>

<span class="token comment">## 获取1列所有单元格的值的列表</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>col_values<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>

<span class="token comment">## 获取1列所有单元格的值的类型的列表</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>col_types<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
</code></pre></div><h3 id="xlrd操作excel单元格"><a href="#xlrd操作excel单元格" class="header-anchor">#</a> xlrd操作Excel单元格</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> xlrd

data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">&quot;lcs1.xlsx&quot;</span><span class="token punctuation">)</span>  <span class="token comment">#打开文件</span>
sheet <span class="token operator">=</span> data<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>   <span class="token comment">#获取第一个表</span>

<span class="token comment"># 获取第二行第二列单元格</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>

<span class="token comment"># 获取单元格数据类型</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ctype <span class="token punctuation">)</span>   <span class="token comment">#通过属性获取类型</span>
</code></pre></div><h3 id="xlwt写入excel"><a href="#xlwt写入excel" class="header-anchor">#</a> xlwt写入Excel</h3> <p>xlwt是python的第三方模块，用来写入Excel表格数据</p> <p>适用：&gt;07版 xlsx格式</p> <p>可保存为  xls / xlsx 格式</p> <p>python也有别的模块可以操作excel   xlsxwriter</p> <h4 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h4> <div class="language-bash extra-class"><pre class="language-bash"><code>pip <span class="token function">install</span> xlwt
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> xlwt

<span class="token comment">#创建工作簿</span>
wb <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#创建工作表</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">&quot;sheet的名称&quot;</span><span class="token punctuation">)</span>

<span class="token comment">#填充数据</span>
<span class="token comment">#合并单元格，write_merge(起始row,结束row,起始col,结束col,title)</span>
ws<span class="token punctuation">.</span>write_merge<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">&quot;2020lcs&quot;</span><span class="token punctuation">,</span> titlestyle<span class="token punctuation">)</span>   <span class="token comment"># 将样式放里面</span>

<span class="token comment">#保存</span>
wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&quot;保存的名字.xlsx&quot;</span><span class="token punctuation">)</span>   

</code></pre></div><p>遍历数据</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> xlwt

<span class="token comment"># 添加表格样式</span>
titlestyle <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>XFStyle<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#初始化样式</span>

titlefont <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token punctuation">)</span>
titlefont<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;宋体&quot;</span>
titlefont<span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token comment">#加粗</span>
titlefont<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">11</span><span class="token operator">*</span><span class="token number">20</span> <span class="token comment">#zihao</span>
titlefont<span class="token punctuation">.</span>colour_index <span class="token operator">=</span> <span class="token number">0x08</span> <span class="token comment">#字体颜色</span>

titlestyle<span class="token punctuation">.</span>font <span class="token operator">=</span> titlefont

<span class="token comment"># 对齐方式</span>
cellalign <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Alignment<span class="token punctuation">(</span><span class="token punctuation">)</span>
cellalign<span class="token punctuation">.</span>horz <span class="token operator">=</span> <span class="token number">0x02</span>
cellalign<span class="token punctuation">.</span>vert <span class="token operator">=</span> <span class="token number">0x01</span>

titlestyle<span class="token punctuation">.</span>alignment <span class="token operator">=</span> cellalign


<span class="token comment"># 边框</span>
border <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Borders<span class="token punctuation">(</span><span class="token punctuation">)</span>
borders<span class="token punctuation">.</span>right <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Borders<span class="token punctuation">.</span>DASHED
borders<span class="token punctuation">.</span>bottom <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Borders<span class="token punctuation">.</span>DOTTED
titlestyle<span class="token punctuation">.</span>borders <span class="token operator">=</span> borders


<span class="token comment">#创建工作簿</span>
wb <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#创建工作表</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">&quot;sheet的名称&quot;</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token string">&quot;班级&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;姓名&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;学号&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;分数&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&quot;lcs&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1111&quot;</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;xdl&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;2222&quot;</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>


<span class="token comment"># enumerate()将 元组转成有序列的</span>
<span class="token comment"># write(row,col,数据,bool=False)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span>item <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j<span class="token punctuation">,</span>val <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        ws<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">,</span>j<span class="token punctuation">,</span>val<span class="token punctuation">)</span>        <span class="token comment"># row偏移 2个单位   </span>


<span class="token comment"># wbimg = xlwt.add_sheet(&quot;插图图片 sheet&quot;)</span>
<span class="token comment"># wbimg.insert_bitmap(&quot;图片名&quot;,起始row,起始col,....别的参数)</span>
<span class="token comment"># wbimg.insert_bitmap(&quot;图片名&quot;,起始row,起始col,....别的参数)</span>



wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&quot;2020级mba成绩.xlsx&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="xlsxwriter"><a href="#xlsxwriter" class="header-anchor">#</a> xlsxwriter</h2> <ul><li>支持更多excel格式，100%兼容excel xlsx文件</li> <li>处理速度更快，支持大文件写入（1万多条记录）</li> <li>缺点：不支持读取和修改excel文件</li></ul> <p>参考文档：</p> <p><a href="https://xlsxwriter.readthedocs.io/contents.html" target="_blank" rel="noopener noreferrer">xlsxwriter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.jianshu.com/p/32d6b528d5c5" target="_blank" rel="noopener noreferrer">别人的博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="安装-2"><a href="#安装-2" class="header-anchor">#</a> 安装</h4> <div class="language-bash extra-class"><pre class="language-bash"><code>pip <span class="token function">install</span> xlsxwriter
</code></pre></div><h3 id="格式化配置"><a href="#格式化配置" class="header-anchor">#</a> 格式化配置</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token comment"># 两种调用方式</span>

<span class="token comment"># 第一种</span>
cell_format <span class="token operator">=</span> wb<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;bold&quot;</span><span class="token punctuation">:</span><span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;lcs&quot;</span><span class="token punctuation">,</span>cell_format<span class="token punctuation">)</span>

<span class="token comment"># 第二种</span>
cell_format1 <span class="token operator">=</span> wb<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">)</span>
cell_format1<span class="token punctuation">.</span>set_bold<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#设置加粗</span>
cell_format1<span class="token punctuation">.</span>set_font_color<span class="token punctuation">(</span><span class="token string">&quot;Red&quot;</span><span class="token punctuation">)</span>
cell_format1<span class="token punctuation">.</span>set_font_size<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>
cell_format1<span class="token punctuation">.</span>set_align<span class="token punctuation">(</span><span class="token string">&quot;center&quot;</span><span class="token punctuation">)</span> <span class="token comment">#对齐方式</span>

sheet<span class="token punctuation">.</span>merge_range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&quot;lcs66&quot;</span><span class="token punctuation">,</span>cell_format1<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><h2 id="图表"><a href="#图表" class="header-anchor">#</a> 图表</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> xlsxwriter

wb <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">&quot;要创建的文件名.xlsx&quot;</span><span class="token punctuation">)</span>




<span class="token comment"># 创建工作表</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">&quot;newsheet&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 如果不传，就用默认的&quot;Sheet1&quot;</span>

<span class="token comment"># 格式化样式</span>
cell_format1 <span class="token operator">=</span> wb<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">)</span>
cell_format1<span class="token punctuation">.</span>set_bold<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#设置加粗</span>
cell_format1<span class="token punctuation">.</span>set_font_color<span class="token punctuation">(</span><span class="token string">&quot;Red&quot;</span><span class="token punctuation">)</span>
cell_format1<span class="token punctuation">.</span>set_font_size<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>
cell_format1<span class="token punctuation">.</span>set_align<span class="token punctuation">(</span><span class="token string">&quot;center&quot;</span><span class="token punctuation">)</span> <span class="token comment">#对齐方式</span>

<span class="token comment"># 有很多写入方法</span>
<span class="token comment"># sheet.write_string()  写入字符串</span>
<span class="token comment"># 其他的写入有时间，bool，number，等等等</span>

<span class="token comment"># sheet.write(row,col,&quot;写入的数据&quot;)</span>
sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;lcs&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># 合并单元格</span>
sheet<span class="token punctuation">.</span>merge_range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&quot;title1&quot;</span><span class="token punctuation">,</span>cell_format1<span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">(</span>
	<span class="token punctuation">[</span><span class="token string">&quot;一月&quot;</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span><span class="token string">&quot;er月&quot;</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment"># write_row 按行写入</span>
sheet<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;月份&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;预计&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;实际&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> index<span class="token punctuation">,</span>item <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
	sheet<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span>

<span class="token comment"># 统计功能</span>
<span class="token comment"># sheet.write(row,col,&quot;excel函数&quot;)</span>
sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;=sum(B5:B6)&quot;</span><span class="token punctuation">)</span>     <span class="token comment">#B5到B6</span>

<span class="token comment"># 外链</span>
<span class="token comment"># sheet.write_url(9,0,&quot;http://baidu.com&quot;[,string=&quot;点我到百度&quot;])</span>
sheet<span class="token punctuation">.</span>write_url<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;http://baidu.com&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 图片</span>
<span class="token comment"># sheet.insert_image(10,0,&quot;./images/lcs.jpeg&quot;)</span>


<span class="token comment"># 图表</span>
chart <span class="token operator">=</span> wb<span class="token punctuation">.</span>add_chart<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;column&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># column柱状图  line折线图</span>

<span class="token comment">## 设置图表标题</span>
chart<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2020级mba班成绩分布&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## 设置x,y轴的描述信息的title（不是坐标轴的单位哦）</span>
chart<span class="token punctuation">.</span>set_x_axis<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;月份&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">#还可以设置字号，样式等</span>
chart<span class="token punctuation">.</span>set_y_axis<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;金额&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">## 数据  系列</span>
chart<span class="token punctuation">.</span>add_series<span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;预期销售额&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;categories&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;=表sheet的名称!$A$5:$A$7&quot;</span><span class="token punctuation">,</span>     
	<span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&quot;表sheet的名称&quot;</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">### 以上句子的意思是：添加一个系列“预期销售额”，有类（从表中A5到A7获取即“一月份”，“二月份”，“三月份”）,ta分别的值为，[表名,起始row,起始col,结束row,结束col]</span>

<span class="token comment">### 可以多个系列</span>
chart<span class="token punctuation">.</span>add_series<span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;实际销售额&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;categories&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;=表sheet的名称!$A$5:$A$7&quot;</span><span class="token punctuation">,</span>     
	<span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&quot;表sheet的名称&quot;</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token string">&quot;data_labels&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span>Ture<span class="token punctuation">}</span>    <span class="token comment">#在类上面显示数字</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">### 插入图表</span>
<span class="token comment">#sheet.insert_chart(&quot;位置&quot;,图表对象)</span>
sheet<span class="token punctuation">.</span>insert_chart<span class="token punctuation">(</span><span class="token string">&quot;A23&quot;</span><span class="token punctuation">,</span>chart<span class="token punctuation">)</span>


<span class="token comment"># 关闭	</span>
wb<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>	
</code></pre></div><p><img src="/blog/assets/img/chart1.bad68284.png" alt=""></p> <h3 id="结语"><a href="#结语" class="header-anchor">#</a> 结语</h3> <p>一般会有如此场景：</p> <p>读取excel文件 &gt; 调整格式+图表</p> <p>步骤：</p> <ul><li>xlrt模块读取excel数据</li> <li>xlsxwriter模块生成数据图表</li></ul> <h2 id="word自动化"><a href="#word自动化" class="header-anchor">#</a> WORD自动化</h2> <h3 id="python-docx"><a href="#python-docx" class="header-anchor">#</a> python-docx</h3> <p>python第三方模块，可用于自动化生成和修改word文档</p> <h3 id="安装-3"><a href="#安装-3" class="header-anchor">#</a> 安装</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>pip <span class="token function">install</span> python-docx
</code></pre></div><h3 id="use"><a href="#use" class="header-anchor">#</a> use</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> docx <span class="token keyword">import</span> Document
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Pt<span class="token punctuation">,</span>RGBColor
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>enum<span class="token punctuation">.</span>style <span class="token keyword">import</span> WD_STYLE_TYPE

<span class="token comment"># 创建一个文档对象</span>
document <span class="token operator">=</span> Document<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># doc = Document('lcs.docx')  #读取现有的文档</span>

<span class="token comment"># 写入内容</span>
document<span class="token punctuation">.</span>add_heading<span class="token punctuation">(</span><span class="token string">&quot;lcsnihao&quot;</span><span class="token punctuation">,</span>level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment">#level级别</span>

<span class="token comment"># 段落</span>
p1 <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">&quot;lcslcslcslcs&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 插入段落</span>
p1<span class="token punctuation">.</span>insert_paragraph_before<span class="token punctuation">(</span><span class="token string">&quot;在p1段落前插入一个新的段落&quot;</span><span class="token punctuation">)</span>



<span class="token comment"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="token comment"># 格式化</span>
<span class="token builtin">format</span> <span class="token operator">=</span> p1<span class="token punctuation">.</span>paragraph_format


<span class="token comment">## 左右缩进</span>
<span class="token builtin">format</span><span class="token punctuation">.</span>left_indent <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment">#20磅</span>
<span class="token builtin">format</span><span class="token punctuation">.</span>right_indent <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment">#20磅</span>
<span class="token comment">## 首行缩进</span>
<span class="token builtin">format</span><span class="token punctuation">.</span>first_line_indent <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment">## 行间距</span>
<span class="token builtin">format</span><span class="token punctuation">.</span>line_spacing <span class="token operator">=</span> <span class="token number">1.5</span>

<span class="token comment">## 为段落追加 add.run(&quot;文字&quot;)</span>
run <span class="token operator">=</span> p1<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&quot;ni zm zheme shuai o,buxinglebuxingle&quot;</span><span class="token punctuation">)</span>
<span class="token comment">## 为其设置格式</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>size <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>name<span class="token operator">=</span> <span class="token string">&quot;微软雅黑&quot;</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>color<span class="token punctuation">.</span>rgb <span class="token operator">=</span> RGBColor<span class="token punctuation">(</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">)</span>

<span class="token comment">### 加粗、下划线、斜体</span>
run<span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>underline <span class="token operator">=</span> <span class="token boolean">True</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>italic <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token comment"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>



<span class="token comment"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="token comment"># 插入图片</span>
<span class="token comment"># document.add_picture(&quot;图片地址&quot;,Pt(20)大小,Pt(大小))</span>
document<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">'py3.png'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">'py3.png'</span><span class="token punctuation">,</span>Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>




<span class="token comment"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="token comment"># 插入表格</span>
table <span class="token operator">=</span> document<span class="token punctuation">.</span>add_table<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>cols<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>   <span class="token comment">#一行三列的表格</span>

<span class="token comment">## 获取第一行</span>
header_cells <span class="token operator">=</span> table<span class="token punctuation">.</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cells

<span class="token comment">## 设置表头</span>
header_cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;月份&quot;</span>
header_cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'预期销售额'</span>
header_cells<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'实际销售额'</span>

<span class="token comment">## 写入数据</span>
data <span class="token operator">=</span> <span class="token punctuation">(</span>
	<span class="token punctuation">[</span><span class="token string">'一月份'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span><span class="token string">'二月份'</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span><span class="token string">'三月份'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">288</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>

<span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
	<span class="token comment"># 添加一行</span>
	row_cells <span class="token operator">=</span> table<span class="token punctuation">.</span>add_row<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cells
	row_cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	row_cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	row_cells<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 获取表格总行数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token builtin">len</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rows<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment"># 获取表格总列数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token builtin">len</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment"># 获取某个表具体某个单元格数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> document<span class="token punctuation">.</span>tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text <span class="token punctuation">)</span>
<span class="token comment"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>


<span class="token comment"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="token comment"># 给段落添加样式</span>
<span class="token comment"># import模块 WD_STYLE_TYPE</span>
<span class="token comment"># 实例，设置实例参数</span>
<span class="token comment"># 放到具体地方</span>
<span class="token comment"># document.styles.add_style(&quot;样式名称&quot;,&quot;模块内置的对象&quot;)</span>
style <span class="token operator">=</span> document<span class="token punctuation">.</span>styles<span class="token punctuation">.</span>add_style<span class="token punctuation">(</span><span class="token string">&quot;textstyle&quot;</span><span class="token punctuation">,</span>WD_STYLE_TYPE<span class="token punctuation">.</span>PARAGRAPH<span class="token punctuation">)</span>   <span class="token comment">#WD_STYLE_TYPE.PARAGRAPH这里是到段落的样式</span>

<span class="token comment"># 设置具体样式</span>
style<span class="token punctuation">.</span>font<span class="token punctuation">.</span>size <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>insert_paragraph_before<span class="token punctuation">(</span><span class="token string">&quot;我欲迎风在留住几步&quot;</span><span class="token punctuation">,</span>style<span class="token operator">=</span><span class="token string">&quot;textstyle&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># 删除样式</span>
document<span class="token punctuation">.</span>styles<span class="token punctuation">[</span><span class="token string">&quot;textstyle&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>




<span class="token comment"># 保存文档</span>
document<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'lcs.docx'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="字号to磅数"><a href="#字号to磅数" class="header-anchor">#</a> 字号to磅数</h3> <h2 id=""><a href="#" class="header-anchor">#</a> <img src="/blog/assets/img/py3.9b268ab3.png" alt="字号to磅数"></h2> <h2 id="word-to-pdf"><a href="#word-to-pdf" class="header-anchor">#</a> Word To PDF</h2> <h3 id="安装pywin32"><a href="#安装pywin32" class="header-anchor">#</a> 安装pywin32</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>pip <span class="token function">install</span> pywin32
</code></pre></div><h3 id="use-2"><a href="#use-2" class="header-anchor">#</a> use</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> win32com<span class="token punctuation">.</span>client <span class="token keyword">import</span> constants<span class="token punctuation">,</span> gencache
<span class="token keyword">import</span> re

<span class="token keyword">def</span> <span class="token function">createpdf</span><span class="token punctuation">(</span>wordPath<span class="token punctuation">,</span> pdfPath<span class="token punctuation">)</span><span class="token punctuation">:</span>
    word <span class="token operator">=</span> gencache<span class="token punctuation">.</span>EnsureDispatch<span class="token punctuation">(</span><span class="token string">&quot;Word.Application&quot;</span><span class="token punctuation">)</span>
    doc <span class="token operator">=</span> word<span class="token punctuation">.</span>Documents<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>tranFileAdress<span class="token punctuation">(</span>wordPath<span class="token punctuation">)</span><span class="token punctuation">,</span> ReadOnly<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># 转换方法</span>
    doc<span class="token punctuation">.</span>ExportAsFixedFormat<span class="token punctuation">(</span>tranFileAdress<span class="token punctuation">(</span>pdfPath<span class="token punctuation">)</span><span class="token punctuation">,</span> constants<span class="token punctuation">.</span>wdExportFormatPDF<span class="token punctuation">)</span>
    word<span class="token punctuation">.</span>Quit<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">tranFileAdress</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># print(re.sub(r&quot;\\&quot;,&quot;/&quot;, str))</span>
    <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">&quot;\\&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    	<span class="token keyword">return</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r&quot;\\&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span>
	<span class="token comment"># print(re.sub(r&quot;\\&quot;,&quot;/&quot;, str))</span>


<span class="token comment"># tranFileAdress(r&quot;C:\\Users\46957\Desktop\pytest\lcs.docx&quot;)</span>

createpdf<span class="token punctuation">(</span><span class="token string">r&quot;C:\Users\46957\Desktop\pytest\lcs.docx&quot;</span><span class="token punctuation">,</span> <span class="token string">r&quot;C:\Users\46957\Desktop\pytest\lcs.pdf&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="多个文件的处理"><a href="#多个文件的处理" class="header-anchor">#</a> 多个文件的处理</h2> <h3 id="os"><a href="#os" class="header-anchor">#</a> os</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> win32com<span class="token punctuation">.</span>client <span class="token keyword">import</span> constants<span class="token punctuation">,</span> gencache
<span class="token keyword">import</span> os

<span class="token keyword">import</span> re

<span class="token keyword">def</span> <span class="token function">createpdf</span><span class="token punctuation">(</span>wordPath<span class="token punctuation">,</span> pdfPath<span class="token punctuation">)</span><span class="token punctuation">:</span>
    word <span class="token operator">=</span> gencache<span class="token punctuation">.</span>EnsureDispatch<span class="token punctuation">(</span><span class="token string">&quot;Word.Application&quot;</span><span class="token punctuation">)</span>
    doc <span class="token operator">=</span> word<span class="token punctuation">.</span>Documents<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>wordPath<span class="token punctuation">,</span> ReadOnly<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># 转换方法</span>
    doc<span class="token punctuation">.</span>ExportAsFixedFormat<span class="token punctuation">(</span>pdfPath<span class="token punctuation">,</span> constants<span class="token punctuation">.</span>wdExportFormatPDF<span class="token punctuation">)</span>
    <span class="token comment">#word.Quit()   # 不注释掉，就只能转第一个了，什么情况</span>

<span class="token comment"># 后面发现这个不用也行的</span>
<span class="token keyword">def</span> <span class="token function">tranFileAdress</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># print(re.sub(r&quot;\\&quot;,&quot;/&quot;, str))</span>
    <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">&quot;\\&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    	<span class="token keyword">return</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r&quot;\\&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span>
	<span class="token comment"># print(re.sub(r&quot;\\&quot;,&quot;/&quot;, str))</span>
	<span class="token keyword">return</span> <span class="token builtin">str</span>


<span class="token comment"># 获取当前文件夹的所有文件</span>
<span class="token comment"># os.listdir('.')  </span>

<span class="token comment"># 筛选所有的word文件</span>
wordfiles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> <span class="token builtin">file</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token string">'.doc'</span><span class="token punctuation">,</span><span class="token string">'.docx'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">:</span>
		wordfiles<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
		
<span class="token keyword">print</span><span class="token punctuation">(</span>wordfiles<span class="token punctuation">)</span>   <span class="token comment">#['1.docx', 'lcs.docx']</span>




<span class="token comment"># ['1.docx', 'lcs.docx']这里并不是想要的，需要一个文件地址的绝对路径</span>
<span class="token comment"># 获取绝对路径</span>
<span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> wordfiles<span class="token punctuation">:</span>

	filepath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>  <span class="token comment">#获取word文件的绝对路径</span>
	<span class="token comment"># print(filepath)</span>
	
	<span class="token comment"># 那生成的pdf的文件名和存储路径呢？</span>
	index <span class="token operator">=</span> filepath<span class="token punctuation">.</span>rindex<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>      <span class="token comment">#rfind() 返回字符串最后一次出现的位置,就是从字符串右边开始查找</span>
	<span class="token comment"># print(filepath[:index])   </span>
	pdfpath <span class="token operator">=</span> filepath<span class="token punctuation">[</span><span class="token punctuation">:</span>index<span class="token punctuation">]</span><span class="token operator">+</span> <span class="token string">'.pdf'</span>
	<span class="token comment"># print(pdfpath)</span>
	
	createpdf<span class="token punctuation">(</span>filepath<span class="token punctuation">,</span>pdfpath<span class="token punctuation">)</span>
	

</code></pre></div><h2 id="实践"><a href="#实践" class="header-anchor">#</a> 实践</h2> <p>生成试卷</p> <ol><li>xlrt 从excel读取数据</li> <li>随机试题与选项顺序</li> <li>python-docx 模块 生成word</li></ol> <hr> <p><img src="/blog/assets/img/py4.ac0cf8c5.png" alt=""></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> xlrd
<span class="token keyword">import</span> random
<span class="token keyword">from</span> docx <span class="token keyword">import</span> Document
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Pt<span class="token punctuation">,</span>RGBColor
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>enum<span class="token punctuation">.</span>text <span class="token keyword">import</span> WD_ALIGN_PARAGRAPH
 
<span class="token comment"># 读取excel</span>
data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">&quot;data3.xlsx&quot;</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取工作表</span>
sheet <span class="token operator">=</span> data<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> 
 
<span class="token comment"># 用来存储数据</span>
<span class="token keyword">class</span> <span class="token class-name">Question</span><span class="token punctuation">:</span>
	<span class="token keyword">pass</span>
 
<span class="token keyword">def</span> <span class="token function">createQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	questionlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>nrows<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">if</span> i<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token punctuation">:</span>
			obj <span class="token operator">=</span> Question<span class="token punctuation">(</span><span class="token punctuation">)</span>
			obj<span class="token punctuation">.</span>subject <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value 	<span class="token comment"># 题目</span>
			obj<span class="token punctuation">.</span>questiontype <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value 	<span class="token comment"># 题型 </span>
			obj<span class="token punctuation">.</span>option <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
			obj<span class="token punctuation">.</span>option<span class="token punctuation">.</span>append<span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>  <span class="token comment"># a</span>
			obj<span class="token punctuation">.</span>option<span class="token punctuation">.</span>append<span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>  <span class="token comment"># b</span>
			obj<span class="token punctuation">.</span>option<span class="token punctuation">.</span>append<span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>  <span class="token comment"># c</span>
			obj<span class="token punctuation">.</span>option<span class="token punctuation">.</span>append<span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>  <span class="token comment"># d</span>
			obj<span class="token punctuation">.</span>score <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value  	<span class="token comment"># 分值</span>
			
			questionlist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
	
	random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>questionlist<span class="token punctuation">)</span>		<span class="token comment"># 将序列所有的元素随机排序</span>
			
	<span class="token keyword">return</span> questionlist
	
	
	
<span class="token comment"># 生成word试卷</span>

<span class="token keyword">def</span> <span class="token function">createPaper</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>papername<span class="token punctuation">,</span>questionlist<span class="token punctuation">)</span><span class="token punctuation">:</span>
	document <span class="token operator">=</span> Document<span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment"># 页眉页脚的信息</span>
	<span class="token comment"># sections  文档可以又很多部分，这里取第一个</span>
	section <span class="token operator">=</span> document<span class="token punctuation">.</span>sections<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	header <span class="token operator">=</span> section<span class="token punctuation">.</span>header
	p1 <span class="token operator">=</span> header<span class="token punctuation">.</span>paragraphs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>   <span class="token comment"># 获取头部的部分</span>
	p1<span class="token punctuation">.</span>text <span class="token operator">=</span> papername
	
	footer <span class="token operator">=</span> section<span class="token punctuation">.</span>footer
	p2 <span class="token operator">=</span> footer<span class="token punctuation">.</span>paragraphs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 获取底部部分</span>
	p2<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;内部试题，禁止泄露&quot;</span>
	
	
	
	<span class="token comment"># 试卷基本信息</span>

	title <span class="token operator">=</span> document<span class="token punctuation">.</span>add_heading<span class="token punctuation">(</span>papername<span class="token punctuation">,</span>level<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
	title<span class="token punctuation">.</span>alignment <span class="token operator">=</span> WD_ALIGN_PARAGRAPH<span class="token punctuation">.</span>CENTER
	
	p3 <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token punctuation">)</span>
	p3<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&quot;姓名:_______&quot;</span><span class="token punctuation">)</span>
	p3<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&quot;姓名:_______&quot;</span><span class="token punctuation">)</span>
	p3<span class="token punctuation">.</span>alignment <span class="token operator">=</span> WD_ALIGN_PARAGRAPH<span class="token punctuation">.</span>CENTER
	

	
	<span class="token comment"># 试题信息</span>
	<span class="token keyword">for</span> question <span class="token keyword">in</span> questionlist<span class="token punctuation">:</span>
		subject <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span>style <span class="token operator">=</span> <span class="token string">&quot;List Number&quot;</span><span class="token punctuation">)</span>   <span class="token comment"># 段落样式 段落开头加序号  ，也有其他样式如小圆点，具体查文档</span>
		run <span class="token operator">=</span> subject<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span>question<span class="token punctuation">.</span>subject<span class="token punctuation">)</span>
		run<span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># 题目加粗</span>
		subject<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&quot;【%s】分&quot;</span><span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>question<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span>
		random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>question<span class="token punctuation">.</span>option<span class="token punctuation">)</span>   <span class="token comment"># 选项打乱</span>
		<span class="token keyword">for</span> index<span class="token punctuation">,</span>option <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>question<span class="token punctuation">.</span>option<span class="token punctuation">)</span><span class="token punctuation">:</span>
			document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token string">&quot;ABCD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span> <span class="token punctuation">)</span>


	document<span class="token punctuation">.</span>save<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>


questionlist <span class="token operator">=</span> createQuestion<span class="token punctuation">(</span><span class="token punctuation">)</span>
createPaper<span class="token punctuation">(</span><span class="token string">&quot;试卷名.docx&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;试卷title&quot;</span><span class="token punctuation">,</span>questionlist<span class="token punctuation">)</span>


<span class="token comment"># 生成十份 题的循序不一致的</span>
<span class="token comment"># for i in range(10):</span>
<span class="token comment">#	questionlist = createQuestion()</span>
<span class="token comment">#	createPaper(&quot;试卷名&quot;+str(i+1)+&quot;.docx&quot;,&quot;试卷title&quot;,questionlist)</span>
</code></pre></div><h2 id="ppt"><a href="#ppt" class="header-anchor">#</a> ppt</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pptx

<span class="token comment"># 获取ppt的对象</span>
prs <span class="token operator">=</span> pptx<span class="token punctuation">.</span>Presentation<span class="token punctuation">(</span><span class="token string">'text.pptx'</span><span class="token punctuation">)</span>

<span class="token comment"># 写入</span>
<span class="token comment"># 保存</span>
prs<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&quot;newtest.pptx&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 可以覆盖原来文件</span>
</code></pre></div><hr> <h2 id="word2txt"><a href="#word2txt" class="header-anchor">#</a> word2txt</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> os
<span class="token keyword">import</span> fnmatch
<span class="token keyword">from</span> win32com <span class="token keyword">import</span> client <span class="token keyword">as</span> wc     <span class="token comment"># as，取别名，简洁</span>
<span class="token keyword">from</span> win32com<span class="token punctuation">.</span>client <span class="token keyword">import</span> Dispatch


<span class="token keyword">def</span> <span class="token function">Word2Txt</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> savePath<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment"># savePath=&quot;&quot; 即默认保存再当前路径下</span>
    <span class="token comment"># 1 切分文件路径问</span>
    dirs<span class="token punctuation">,</span> filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>
    <span class="token comment"># os.path.split(path)  把路径分割成 dirname 和 basename，返回一个元组</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>dirs<span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\46957\Desktop</span>
    <span class="token comment"># 黎某人的word.docx</span>
    <span class="token comment"># 2 修改切分后的文件后缀</span>
    new_name <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">if</span> fnmatch<span class="token punctuation">.</span>fnmatch<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;*.doc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        new_name <span class="token operator">=</span> filename<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'.txt'</span>
    <span class="token keyword">elif</span> fnmatch<span class="token punctuation">.</span>fnmatch<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;*.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        new_name <span class="token operator">=</span> filename<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'.txt'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'格式不正确，仅支持doc or docx 格式'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>

    <span class="token comment"># 设置保存辛的文件保存路径</span>
    <span class="token keyword">if</span> savePath <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
        savePath <span class="token operator">=</span> dirs
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        savePath <span class="token operator">=</span> savePath
    word2txtPath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>savePath<span class="token punctuation">,</span>new_name<span class="token punctuation">)</span>


    <span class="token comment"># 加载文本提取的处理程序</span>
    wordapp <span class="token operator">=</span> wc<span class="token punctuation">.</span>Dispatch<span class="token punctuation">(</span><span class="token string">&quot;Word.Application&quot;</span><span class="token punctuation">)</span>
    mytxt <span class="token operator">=</span> wordapp<span class="token punctuation">.</span>Documents<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>

    <span class="token comment"># 保存文本信息</span>
    mytxt<span class="token punctuation">.</span>SaveAs<span class="token punctuation">(</span>word2txtPath<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment"># 4代表抽取文本信息</span>
    <span class="token comment"># 关闭文件</span>
    mytxt<span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 可以是带中文的path</span>
    filePath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span><span class="token string">r&quot;./黎某人的word.docx&quot;</span><span class="token punctuation">)</span>
    Word2Txt<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>

</code></pre></div><h2 id="pdf2txt"><a href="#pdf2txt" class="header-anchor">#</a> pdf2txt</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># coding = utf-8</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

Description<span class="token punctuation">:</span>word文档信息提取
Author<span class="token punctuation">:</span>chaobieren
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
功能描述：
参数描述：
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> fnmatch
<span class="token keyword">from</span> win32com <span class="token keyword">import</span> client <span class="token keyword">as</span> wc     <span class="token comment"># as，取别名，简洁</span>
<span class="token keyword">from</span> win32com<span class="token punctuation">.</span>client <span class="token keyword">import</span> Dispatch


<span class="token keyword">def</span> <span class="token function">Pdf2Txt</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> savePath<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment"># savePath=&quot;&quot; 即默认保存再当前路径下</span>
    
	<span class="token comment"># 1 切分文件路径问</span>
    dirs<span class="token punctuation">,</span> filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>
    <span class="token comment"># os.path.split(path)  把路径分割成 dirname 和 basename，返回一个元组</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>dirs<span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\46957\Desktop</span>
    <span class="token comment"># 黎某人的word.docx</span>


    <span class="token comment"># 2 修改切分后的文件后缀</span>
    new_name <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">if</span> fnmatch<span class="token punctuation">.</span>fnmatch<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;*.pdf&quot;</span><span class="token punctuation">)</span> <span class="token keyword">or</span> fnmatch<span class="token punctuation">.</span>fnmatch<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;*.PDF&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># if fnmatch.fnmatch(filename.lowr(), &quot;*.pdf&quot;)</span>
		new_name <span class="token operator">=</span> filename<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'.txt'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'格式不正确，仅支持pdf格式'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>

    <span class="token comment"># 设置保存新的文件保存路径</span>
    <span class="token keyword">if</span> savePath <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
        savePath <span class="token operator">=</span> dirs
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        savePath <span class="token operator">=</span> savePath
    word2txtPath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>savePath<span class="token punctuation">,</span>new_name<span class="token punctuation">)</span>


    <span class="token comment"># 加载文本提取的处理程序</span>
    wordapp <span class="token operator">=</span> wc<span class="token punctuation">.</span>Dispatch<span class="token punctuation">(</span><span class="token string">&quot;Word.Application&quot;</span><span class="token punctuation">)</span>
    mytxt <span class="token operator">=</span> wordapp<span class="token punctuation">.</span>Documents<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>

    <span class="token comment"># 保存文本信息</span>
    mytxt<span class="token punctuation">.</span>SaveAs<span class="token punctuation">(</span>word2txtPath<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment"># 4代表抽取文本信息</span>
    <span class="token comment"># 关闭文件</span>
    mytxt<span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 可以是带中文的path</span>
    filePath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span><span class="token string">r&quot;./黎某人的word.docx&quot;</span><span class="token punctuation">)</span>
    Pdf2Txt<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>

</code></pre></div><h2 id="读取excel生成word"><a href="#读取excel生成word" class="header-anchor">#</a> 读取excel生成word</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> xlrd
<span class="token keyword">import</span> random
<span class="token keyword">from</span> docx <span class="token keyword">import</span> Document
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Pt<span class="token punctuation">,</span>RGBColor
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>enum<span class="token punctuation">.</span>text <span class="token keyword">import</span> WD_ALIGN_PARAGRAPH
 
<span class="token comment"># 读取excel</span>
data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">&quot;data3.xlsx&quot;</span><span class="token punctuation">)</span>
 
<span class="token comment"># 获取工作表</span>
sheet <span class="token operator">=</span> data<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> 
 
<span class="token comment"># 用来存储数据</span>
<span class="token keyword">class</span> <span class="token class-name">Question</span><span class="token punctuation">:</span>
	<span class="token keyword">pass</span>
 
<span class="token keyword">def</span> <span class="token function">createQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	questionlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>nrows<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">if</span> i<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token punctuation">:</span>
			obj <span class="token operator">=</span> Question<span class="token punctuation">(</span><span class="token punctuation">)</span>
			obj<span class="token punctuation">.</span>subject <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value 	<span class="token comment"># 题目</span>
			obj<span class="token punctuation">.</span>questiontype <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value 	<span class="token comment"># 题型 </span>
			obj<span class="token punctuation">.</span>option <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
			obj<span class="token punctuation">.</span>option<span class="token punctuation">.</span>append<span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>  <span class="token comment"># a</span>
			obj<span class="token punctuation">.</span>option<span class="token punctuation">.</span>append<span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>  <span class="token comment"># b</span>
			obj<span class="token punctuation">.</span>option<span class="token punctuation">.</span>append<span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>  <span class="token comment"># c</span>
			obj<span class="token punctuation">.</span>option<span class="token punctuation">.</span>append<span class="token punctuation">(</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token punctuation">)</span>  <span class="token comment"># d</span>
			obj<span class="token punctuation">.</span>score <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value  	<span class="token comment"># 分值</span>
			
			questionlist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
	
	random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>questionlist<span class="token punctuation">)</span>		<span class="token comment"># 将序列所有的元素随机排序</span>
			
	<span class="token keyword">return</span> questionlist
	
	
	
<span class="token comment"># 生成word试卷</span>

<span class="token keyword">def</span> <span class="token function">createPaper</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>papername<span class="token punctuation">,</span>questionlist<span class="token punctuation">)</span><span class="token punctuation">:</span>
	document <span class="token operator">=</span> Document<span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment"># 页眉页脚的信息</span>
	<span class="token comment"># sections  文档可以又很多部分，这里取第一个</span>
	section <span class="token operator">=</span> document<span class="token punctuation">.</span>sections<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	header <span class="token operator">=</span> section<span class="token punctuation">.</span>header
	p1 <span class="token operator">=</span> header<span class="token punctuation">.</span>paragraphs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>   <span class="token comment"># 获取头部的部分</span>
	p1<span class="token punctuation">.</span>text <span class="token operator">=</span> papername
	
	footer <span class="token operator">=</span> section<span class="token punctuation">.</span>footer
	p2 <span class="token operator">=</span> footer<span class="token punctuation">.</span>paragraphs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 获取底部部分</span>
	p2<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;内部试题，禁止泄露&quot;</span>
	
	
	
	<span class="token comment"># 试卷基本信息</span>

	title <span class="token operator">=</span> document<span class="token punctuation">.</span>add_heading<span class="token punctuation">(</span>papername<span class="token punctuation">,</span>level<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
	title<span class="token punctuation">.</span>alignment <span class="token operator">=</span> WD_ALIGN_PARAGRAPH<span class="token punctuation">.</span>CENTER
	
	p3 <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token punctuation">)</span>
	p3<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&quot;姓名:_______&quot;</span><span class="token punctuation">)</span>
	p3<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&quot;姓名:_______&quot;</span><span class="token punctuation">)</span>
	p3<span class="token punctuation">.</span>alignment <span class="token operator">=</span> WD_ALIGN_PARAGRAPH<span class="token punctuation">.</span>CENTER
	

	
	<span class="token comment"># 试题信息</span>
	<span class="token keyword">for</span> question <span class="token keyword">in</span> questionlist<span class="token punctuation">:</span>
		subject <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span>style <span class="token operator">=</span> <span class="token string">&quot;List Number&quot;</span><span class="token punctuation">)</span>   <span class="token comment"># 段落样式 段落开头加序号  ，也有其他样式如小圆点，具体查文档</span>
		run <span class="token operator">=</span> subject<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span>question<span class="token punctuation">.</span>subject<span class="token punctuation">)</span>
		run<span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># 题目加粗</span>
		subject<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&quot;【%s】分&quot;</span><span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>question<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span>
		random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>question<span class="token punctuation">.</span>option<span class="token punctuation">)</span>   <span class="token comment"># 选项打乱</span>
		<span class="token keyword">for</span> index<span class="token punctuation">,</span>option <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>question<span class="token punctuation">.</span>option<span class="token punctuation">)</span><span class="token punctuation">:</span>
			document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token string">&quot;ABCD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span> <span class="token punctuation">)</span>


	document<span class="token punctuation">.</span>save<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>


questionlist <span class="token operator">=</span> createQuestion<span class="token punctuation">(</span><span class="token punctuation">)</span>
createPaper<span class="token punctuation">(</span><span class="token string">&quot;试卷名.docx&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;试卷title&quot;</span><span class="token punctuation">,</span>questionlist<span class="token punctuation">)</span>


<span class="token comment"># 生成十份 题的循序不一致的</span>
<span class="token comment"># for i in range(10):</span>
<span class="token comment">#	questionlist = createQuestion()</span>
<span class="token comment">#	createPaper(&quot;试卷名&quot;+str(i+1)+&quot;.docx&quot;,&quot;试卷title&quot;,questionlist)</span>
</code></pre></div><h2 id="word样式"><a href="#word样式" class="header-anchor">#</a> word样式</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> docx <span class="token keyword">import</span> Document
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Pt<span class="token punctuation">,</span>RGBColor
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>enum<span class="token punctuation">.</span>style <span class="token keyword">import</span> WD_STYLE_TYPE

<span class="token comment"># 创建一个文档对象</span>
document <span class="token operator">=</span> Document<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># doc = Document('lcs.docx')  #读取现有的文档</span>

<span class="token comment"># 写入内容</span>
document<span class="token punctuation">.</span>add_heading<span class="token punctuation">(</span><span class="token string">&quot;lcsnihao&quot;</span><span class="token punctuation">,</span>level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment">#level级别</span>

<span class="token comment"># 段落</span>
p1 <span class="token operator">=</span> document<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">&quot;lcslcslcslcs&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 插入段落</span>
p1<span class="token punctuation">.</span>insert_paragraph_before<span class="token punctuation">(</span><span class="token string">&quot;在p1段落前插入一个新的段落&quot;</span><span class="token punctuation">)</span>



<span class="token comment"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="token comment"># 格式化</span>
<span class="token builtin">format</span> <span class="token operator">=</span> p1<span class="token punctuation">.</span>paragraph_format


<span class="token comment">## 左右缩进</span>
<span class="token builtin">format</span><span class="token punctuation">.</span>left_indent <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment">#20磅</span>
<span class="token builtin">format</span><span class="token punctuation">.</span>right_indent <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment">#20磅</span>
<span class="token comment">## 首行缩进</span>
<span class="token builtin">format</span><span class="token punctuation">.</span>first_line_indent <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment">## 行间距</span>
<span class="token builtin">format</span><span class="token punctuation">.</span>line_spacing <span class="token operator">=</span> <span class="token number">1.5</span>

<span class="token comment">## 为段落追加 add.run(&quot;文字&quot;)</span>
run <span class="token operator">=</span> p1<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">&quot;ni zm zheme shuai o,buxinglebuxingle&quot;</span><span class="token punctuation">)</span>
<span class="token comment">## 为其设置格式</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>size <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>name<span class="token operator">=</span> <span class="token string">&quot;微软雅黑&quot;</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>color<span class="token punctuation">.</span>rgb <span class="token operator">=</span> RGBColor<span class="token punctuation">(</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">)</span>

<span class="token comment">### 加粗、下划线、斜体</span>
run<span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>underline <span class="token operator">=</span> <span class="token boolean">True</span>
run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>italic <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token comment"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>



<span class="token comment"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="token comment"># 插入图片</span>
<span class="token comment"># document.add_picture(&quot;图片地址&quot;,Pt(20)大小,Pt(大小))</span>
document<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">'py3.png'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">'py3.png'</span><span class="token punctuation">,</span>Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Pt<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>




<span class="token comment"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="token comment"># 插入表格</span>
table <span class="token operator">=</span> document<span class="token punctuation">.</span>add_table<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>cols<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>   <span class="token comment">#一行三列的表格</span>

<span class="token comment">## 获取第一行</span>
header_cells <span class="token operator">=</span> table<span class="token punctuation">.</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cells

<span class="token comment">## 设置表头</span>
header_cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;月份&quot;</span>
header_cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'预期销售额'</span>
header_cells<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'实际销售额'</span>

<span class="token comment">## 写入数据</span>
data <span class="token operator">=</span> <span class="token punctuation">(</span>
	<span class="token punctuation">[</span><span class="token string">'一月份'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span><span class="token string">'二月份'</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span><span class="token string">'三月份'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">288</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>

<span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
	<span class="token comment"># 添加一行</span>
	row_cells <span class="token operator">=</span> table<span class="token punctuation">.</span>add_row<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cells
	row_cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	row_cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	row_cells<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 获取表格总行数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token builtin">len</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rows<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment"># 获取表格总列数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token builtin">len</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment"># 获取某个表具体某个单元格数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span> document<span class="token punctuation">.</span>tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text <span class="token punctuation">)</span>
<span class="token comment"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>


<span class="token comment"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="token comment"># 给段落添加样式</span>
<span class="token comment"># import模块 WD_STYLE_TYPE</span>
<span class="token comment"># 实例，设置实例参数</span>
<span class="token comment"># 放到具体地方</span>
<span class="token comment"># document.styles.add_style(&quot;样式名称&quot;,&quot;模块内置的对象&quot;)</span>
style <span class="token operator">=</span> document<span class="token punctuation">.</span>styles<span class="token punctuation">.</span>add_style<span class="token punctuation">(</span><span class="token string">&quot;textstyle&quot;</span><span class="token punctuation">,</span>WD_STYLE_TYPE<span class="token punctuation">.</span>PARAGRAPH<span class="token punctuation">)</span>   <span class="token comment">#WD_STYLE_TYPE.PARAGRAPH这里是到段落的样式</span>

<span class="token comment"># 设置具体样式</span>
style<span class="token punctuation">.</span>font<span class="token punctuation">.</span>size <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>insert_paragraph_before<span class="token punctuation">(</span><span class="token string">&quot;我欲迎风在留住几步&quot;</span><span class="token punctuation">,</span>style<span class="token operator">=</span><span class="token string">&quot;textstyle&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># 删除样式</span>
document<span class="token punctuation">.</span>styles<span class="token punctuation">[</span><span class="token string">&quot;textstyle&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>




<span class="token comment"># 保存文档</span>
document<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'lcs.docx'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="转单个文件txt"><a href="#转单个文件txt" class="header-anchor">#</a> 转单个文件txt</h2> <h3 id="file2txt-py"><a href="#file2txt-py" class="header-anchor">#</a> file2txt.py</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> os
<span class="token keyword">import</span> fnmatch
<span class="token keyword">from</span> win32com <span class="token keyword">import</span> client <span class="token keyword">as</span> wc     <span class="token comment"># as，取别名，简洁</span>
<span class="token keyword">from</span> win32com<span class="token punctuation">.</span>client <span class="token keyword">import</span> Dispatch


<span class="token keyword">def</span> <span class="token function">file2Txt</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> savePath<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment"># savePath=&quot;&quot; 即默认保存再当前路径下</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        dirs<span class="token punctuation">,</span> filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>

        typename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        new_name <span class="token operator">=</span> trantype<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> typename<span class="token punctuation">)</span>

        <span class="token comment"># 设置保存新的文件保存路径</span>
        <span class="token keyword">if</span> savePath <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
            savePath <span class="token operator">=</span> dirs
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            savePath <span class="token operator">=</span> savePath
        word2txtPath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>savePath<span class="token punctuation">,</span> new_name<span class="token punctuation">)</span>


        <span class="token comment"># 加载文本提取的处理程序</span>
        wordapp <span class="token operator">=</span> wc<span class="token punctuation">.</span>Dispatch<span class="token punctuation">(</span><span class="token string">&quot;Word.Application&quot;</span><span class="token punctuation">)</span>
        mytxt <span class="token operator">=</span> wordapp<span class="token punctuation">.</span>Documents<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>

        <span class="token comment"># 保存文本信息</span>
        mytxt<span class="token punctuation">.</span>SaveAs<span class="token punctuation">(</span>word2txtPath<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment"># 4代表抽取文本信息</span>
        <span class="token comment"># 关闭文件</span>
        mytxt<span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">pass</span>


<span class="token keyword">def</span> <span class="token function">trantype</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> typename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    new_name <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

    <span class="token keyword">if</span> typename <span class="token operator">==</span> <span class="token string">'.pdf'</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> fnmatch<span class="token punctuation">.</span>fnmatch<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'*.pdf'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            new_name <span class="token operator">=</span> filename<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'.txt'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token keyword">return</span>
    <span class="token keyword">elif</span> typename <span class="token operator">==</span> <span class="token string">'.doc'</span> <span class="token keyword">or</span> typename <span class="token operator">==</span> <span class="token string">'.docx'</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> fnmatch<span class="token punctuation">.</span>fnmatch<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'*.doc'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            new_name <span class="token operator">=</span> filename<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'.txt'</span>
        <span class="token keyword">elif</span> fnmatch<span class="token punctuation">.</span>fnmatch<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'*.docx'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            new_name <span class="token operator">=</span> filename<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'.txt'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token keyword">return</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;仅支持pdf/doc/docx格式&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;new_name: &quot;</span><span class="token operator">+</span>new_name<span class="token punctuation">)</span>
    <span class="token keyword">return</span> new_name



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 可以是带中文的path</span>
    filePath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span><span class="token string">r&quot;./黎某人的word.docx&quot;</span><span class="token punctuation">)</span>
    file2Txt<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>

</code></pre></div><h2 id="遍历文件打印文件名"><a href="#遍历文件打印文件名" class="header-anchor">#</a> 遍历文件打印文件名</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> os<span class="token punctuation">,</span>time
<span class="token keyword">import</span> ExtractTxt <span class="token keyword">as</span> Et   <span class="token comment">#(ExtractTxt 就是之前的 )</span>

<span class="token keyword">class</span> <span class="token class-name">TranversalFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>rootDir<span class="token punctuation">,</span>func<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>saveDir<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>rootDir <span class="token operator">=</span> rootDir
		self<span class="token punctuation">.</span>func <span class="token operator">=</span> func
		self<span class="token punctuation">.</span>saveDir <span class="token operator">=</span> saveDir
		
    <span class="token keyword">def</span> <span class="token function">TranversalDir</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        TranversalFun<span class="token punctuation">.</span>AllFiles<span class="token punctuation">(</span>self<span class="token punctuation">,</span>self<span class="token punctuation">.</span>rootDir<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">AllFiles</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>rootDir<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> <span class="token builtin">list</span> <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span><span class="token punctuation">:</span>
            path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>rootDir<span class="token punctuation">,</span><span class="token builtin">list</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span>  <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    time1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    rootDir <span class="token operator">=</span> <span class="token string">r'./lcs'</span>
    tra <span class="token operator">=</span> TranversalFun<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>
    tra<span class="token punctuation">.</span>TranversalDir<span class="token punctuation">(</span><span class="token punctuation">)</span>
    time2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>time1<span class="token operator">-</span>time2<span class="token punctuation">)</span>
	
</code></pre></div><h2 id="递归遍历转换doc-pdf2-to-txt"><a href="#递归遍历转换doc-pdf2-to-txt" class="header-anchor">#</a> 递归遍历转换doc/pdf2 to txt</h2> <div class="language-python extra-class"><pre class="language-python"><code>
<span class="token keyword">import</span> os<span class="token punctuation">,</span>time
<span class="token keyword">import</span> file2txt <span class="token keyword">as</span> ET

<span class="token keyword">class</span> <span class="token class-name">TranversalFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>rootDir<span class="token punctuation">,</span> func<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> saveDir<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>rootDir <span class="token operator">=</span> rootDir
        self<span class="token punctuation">.</span>func <span class="token operator">=</span> func
        self<span class="token punctuation">.</span>saveDir <span class="token operator">=</span> saveDir

    <span class="token keyword">def</span> <span class="token function">TranversalDir</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        dirs<span class="token punctuation">,</span>filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>self<span class="token punctuation">.</span>rootDir<span class="token punctuation">)</span>         <span class="token comment">#根据最后一个“/”分割</span>
        <span class="token comment">#print(dirs,filename)  #C:\Users\46957\Desktop pytest</span>

        <span class="token comment"># 保存目录名</span>
        save_dir <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>saveDir <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
            save_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>dirs<span class="token punctuation">,</span><span class="token string">&quot;new_&quot;</span><span class="token operator">+</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> save_dir <span class="token operator">=</span> self<span class="token punctuation">.</span>saveDir
        <span class="token comment"># print(&quot;save_dit:&quot;+save_dir)    #save_dit:C:\Users\46957\Desktop\new_pytest</span>

        <span class="token comment"># 创建保存目录</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>save_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>save_dir<span class="token punctuation">)</span>
        TranversalFun<span class="token punctuation">.</span>AllFiles<span class="token punctuation">(</span>self<span class="token punctuation">,</span>self<span class="token punctuation">.</span>rootDir<span class="token punctuation">,</span>save_dir<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">AllFiles</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>rootDir<span class="token punctuation">,</span>save_dir<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> lists <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span><span class="token punctuation">:</span>
            path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>rootDir<span class="token punctuation">,</span>lists<span class="token punctuation">)</span>
            <span class="token comment"># print(save_dir,path)</span>

            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>save_dir<span class="token punctuation">)</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>func<span class="token punctuation">(</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>save_dir<span class="token punctuation">)</span> <span class="token punctuation">)</span>

            <span class="token comment"># 递归遍历目录</span>
            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
                newsave_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>save_dir<span class="token punctuation">,</span>lists<span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>newsave_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>newsave_dir<span class="token punctuation">)</span>
                TranversalFun<span class="token punctuation">.</span>AllFiles<span class="token punctuation">(</span>self<span class="token punctuation">,</span>path<span class="token punctuation">,</span>newsave_dir<span class="token punctuation">)</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span>  <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    time1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    rootDir <span class="token operator">=</span> <span class="token string">r'C:\Users\46957\Desktop\pytest'</span>
    tra <span class="token operator">=</span> TranversalFun<span class="token punctuation">(</span>rootDir<span class="token punctuation">,</span>ET<span class="token punctuation">.</span>file2Txt<span class="token punctuation">,</span><span class="token punctuation">)</span>
    tra<span class="token punctuation">.</span>TranversalDir<span class="token punctuation">(</span><span class="token punctuation">)</span>
    time2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>time1<span class="token operator">-</span>time2<span class="token punctuation">)</span>
</code></pre></div><h2 id="常规方法遍历文件30万-数据"><a href="#常规方法遍历文件30万-数据" class="header-anchor">#</a> 常规方法遍历文件30万+数据</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> os<span class="token punctuation">,</span>time

<span class="token triple-quoted-string string">'''
功能描述 ：遍历目录文件，对子文件单独处理
'''</span>

<span class="token keyword">def</span> <span class="token function">TraversalDir</span><span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span>lists <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>rootDir<span class="token punctuation">,</span>lists<span class="token punctuation">)</span>

        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token operator">%</span><span class="token number">10000</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'{t} *** {i} \t 文件已被读'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token operator">=</span>i<span class="token punctuation">,</span> t<span class="token operator">=</span>time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment"># 递归遍历</span>
        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            TraversalDir<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    rootDir <span class="token operator">=</span> <span class="token string">r'D:\MBA\30万数据\CSCMNews'</span>

    t1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    TraversalDir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>

    t2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Total cost time %.2f&quot;</span> <span class="token operator">%</span><span class="token punctuation">(</span>t2<span class="token operator">-</span>t1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;s&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="生成迭代器"><a href="#生成迭代器" class="header-anchor">#</a> 生成迭代器</h2> <h3 id="高效遍历"><a href="#高效遍历" class="header-anchor">#</a> 高效遍历</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> os<span class="token punctuation">,</span>time

<span class="token comment"># 假设要遍历的文件，第一级就只有文件夹，第二季才有具体文件</span>

<span class="token comment"># 迭代器类</span>
<span class="token comment"># 遍历第一级文件夹</span>
<span class="token keyword">class</span> <span class="token class-name">loadFolders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> par_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>par_path <span class="token operator">=</span> par_path

    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>self<span class="token punctuation">.</span>par_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            file_abspath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>par_path<span class="token punctuation">,</span><span class="token builtin">file</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>file_abspath<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">yield</span> file_abspath      <span class="token comment"># return</span>

<span class="token comment"># 遍历具体文件</span>
<span class="token keyword">class</span> <span class="token class-name">loadFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> par_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>par_path <span class="token operator">=</span> par_path

    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 用 __iter__  要有yield</span>
        folders <span class="token operator">=</span> loadFolders<span class="token punctuation">(</span>self<span class="token punctuation">.</span>par_path<span class="token punctuation">)</span>
        <span class="token keyword">for</span> folder <span class="token keyword">in</span> folders<span class="token punctuation">:</span>

            catg <span class="token operator">=</span> folder<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># split 根据“/”或“\”分割</span>
            <span class="token comment">#为了让代码在不同的平台上都能运行，那么路径应该写'\'还是'/'呢？</span>
            <span class="token comment">#使用os.sep的话，就不用考虑这个了，os.sep根据你所处的平台，自动采用相应的分隔符号。</span>

            <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>folder<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">yield</span> catg<span class="token punctuation">,</span><span class="token builtin">file</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    filepath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span><span class="token string">r'D:\MBA\30万数据\CSCMNews\CSCMNews'</span><span class="token punctuation">)</span>
    files <span class="token operator">=</span> loadFiles<span class="token punctuation">(</span>filepath<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span>msg <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i<span class="token operator">%</span><span class="token number">10000</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'{t} ** {i} ** {msg}\t 文件已被读取'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token operator">=</span>i<span class="token punctuation">,</span>t<span class="token operator">=</span>time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token operator">=</span>msg <span class="token punctuation">)</span> <span class="token punctuation">)</span>

    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;共用时: %.2f&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;S&quot;</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/Python/python_study/" class="prev router-link-active">
        python基础
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.750f600d.js" defer></script><script src="/blog/assets/js/2.be40518a.js" defer></script><script src="/blog/assets/js/10.0546ef3d.js" defer></script>
  </body>
</html>
