<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MYSQL【增删改】 | 欢迎回来 ！</title>
    <meta name="description" content="lcsx">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/blog/assets/css/0.styles.ee874cfe.css" as="style"><link rel="preload" href="/blog/assets/js/app.7a4660d2.js" as="script"><link rel="preload" href="/blog/assets/js/2.85e08d05.js" as="script"><link rel="preload" href="/blog/assets/js/70.7ca5af58.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.573da17f.js"><link rel="prefetch" href="/blog/assets/js/11.5a02348c.js"><link rel="prefetch" href="/blog/assets/js/12.d8c9c1bd.js"><link rel="prefetch" href="/blog/assets/js/13.e09bb963.js"><link rel="prefetch" href="/blog/assets/js/14.d23ca837.js"><link rel="prefetch" href="/blog/assets/js/15.c4683e2a.js"><link rel="prefetch" href="/blog/assets/js/16.c660c97d.js"><link rel="prefetch" href="/blog/assets/js/17.49bf184a.js"><link rel="prefetch" href="/blog/assets/js/18.9be995ca.js"><link rel="prefetch" href="/blog/assets/js/19.df144b24.js"><link rel="prefetch" href="/blog/assets/js/20.5aad5a93.js"><link rel="prefetch" href="/blog/assets/js/21.262a03c1.js"><link rel="prefetch" href="/blog/assets/js/22.7fed5ac6.js"><link rel="prefetch" href="/blog/assets/js/23.6aa0be70.js"><link rel="prefetch" href="/blog/assets/js/24.09d96859.js"><link rel="prefetch" href="/blog/assets/js/25.418504a4.js"><link rel="prefetch" href="/blog/assets/js/26.f0584d72.js"><link rel="prefetch" href="/blog/assets/js/27.cd44913e.js"><link rel="prefetch" href="/blog/assets/js/28.4f5c209f.js"><link rel="prefetch" href="/blog/assets/js/29.2dcd5c40.js"><link rel="prefetch" href="/blog/assets/js/3.11e700f0.js"><link rel="prefetch" href="/blog/assets/js/30.d2e1f594.js"><link rel="prefetch" href="/blog/assets/js/31.7b1f9108.js"><link rel="prefetch" href="/blog/assets/js/32.f4856997.js"><link rel="prefetch" href="/blog/assets/js/33.f6007bb0.js"><link rel="prefetch" href="/blog/assets/js/34.974aeb16.js"><link rel="prefetch" href="/blog/assets/js/35.af78c18d.js"><link rel="prefetch" href="/blog/assets/js/36.0a0639ee.js"><link rel="prefetch" href="/blog/assets/js/37.3a26ab2f.js"><link rel="prefetch" href="/blog/assets/js/38.ba809f55.js"><link rel="prefetch" href="/blog/assets/js/39.fb48ae1b.js"><link rel="prefetch" href="/blog/assets/js/4.31720545.js"><link rel="prefetch" href="/blog/assets/js/40.639ac403.js"><link rel="prefetch" href="/blog/assets/js/41.182c195e.js"><link rel="prefetch" href="/blog/assets/js/42.bd60b723.js"><link rel="prefetch" href="/blog/assets/js/43.7f4ee63e.js"><link rel="prefetch" href="/blog/assets/js/44.1345cf6d.js"><link rel="prefetch" href="/blog/assets/js/45.f0b98685.js"><link rel="prefetch" href="/blog/assets/js/46.97e7267e.js"><link rel="prefetch" href="/blog/assets/js/47.2c6a6d63.js"><link rel="prefetch" href="/blog/assets/js/48.faebaa80.js"><link rel="prefetch" href="/blog/assets/js/49.49af56c0.js"><link rel="prefetch" href="/blog/assets/js/5.232758e0.js"><link rel="prefetch" href="/blog/assets/js/50.b6235237.js"><link rel="prefetch" href="/blog/assets/js/51.8bb71e61.js"><link rel="prefetch" href="/blog/assets/js/52.a8d8e7ae.js"><link rel="prefetch" href="/blog/assets/js/53.259ab2d4.js"><link rel="prefetch" href="/blog/assets/js/54.a1620682.js"><link rel="prefetch" href="/blog/assets/js/55.15b38884.js"><link rel="prefetch" href="/blog/assets/js/56.408630af.js"><link rel="prefetch" href="/blog/assets/js/57.b6ac7546.js"><link rel="prefetch" href="/blog/assets/js/58.82664ed4.js"><link rel="prefetch" href="/blog/assets/js/59.339098b4.js"><link rel="prefetch" href="/blog/assets/js/6.0bf13852.js"><link rel="prefetch" href="/blog/assets/js/60.56bec4a5.js"><link rel="prefetch" href="/blog/assets/js/61.1d5e0a93.js"><link rel="prefetch" href="/blog/assets/js/62.caa7d838.js"><link rel="prefetch" href="/blog/assets/js/63.b2935415.js"><link rel="prefetch" href="/blog/assets/js/64.27d92569.js"><link rel="prefetch" href="/blog/assets/js/65.f84cda40.js"><link rel="prefetch" href="/blog/assets/js/66.1585871d.js"><link rel="prefetch" href="/blog/assets/js/67.dd596334.js"><link rel="prefetch" href="/blog/assets/js/68.7f108fcc.js"><link rel="prefetch" href="/blog/assets/js/69.e67a606a.js"><link rel="prefetch" href="/blog/assets/js/7.1e456cb7.js"><link rel="prefetch" href="/blog/assets/js/71.9ec68011.js"><link rel="prefetch" href="/blog/assets/js/72.50a3a3b0.js"><link rel="prefetch" href="/blog/assets/js/73.e2564842.js"><link rel="prefetch" href="/blog/assets/js/74.b0c6fc38.js"><link rel="prefetch" href="/blog/assets/js/8.3c5dcc01.js"><link rel="prefetch" href="/blog/assets/js/9.33061631.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.ee874cfe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="https://vuejs.org/images/logo.png" alt="欢迎回来 ！" class="logo"> <span class="site-name can-hide">欢迎回来 ！</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/xml/" class="nav-link">
  XML
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/JDBC/" class="nav-link">
  JDBC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mysql/mysql_study/" class="nav-link router-link-active">
  MySQL基础
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/git/" class="nav-link">
  git
</a></div><div class="nav-item"><a href="/blog/DMP/" class="nav-link">
  DMP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/JavaScript/resfulApi/" class="nav-link">
  模拟数据
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/tingshu/" class="nav-link">
  小慕听书
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/java_study/env/" class="nav-link">
  Java Study
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/xml/" class="nav-link">
  XML
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/JDBC/" class="nav-link">
  JDBC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Python/python_study/" class="nav-link">
  python基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/basicKnowledge/" class="nav-link">
  一些基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/dataAnalys/" class="nav-link">
  数据分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/zhihu/basis/" class="nav-link">
  网络资料
</a></li><li class="dropdown-item"><!----> <a href="/blog/Python/code/" class="nav-link">
  code
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><span class="title">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/mysql/mysql_study/" class="nav-link router-link-active">
  MySQL基础
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/mysql/mysql_study/" class="sidebar-link">MySQL基础</a></li><li><a href="/blog/mysql/mysql_study/sql_1.html" class="sidebar-link">mysql基本查询</a></li><li><a href="/blog/mysql/mysql_study/sql_2.html" class="sidebar-link">mysql高级查询</a></li><li><a href="/blog/mysql/mysql_study/DML.html" class="active sidebar-link">MYSQL【增删改】</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/mysql/mysql_study/DML.html#_1-数据添加-insert" class="sidebar-link">1 数据添加 INSERT</a></li><li class="sidebar-sub-header"><a href="/blog/mysql/mysql_study/DML.html#_2-数据修改-update" class="sidebar-link">2 数据修改 UPDATE</a></li><li class="sidebar-sub-header"><a href="/blog/mysql/mysql_study/DML.html#_3-数据删除-delete" class="sidebar-link">3 数据删除 DELETE</a></li></ul></li><li><a href="/blog/mysql/mysql_study/methods.html" class="sidebar-link">mysql基本函数</a></li><li><a href="/blog/mysql/mysql_study/transaction.html" class="sidebar-link">mysql事务</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mysql【增删改】"><a href="#mysql【增删改】" class="header-anchor">#</a> MYSQL【增删改】</h1> <p></p><div class="table-of-contents"><ul><li><a href="#mysql【增删改】">MYSQL【增删改】</a><ul><li><a href="#_1-数据添加-insert">1 数据添加 INSERT</a><ul><li><a href="#_1-1-insert语法">1.1 INSERT语法</a></li><li><a href="#_1-2-insert里写子查询">1.2 INSERT里写子查询</a></li><li><a href="#_1-3-insert方言语法【set关键字】【推荐】">1.3 INSERT方言语法【SET关键字】【推荐】</a></li><li><a href="#_1-4-ignore关键字">1.4 IGNORE关键字</a></li></ul></li><li><a href="#_2-数据修改-update">2 数据修改 UPDATE</a><ul><li><a href="#_2-1-update语法">2.1 UPDATE语法</a><ul><li><a href="#_2-1-1-员工编号、上司编码-1，order-by子句完成">2.1.1 员工编号、上司编码+1，order by子句完成</a></li><li><a href="#_2-1-2-月收入前三的员工底薪减100，用limit子句完成">2.1.2 月收入前三的员工底薪减100，用LIMIT子句完成</a></li><li><a href="#_2-1-3-把allen调往research部门，职务调整为analyst【update表连接】">2.1.3 把ALLEN调往RESEARCH部门，职务调整为ANALYST【UPDATE表连接】</a></li></ul></li><li><a href="#_2-2-update表连接">2.2 UPDATE表连接</a><ul><li><a href="#_2-2-1-update表连接例">2.2.1 update表连接例</a></li><li><a href="#_2-2-2-底薪低于公司平均底薪的员工，底薪增加1元">2.2.2 底薪低于公司平均底薪的员工，底薪增加1元</a></li><li><a href="#_2-2-3-外连接-把没有部门的员工，或者sales部门低于2000元底薪的员工，都调往20部门">2.2.3 [外连接]把没有部门的员工，或者SALES部门低于2000元底薪的员工，都调往20部门</a></li></ul></li></ul></li><li><a href="#_3-数据删除-delete">3 数据删除 DELETE</a><ul><li><a href="#_3-1-delete语法">3.1 DELETE语法</a></li><li><a href="#_3-2-执行顺序">3.2 执行顺序</a></li><li><a href="#_3-3-delete表连接">3.3 DELETE表连接</a><ul><li><a href="#_3-3-1-删除sales部门和该部门的全部员工记录【内连接】">3.3.1 删除SALES部门和该部门的全部员工记录【内连接】</a></li><li><a href="#_3-3-2-删除每个低于部门平均底薪的员工记录【内连接】">3.3.2 删除每个低于部门平均底薪的员工记录【内连接】</a></li><li><a href="#_3-3-3-删除员工king和他的直接下属的员工记录【内连接】">3.3.3 删除员工KING和他的直接下属的员工记录【内连接】</a></li><li><a href="#_3-3-4-删除sales部门的员工，以及没有部门的员工【外连接】">3.3.4 删除SALES部门的员工，以及没有部门的员工【外连接】</a></li></ul></li><li><a href="#_3-4-快速删除数据表全部记录【truncate-table】">3.4 快速删除数据表全部记录【TRUNCATE TABLE】</a></li></ul></li></ul></li></ul></div><p></p> <h2 id="_1-数据添加-insert"><a href="#_1-数据添加-insert" class="header-anchor">#</a> 1 数据添加 INSERT</h2> <h3 id="_1-1-insert语法"><a href="#_1-1-insert语法" class="header-anchor">#</a> 1.1 INSERT语法</h3> <p>INSERT可以向表写入一条或多条记录</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> 表名<span class="token punctuation">(</span>字段<span class="token number">1</span><span class="token punctuation">,</span>字段<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>多条记录</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> 表名<span class="token punctuation">(</span>字段<span class="token number">1</span><span class="token punctuation">,</span>字段<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>值<span class="token number">1</span><span class="token punctuation">,</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">表名(字段1,字段2,...)</p> <p>表名后没有字段的生声明，也是可以执行，但效率会下降。因为没有字段声明下，INSERT不能立马执行，mysql会自动查询表结构，然后补全字段声明。然后在执行INSERT。</p></div> <hr> <h3 id="_1-2-insert里写子查询"><a href="#_1-2-insert里写子查询" class="header-anchor">#</a> 1.2 INSERT里写子查询</h3> <blockquote><p>向“技术部”添加一条员工记录【员工表只有部门编号，没有部门名称】</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp
<span class="token punctuation">(</span>empno<span class="token punctuation">,</span>ename<span class="token punctuation">,</span>job<span class="token punctuation">,</span>mgr<span class="token punctuation">,</span>hiredate<span class="token punctuation">,</span>sal<span class="token punctuation">,</span>comm<span class="token punctuation">,</span>deptno<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">8001</span><span class="token punctuation">,</span><span class="token string">&quot;朵朵&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;SALESMAN&quot;</span><span class="token punctuation">,</span><span class="token number">8000</span><span class="token punctuation">,</span><span class="token string">&quot;2020-07-01&quot;</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> deptno <span class="token keyword">FROM</span> t_dept <span class="token keyword">WHERE</span> dname<span class="token operator">=</span><span class="token string">&quot;技术部&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_1-3-insert方言语法【set关键字】【推荐】"><a href="#_1-3-insert方言语法【set关键字】【推荐】" class="header-anchor">#</a> 1.3 INSERT方言语法【SET关键字】【推荐】</h3> <p>什么是方言：就是只能在某个数据库执行的语法。只能在mysql数据库上运行的语法就是mysql方言。</p> <blockquote><p>mysql方言语法</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> 表名 <span class="token keyword">SET</span> 字段<span class="token number">1</span><span class="token operator">=</span>值<span class="token number">1</span><span class="token punctuation">,</span>字段<span class="token number">2</span><span class="token operator">=</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h3 id="_1-4-ignore关键字"><a href="#_1-4-ignore关键字" class="header-anchor">#</a> 1.4 IGNORE关键字</h3> <p>IGNORE关键字会让INSERT只插入数据库不存在的记录。如果没有IGNORE，在insert多条记录的时候，当某一条记录有错误（如字段类型错误），整个insert语句都会插入失败。IGNORE可以忽略冲突的记录，而把无冲突的记录插入。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token punctuation">[</span><span class="token keyword">IGNORE</span><span class="token punctuation">]</span> <span class="token keyword">INTO</span> 表名 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="_2-数据修改-update"><a href="#_2-数据修改-update" class="header-anchor">#</a> 2 数据修改 UPDATE</h2> <h3 id="_2-1-update语法"><a href="#_2-1-update语法" class="header-anchor">#</a> 2.1 UPDATE语法</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token punctuation">[</span><span class="token keyword">IGNORE</span><span class="token punctuation">]</span>
<span class="token keyword">SET</span> 字段<span class="token number">1</span><span class="token operator">=</span>值<span class="token number">1</span><span class="token punctuation">,</span>字段<span class="token number">2</span><span class="token operator">=</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>     <span class="token comment"># order by 解决主键冲突</span>
<span class="token punctuation">[</span><span class="token keyword">LIMIT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>        <span class="token comment"># 修改前N条记录</span>
</code></pre></div><hr> <h4 id="_2-1-1-员工编号、上司编码-1，order-by子句完成"><a href="#_2-1-1-员工编号、上司编码-1，order-by子句完成" class="header-anchor">#</a> 2.1.1 员工编号、上司编码+1，order by子句完成</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> t_emp <span class="token keyword">SET</span> empno<span class="token operator">=</span>empno<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>mgr<span class="token operator">=</span>mgr<span class="token operator">+</span><span class="token number">1</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> empno <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h4 id="_2-1-2-月收入前三的员工底薪减100，用limit子句完成"><a href="#_2-1-2-月收入前三的员工底薪减100，用limit子句完成" class="header-anchor">#</a> 2.1.2 月收入前三的员工底薪减100，用LIMIT子句完成</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> t_emp 
<span class="token keyword">SET</span> sal<span class="token operator">=</span>sal<span class="token operator">-</span><span class="token number">100</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sal<span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>comm<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre></div><p>order by 不是固定字段，可以组合的</p> <hr> <h4 id="_2-1-3-把allen调往research部门，职务调整为analyst【update表连接】"><a href="#_2-1-3-把allen调往research部门，职务调整为analyst【update表连接】" class="header-anchor">#</a> 2.1.3 把ALLEN调往RESEARCH部门，职务调整为ANALYST【UPDATE表连接】</h4> <p>这里要处理两张表，员工表和部门表。可以通过where子句先查询到RESEARCH部门编号，再update部门编号。但这种是相关子查询，数据量大的时候效率低。</p> <p>需要 👇👇👇2.2 UPDATE表连接</p> <h3 id="_2-2-update表连接"><a href="#_2-2-update表连接" class="header-anchor">#</a> 2.2 UPDATE表连接</h3> <p>语法1：【内连接】</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> 表<span class="token number">1</span> <span class="token keyword">JOIN</span> 表<span class="token number">2</span> <span class="token keyword">ON</span> 条件
<span class="token keyword">SET</span> 字段<span class="token number">1</span><span class="token operator">=</span>值<span class="token number">1</span><span class="token punctuation">,</span>字段<span class="token number">2</span><span class="token operator">=</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">UPDATE</p> <p>ON条件可以为空?</p> <p>UPDATE 多张表的字段是可以的</p></div> <p>语法2:【内连接】</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> 表<span class="token number">1</span><span class="token punctuation">,</span>表<span class="token number">2</span>
<span class="token keyword">SET</span> 字段<span class="token number">1</span><span class="token operator">=</span>值<span class="token number">1</span><span class="token punctuation">,</span>字段<span class="token number">2</span><span class="token operator">=</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">WHERE</span> 连接条件<span class="token punctuation">;</span>
</code></pre></div><p>语法三：【外连接】</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> 表<span class="token number">1</span> <span class="token punctuation">[</span><span class="token keyword">LEFT</span><span class="token operator">|</span><span class="token keyword">RIGHT</span><span class="token punctuation">]</span> <span class="token keyword">JOIN</span> 表<span class="token number">2</span> <span class="token keyword">ON</span> 条件
<span class="token keyword">SET</span> 字段<span class="token number">1</span><span class="token operator">=</span>值<span class="token number">1</span><span class="token punctuation">,</span>字段<span class="token number">2</span><span class="token operator">=</span>值<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h4 id="_2-2-1-update表连接例"><a href="#_2-2-1-update表连接例" class="header-anchor">#</a> 2.2.1 update表连接例</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> t_emp e <span class="token keyword">JOIN</span> t_dept d
<span class="token keyword">SET</span> e<span class="token punctuation">.</span>deptno<span class="token operator">=</span>d<span class="token punctuation">.</span>deptno<span class="token punctuation">,</span>e<span class="token punctuation">.</span>job<span class="token operator">=</span><span class="token string">&quot;ANALYST&quot;</span><span class="token punctuation">,</span>d<span class="token punctuation">.</span>loc<span class="token operator">=</span><span class="token string">&quot;上思&quot;</span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>ename<span class="token operator">=</span><span class="token string">&quot;ALLEN&quot;</span> <span class="token operator">AND</span> d<span class="token punctuation">.</span>dname<span class="token operator">=</span><span class="token string">&quot;RESEARCH&quot;</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>从e表中筛选出ALLEN，从d表筛选出RESEARCH，
然后 e.deptno=d.deptno中，d.deptno把RESEARCH的部门编号找到。赋值给ALLEN，e表的deptno。</p></div> <hr> <h4 id="_2-2-2-底薪低于公司平均底薪的员工，底薪增加1元"><a href="#_2-2-2-底薪低于公司平均底薪的员工，底薪增加1元" class="header-anchor">#</a> 2.2.2 底薪低于公司平均底薪的员工，底薪增加1元</h4> <blockquote><p>查询底薪低于公司平均底薪的员工</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e<span class="token punctuation">.</span>sal<span class="token punctuation">,</span>t<span class="token punctuation">.</span>avg
<span class="token keyword">FROM</span> t_emp e <span class="token keyword">JOIN</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> avg <span class="token keyword">FROM</span> t_emp<span class="token punctuation">)</span> t
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>sal<span class="token operator">&lt;</span>t<span class="token punctuation">.</span>avg<span class="token punctuation">;</span>
</code></pre></div><blockquote><p>底薪增加1元</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> t_emp e<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> avg <span class="token keyword">FROM</span> t_emp<span class="token punctuation">)</span> t
<span class="token keyword">SET</span> e<span class="token punctuation">.</span>sal<span class="token operator">=</span>e<span class="token punctuation">.</span>sal<span class="token operator">+</span><span class="token number">1</span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>sal<span class="token operator">&lt;</span>avg<span class="token punctuation">;</span>
<span class="token comment"># ON e.sal&lt;avg;</span>
</code></pre></div><h4 id="_2-2-3-外连接-把没有部门的员工，或者sales部门低于2000元底薪的员工，都调往20部门"><a href="#_2-2-3-外连接-把没有部门的员工，或者sales部门低于2000元底薪的员工，都调往20部门" class="header-anchor">#</a> 2.2.3 [外连接]把没有部门的员工，或者SALES部门低于2000元底薪的员工，都调往20部门</h4> <p>所有的员工都要保留下来，部门字段值是null的话，在内连接下是不会保留下的。所以要用左外连接。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">#左连接，连接条件deptno，左连接保留员工表所有记录</span>
<span class="token keyword">UPDATE</span> t_emp e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> t_dept d <span class="token keyword">ON</span> e<span class="token punctuation">.</span>deptno<span class="token operator">=</span>d<span class="token punctuation">.</span>deptno   
<span class="token keyword">SET</span> e<span class="token punctuation">.</span>deptno<span class="token operator">=</span><span class="token number">20</span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>deptno <span class="token operator">IS</span> <span class="token boolean">NULL</span> <span class="token operator">OR</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>dname<span class="token operator">=</span><span class="token string">&quot;SALES&quot;</span> <span class="token operator">AND</span> e<span class="token punctuation">.</span>sal<span class="token operator">&lt;</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="_3-数据删除-delete"><a href="#_3-数据删除-delete" class="header-anchor">#</a> 3 数据删除 DELETE</h2> <div class="custom-block tip"><p class="custom-block-title">delete</p> <p>只能删除数据表里的记录，不能删除数据表（用drop）。</p></div> <h3 id="_3-1-delete语法"><a href="#_3-1-delete语法" class="header-anchor">#</a> 3.1 DELETE语法</h3> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token punctuation">[</span><span class="token keyword">IGNORE</span><span class="token punctuation">]</span> <span class="token keyword">FROM</span> 表名 
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> 条件<span class="token number">1</span><span class="token punctuation">,</span>条件<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">LIMIT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h3 id="_3-2-执行顺序"><a href="#_3-2-执行顺序" class="header-anchor">#</a> 3.2 执行顺序</h3> <div class="custom-block tip"><p class="custom-block-title">执行顺序</p> <p>FROM -&gt; WHERE -&gt; ORDER BY -&gt; LIMIT -&gt; DELETE</p></div> <h3 id="_3-3-delete表连接"><a href="#_3-3-delete表连接" class="header-anchor">#</a> 3.3 DELETE表连接</h3> <p>因为相关子查询效率非常低，所以要用表连接的方式来改造DELETE语句。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> 表<span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> 表<span class="token number">1</span> <span class="token keyword">JOIN</span> 表<span class="token number">2</span> <span class="token keyword">ON</span> 条件
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> 条件<span class="token number">1</span><span class="token punctuation">,</span>条件<span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">LIMIT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_3-3-1-删除sales部门和该部门的全部员工记录【内连接】"><a href="#_3-3-1-删除sales部门和该部门的全部员工记录【内连接】" class="header-anchor">#</a> 3.3.1 删除SALES部门和该部门的全部员工记录【内连接】</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">#删除e表员工记录 和 表salse部门记录【两个表】</span>
<span class="token keyword">DELETE</span> e<span class="token punctuation">,</span>d  
<span class="token comment">#为什么不用外连接呢？因为删除的是有部门的员工，没有部门的是不用删除。内连接满足了</span>
<span class="token keyword">FROM</span> t_emp e <span class="token keyword">JOIN</span> t_dept d  <span class="token keyword">ON</span> e<span class="token punctuation">.</span>deptno<span class="token operator">=</span>d<span class="token punctuation">.</span>deptno   
<span class="token comment">#内连接下，ON代替WHERE也可以</span>
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span>dname<span class="token operator">=</span><span class="token string">&quot;SALES&quot;</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h4 id="_3-3-2-删除每个低于部门平均底薪的员工记录【内连接】"><a href="#_3-3-2-删除每个低于部门平均底薪的员工记录【内连接】" class="header-anchor">#</a> 3.3.2 删除每个低于部门平均底薪的员工记录【内连接】</h4> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> e
<span class="token keyword">FROM</span> t_emp e <span class="token keyword">JOIN</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> deptno<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> avg
<span class="token keyword">FROM</span> t_emp 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> deptno<span class="token punctuation">)</span> t
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>t_dept<span class="token operator">=</span>t<span class="token punctuation">.</span>t_dept
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>sal<span class="token operator">&lt;</span>t<span class="token punctuation">.</span>avg<span class="token punctuation">;</span>
<span class="token comment"># 内连接嘛，条件可以写在ON子句中</span>
<span class="token comment"># ON e.t_dept=t.t_dept AND e.sal&lt;t.avg;</span>
</code></pre></div><hr> <h4 id="_3-3-3-删除员工king和他的直接下属的员工记录【内连接】"><a href="#_3-3-3-删除员工king和他的直接下属的员工记录【内连接】" class="header-anchor">#</a> 3.3.3 删除员工KING和他的直接下属的员工记录【内连接】</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DELETE</span> e
<span class="token keyword">FROM</span> t_emp e <span class="token keyword">JOIN</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> emptno <span class="token keyword">FROM</span> t_emp <span class="token keyword">WHERE</span> ename<span class="token operator">=</span><span class="token string">&quot;KING&quot;</span><span class="token punctuation">)</span> t
<span class="token comment"># 他的直接下属 和 king</span>
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>mgr<span class="token operator">=</span>t<span class="token punctuation">.</span>emptno <span class="token operator">OR</span> e<span class="token punctuation">.</span>deptno<span class="token operator">=</span>t<span class="token punctuation">.</span>detpno<span class="token punctuation">;</span>     
</code></pre></div><hr> <h4 id="_3-3-4-删除sales部门的员工，以及没有部门的员工【外连接】"><a href="#_3-3-4-删除sales部门的员工，以及没有部门的员工【外连接】" class="header-anchor">#</a> 3.3.4 删除SALES部门的员工，以及没有部门的员工【外连接】</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">delete</span> e
<span class="token keyword">from</span> t_emp e <span class="token keyword">left</span> <span class="token keyword">join</span> t_dept d <span class="token keyword">on</span> e<span class="token punctuation">.</span>deptno<span class="token operator">=</span>d<span class="token punctuation">.</span>deptno
<span class="token keyword">where</span> d<span class="token punctuation">.</span>dname<span class="token operator">=</span><span class="token string">&quot;sales&quot;</span> <span class="token operator">or</span> e<span class="token punctuation">.</span>deptno <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h3 id="_3-4-快速删除数据表全部记录【truncate-table】"><a href="#_3-4-快速删除数据表全部记录【truncate-table】" class="header-anchor">#</a> 3.4 快速删除数据表全部记录【TRUNCATE TABLE】</h3> <p>delete语句是在事务机制下删除记录，删除记录之前，先要将要删除的记录保存到日志文件里，然后在删除记录。</p> <div class="language-SQL extra-class"><pre class="language-sql"><code><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">;</span>
<span class="token comment"># 一次只能一个表；</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/mysql/mysql_study/sql_2.html" class="prev">
        mysql高级查询
      </a></span> <span class="next"><a href="/blog/mysql/mysql_study/methods.html">
        mysql基本函数
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.7a4660d2.js" defer></script><script src="/blog/assets/js/2.85e08d05.js" defer></script><script src="/blog/assets/js/70.7ca5af58.js" defer></script>
  </body>
</html>
